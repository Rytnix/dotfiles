(self.webpackChunk=self.webpackChunk||[]).push([[8721],{51897:(e,t,i)=>{var a=i(25682),s="chrome-extension://__MSG_@@extension_id__/",n="moz-extension://__MSG_@@extension_id__/",r="safari-web-extension://__MSG_@@extension_id__/",o=self.GR_RESOURCE_ROOT||s,l=self.GR_RESOURCE_ROOT||n,c=self.GR_RESOURCE_ROOT||r;e.exports={__css:a.toString().replace(new RegExp(s,"g"),o).replace(new RegExp(n,"g"),l).replace(new RegExp(r,"g"),c),...a.locals}},20271:(e,t,i)=>{i.d(t,{I:()=>c,O:()=>a});var a,s=i(27378),n=i(41572),r=i(88056),o=i(19429),l=i(35407);!function(e){e.Context=s.createContext(r.Y.invariantContent("AssistantTextResources")),e.holder=o.VF((()=>({setGoalsTooltip:"Set goals to get tailored writing suggestions",proofitTooltip:"Expert writing help"})))}(a||(a={}));const c=l.Pj(l.GG({denali:n.m.holder,assistant:a.holder}))((()=>({denali:{}})))},16037:(e,t,i)=>{i.d(t,{t:()=>U});var a=i(57050),s=i(40273),n=i(90361),r=i(36991);var o=i(34311),l=i(62337),c=i(95384),d=i(63919),u=i(30067),p=i(74850),m=i(32952),h=i(85985),g=i(77176),f=i(93508);class v{constructor(){this._mapByHighlightId=new Map,this._mapByAlertId=new Map,this._highlightDataChanged=new m.xQ,this.highlightDataChanged=this._highlightDataChanged}getByHighlightId(e){return this._mapByHighlightId.get(e)}getByAlertId(e){const t=this._mapByAlertId.get(e)||new Set;return Array.from(t).map((e=>this._mapByHighlightId.get(e))).filter((e=>!!e))}get(e){return this._mapByHighlightId.get(e)}has(e){return this._mapByHighlightId.has(e)}set(e,t){this._mapByHighlightId.set(e,t);const i=this._mapByAlertId.get(t.alertId)||new Set;i.add(e),this._mapByAlertId.set(t.alertId,i),this._highlightDataChanged.next(e)}delete(e){const t=this._mapByHighlightId.get(e);if(t){const i=this._mapByAlertId.get(t.alertId);void 0!==i&&(i.delete(e),0===i.size&&this._mapByAlertId.delete(t.alertId)),this._mapByHighlightId.delete(e)}this._highlightDataChanged.next(e)}forEach(e){this._mapByHighlightId.forEach(e)}getHighlightDataObs(e){return this._highlightDataChanged.pipe(h.h((t=>t===e)),g.U((()=>this.getByHighlightId(e))),f.O(this.getByHighlightId(e)))}}class w{constructor(e,t,i,a,s=(()=>d.E9.zero),n=p.Y.create(w.name)){this._denaliHighlights=e,this._getFluidHighlights=t,this._getTextMap=i,this._getParentRect=a,this._getParentScroll=s,this._log=n}register(e,t,i,a){if(null!==e){if(this._denaliHighlights.has(e))return this.update(e,t,i,a);{const s=new c.Fd(e,t,this._getFluidHighlights(),this._getParentRect,this._getParentScroll),n={id:e,alertId:a.alertId,mark:s,visualization:i};this._denaliHighlights.set(e,n);const r=this._getTextMap().getPlainText();return this._getFluidHighlights().addHighlight(e,(0,u.rX)((0,u.mp)(s.range),r),a),n}}return null}remove(e){this._denaliHighlights.has(e)?(this._getFluidHighlights().removeHighlights([e]),this._denaliHighlights.delete(e)):this._log.warn(`can't remove mark #${e}, doesn't exist`)}update(e,t,i,a){const s=this._denaliHighlights.get(e);if(s){this._denaliHighlights.set(e,{...s,visualization:i});const n=this._getTextMap().getPlainText();return this._getFluidHighlights().updateHighlight(e,(0,u.rX)(t.meta.range(),n),a),s}return this._log.warn("cannot update not existing highlight",e),null}clearAll(){this._denaliHighlights.forEach((e=>{this._getFluidHighlights().removeHighlights([e.id])}))}}var b=i(55073),_=i(5817),S=i(25938),y=i(88522),E=i(59443),k=i(24645),A=i(51374),I=i(9922),C=i(24209),M=i(40151),T=i(76974),x=i(95300),R=i(77150),F=i(80900),L=i(50628),P=i(22232),V=i(95574),O=i(5114),N=i(71249),B=i(95195);class U{constructor(e,t,i,s,n,r,d=p.Y.create(U.name),u,f){this._highlights=e,this._textObserver=t,this._replacementService=i,this._layout=s,this._scroller=n,this._selectedHighlightsTracker=r,this._log=d,this._requestAwaitService=u,this._formattingService=f,this._subs=new I.w.Keeper,this._disposed=!1,this._highlightedAlertId=null,this._marks=new Map,this._highlightsDataStore=new v,this._highlightUpdater=new w(this._highlightsDataStore,(()=>this._highlights),(()=>this._textObserver.getTextSource()),(()=>{const e=this._layout.textField.rect.getApproximate();return l.Pf.create({...e.client,...e.size})}),(()=>this._layout.textField.scroll.getApproximate())),this.highlightHoverProvider={getHoveredStateBehavior:e=>this._highlightsDataStore.getHighlightDataObs(e).pipe(g.U((e=>e&&e.visualization.type===c.sO.Change.VisualState.Type.highlighted?{[c.sO.Change.VisualState.Source.sidebar]:o.pc.hoveredNeedsAttention,[c.sO.Change.VisualState.Source.text]:o.pc.hovered,[c.sO.Change.VisualState.Source.api]:this._highlightedAlertId===e.alertId?o.pc.hovered:o.pc.none}[e.visualization.source]:o.pc.none)))},this._updateContentsBuffer=new m.xQ,this._flushUpdater=new m.xQ,this.getContents=(e,t)=>{if(this._log.trace(`getContents, ${String(e)}, ${String(t)}`),this._formattingService){const i=this._textObserver.getTextSource().getRichText();return S.RI.unsafeRes(void 0!==e?i.slice(e,void 0!==t?e+t:void 0):i)}{const i=void 0!==e?this.getText().slice(e,void 0!==t?e+t:void 0):this.getText();return S.RI.resFromText(i)}},this.changes=C.T((0,a.zG)(S.RI.res(this.getContents().delta),B.g_((()=>M.E),(e=>T.of(e)))),this._textObserver.contentChanges.async.pipe(h.h((e=>e.changes.length>0)),g.U((({deltaChange:e})=>e)))),this.activeMarks=new x.X(O.none),this.contentUpdated=new m.xQ,this.hoveredMarks=new x.X(O.none),this.textChangedAfterPaste=new m.xQ,this.activeWord=new x.X(O.none),this.clickedWord=new x.X(O.none),this.ongoingSelection=new x.X(!1),this._log.info(`${U.name} created`),this._subs.push(this._subscribeToContentUpdates(),this._subscribeToSelectedHighlight(),this._trackFocusedAlert())}_trackFocusedAlert(){return this._highlightsDataStore.highlightDataChanged.pipe(g.U((e=>this._highlightsDataStore.getByHighlightId(e))),h.h((e=>!!e))).subscribe((e=>{this._highlightedAlertId===e.alertId||e.visualization.type!==c.sO.Change.VisualState.Type.highlighted||e.visualization.source!==c.sO.Change.VisualState.Source.text&&e.visualization.source!==c.sO.Change.VisualState.Source.sidebar?e.alertId===this._highlightedAlertId&&e.visualization.type===c.sO.Change.VisualState.Type.visible&&(this._highlightedAlertId=null,this._log.trace(`Mark ${e.id} unfocused - alertId ${e.alertId}`)):(this._highlightedAlertId=e.alertId,this._log.trace(`Mark ${e.id} focused - alertId ${e.alertId}`))}))}pushChanges(e,t){this._log.trace("pushChanges",{change:e,source:t}),S.RI.isFlush(e)?this._flushUpdater.next():S.RI.isReset(e)?this._log.warn("Got unknown reset"):this._updateContents(e.delta,t)}getText(){return this._log.trace("getText"),this._formattingService?(0,b.l)(this._textObserver.getTextSource().getRichText(),""):this._textObserver.getTextSource().getPlainText()}getTextLength(){return this._log.trace("getTextLength"),this.getText().length}flushChanges(){this._log.trace("flushChanges")}getCursor(){return this._log.trace("getCursor"),E.Y1.empty}setCursor(e,t,i){return this._log.trace("setCursor",{_index:e,_length:t,_source:i}),B.F2(void 0)}getLastPossibleCursorPosition(){return this._log.trace("getLastPossibleCursorPosition"),0}_doMarkAction(e){const t=o.y$.Id.createFromMark(e.id),i=e.meta.capiAlertId;switch(e.action){case k.v.Change.ActionType.create:{const a=this._highlightUpdater.register(t,e,e.meta.visualState,{alertId:i,highlightId:t,highlightColor:e.meta.highlightColor,highlightDisplayFormat:e.meta.highlightDisplayFormat,highlightDisappearOnHoverDelay:e.meta.highlightDisappearOnHoverDelay,highlightLiveliness:null}),s=(null==a?void 0:a.mark)||null;return s&&this._marks.set(s.id,s),s}case k.v.Change.ActionType.update:{const a=this._highlightUpdater.update(t,e,e.meta.visualState,{alertId:i,highlightId:t,highlightColor:e.meta.highlightColor,highlightDisplayFormat:e.meta.highlightDisplayFormat,highlightDisappearOnHoverDelay:e.meta.highlightDisappearOnHoverDelay,highlightLiveliness:null}),s=(null==a?void 0:a.mark)||null;return s&&this._marks.set(s.id,s),s}case k.v.Change.ActionType.remove:return this._highlightUpdater.remove(t),this._marks.delete(e.id),null;default:(0,P.vE)(e)}}changeMarks(e){return this._disposed?(this._log.debug("changeMarks called after disposed, returning empty result"),k.v.Change.Result.getEmpty()):(this._log.trace("changeMarks",{rawMarks:e}),e.reduce(((e,t)=>{switch(t.action){case k.v.Change.ActionType.create:e.created.set(t.id,B.ij(new Error("Cannot create mark"))(this._doMarkAction(t)));break;case k.v.Change.ActionType.update:e.updated.set(t.id,B.ij(new Error("Cannot update mark"))(this._doMarkAction(t)));break;case k.v.Change.ActionType.remove:this._doMarkAction(t),e.removed.set(t.id,B.F2(void 0))}return e}),k.v.Change.Result.getEmpty()))}scrollToMark(e,t){var i;const a=null!==(i=this._marks.get(e))&&void 0!==i?i:null;return this._log.trace("scrollToMark",{markId:e,mark:a,opts:t}),a?this._scroller.scrollToMark(a,t):(this._log.warn(`Tried to scroll to nonexistent mark with id: ${e}`),M.E)}_subscribeToContentUpdates(){return this._updateContentsBuffer.pipe(R.R((()=>C.T(F.H((0,_.Xd)(20)),this._flushUpdater).pipe(L.P()))),h.h((e=>e.length>0)),g.U((e=>e.reduce(((e,t)=>e.compose(t)),new y.i)))).subscribe((e=>{const t=this._replacementService.performBatchReplacements((i=e,i.reduce((({actions:e,index:t},i)=>{const a=e[0];return r.s.isInsertString(i)?(e.unshift({pos:{start:t,end:t},value:i.insert}),{actions:e,index:t}):r.s.isInsertEmbed(i)?{actions:e,index:t+1}:r.s.isRetain(i)?{actions:e,index:t+i.retain}:r.s.isDelete(i)?(a&&a.pos.start===a.pos.end&&a.pos.end===t?a.pos={...a.pos,end:a.pos.end+i.delete}:e.unshift({pos:{start:t,end:t+i.delete},value:""}),{actions:e,index:t+i.delete}):void(0,n.vE)(i)}),{actions:[],index:0}).actions.reduce(((e,t)=>(e.length&&e[e.length-1].value&&e[e.length-1].pos.start===t.pos.start?e[e.length-1].value=`${t.value}${e[e.length-1].value}`:e.push(t),e)),[]))).then((()=>{const t=(e=>e.reduce((({formattings:e,index:t},i)=>s.m.hasFormatting(i)?r.s.isInsertString(i)?(e.push({range:{start:t,end:"\n"===i.insert?t:t+i.insert.length},formatting:i.attributes}),{formattings:e,index:t+i.insert.length}):r.s.isInsertEmbed(i)?{formattings:e,index:t+1}:r.s.isRetain(i)?(e.push({range:{start:t,end:t+i.retain},formatting:i.attributes}),{formattings:e,index:t+i.retain}):{formattings:e,index:t}:r.s.isInsertString(i)?{formattings:e,index:t+i.insert.length}:r.s.isInsertEmbed(i)?{formattings:e,index:t+1}:r.s.isRetain(i)?{formattings:e,index:t+i.retain}:r.s.isDelete(i)?{formattings:e,index:t}:void(0,n.vE)(i)),{formattings:[],index:0}).formattings)(e);this._formattingService&&t.length&&(this._log.trace("Have formattings, applying",t),t.forEach((e=>{this._formattingService&&this._formattingService.apply(e.range,e.formatting)})))}),(()=>{this._log.warn("Failed to apply batch replacements")}));var i;this._requestAwaitService&&this._requestAwaitService.addRequest(t)}))}_subscribeToSelectedHighlight(){return this._selectedHighlightsTracker.pipe(g.U((0,a.ls)(N.UI((e=>{var t;return(0,a.zG)(O.fromNullable(null===(t=this._highlightsDataStore.get(e))||void 0===t?void 0:t.mark),O.filter((e=>(0,a.zG)(e.range(),B.g_(a.W8,(0,a.ff)(A.x.isEnclosingView))))))})),N.oA))).subscribe((e=>this.activeMarks.next(O.some(e))))}_updateContents(e,t){this._updateContentsBuffer.next((0,b.AQ)(e))}getSelectionRect(){throw this._log.trace("getSelectionRect"),Error("not implemented")}setContents(e){this._log.trace("setContents",{_value:e})}getHTML(){return this._log.trace("getHTML"),""}getPossibleCursorPosition(e,t){return this._log.trace("getPossibleCursorPosition",{_x:e,_y:t}),V.vM((()=>{throw new Error("Not implemented")}))}dispose(){this._highlightUpdater.clearAll(),this._subs.dispose(),this._log.info(`${U.name} disposed`),this._disposed=!0}}},25913:(e,t,i)=>{i.d(t,{Y:()=>p,q:()=>m});var a=i(57050),s=i(41398),n=i(77176),r=i(93508),o=i(46861),l=i(40033),c=i(10720),d=i(66896),u=i(5114);const p=(e,t)=>{const i=(0,c.ux)(e.lensState,e.cardsListScrollManager,e.capabilities),a=Math.max(600,t.size.height+o.O.headerHeight+o.O.panelHeight);return i.pipe((0,s.M)(e.predictionsPreviewViewModel.previewState),(0,n.U)((([e,t])=>{if(t.kind!==l.fA.visible)return e;const i=[t.readersAttention,t.tone].filter(u.isSome).length;return i>0?e+o.O.predictionsPreviewHeaderHeight+o.O.predictionInsightHeight*i+o.O.predictionInsightBottomMargin:e})),(0,r.O)(0),(0,n.U)((e=>Math.max(e+o.O.headerHeight,a))),(0,n.U)((e=>Math.min(e,750))))},m=(e,t,i)=>s=>{const n=e(),r=e=>e*i(),o=r(1),l=r(2.25);return(0,a.zG)(t(),u.map((e=>e-(0,c.US)(n))),u.map((e=>d.R.isMainLens(n)&&s?e-l-o:e-o)),u.map((e=>e-r(1))),u.filter((e=>e>0)))}},18126:(e,t,i)=>{i.d(t,{f:()=>o});var a=i(95300),s=i(2844),n=i(66310),r=i(34311);class o{constructor(e){this._originalHoverProvider=e,this._assistantHoverProviderSbj=new a.X(null)}setAssistantHover(e){this._assistantHoverProviderSbj.next(e)}removeAssistantHover(){this._assistantHoverProviderSbj.next(null)}getHoveredStateBehavior(e){const t=this._originalHoverProvider.getHoveredStateBehavior(e);return this._assistantHoverProviderSbj.pipe((0,n.w)((i=>null==i?t:(0,s.aj)(t,i.getHoveredStateBehavior(e),((e,t)=>t!==r.pc.none?t:e)))))}}},8467:(e,t,i)=>{i.d(t,{t:()=>c});var a=i(40327),s=i(30067),n=i(95384),r=i(91402),o=i(44586),l=i(95195);function c({scrollToMarkRect:e,scrollToRange:t}){return{scrollToMark:(i,c)=>(0,a.pipe)(n.Fd.getMarkRect(i),l.vx((()=>(t((0,s.mp)(i.range)),n.Fd.getMarkRect(i)))),l.g_((e=>r._(new Error(`Cannot get mark's rect: ${i.id}: ${e.message}`))),(t=>new o.y((i=>{i.next(void 0),e(t,c)})))))}}},33682:(e,t,i)=>{i.r(t),i.d(t,{AssistantController:()=>zs,AssistantControllerImpl:()=>Ys,AssistantControllerInjectedParams:()=>a.AssistantControllerInjectedParams,AssistantService:()=>dn,AssistantServiceInjectedParams:()=>s.AssistantServiceInjectedParams,LocalAssistantHighlightCollection:()=>n.c});var a={};i.r(a),i.d(a,{e:()=>zs,Z:()=>Ys});var s={};i.r(s),i.d(s,{e:()=>dn});var n=i(45662),r=i(40327),o=i(27378),l=i(74850),c=i(32281),d=i(523),u=i(25913),p=i(53067),m=i(37532),h=i(75003),g=i(57050),f=i(50622),v=i(9671),w=i(19654),b=i(59456),_=i(19043),S=i(31536),y=i(84286),E=i(14601);class k{constructor(e,t){this._sduiItems=e,this.cardsViewModel=t,this.showBulkDismissFeed=()=>{this.cardsViewModel.actionEvents.next(y.f.create([{type:"pushAssistantFeed",feedId:y.D.AssistantFeed.BULK_DISMISS_CARD_FEED_ID}]))},this._subs=new E.w}get bulkDismissAlertsCount(){return this._sduiItems.view((e=>y.D.StrongAlertRef.getStrongAlertRefBulkDismissAlertIds(e).size))}dispose(){this._subs.unsubscribe()}}var A,I=i(35214),C=i(40018),M=i(16892),T=i(48521),x=i(35416),R=i(25975),F=i(8125),L=i(5114),P=i(45701),V=i(16027),O=i(52976),N=i(69111),B=i(58954),U=i(60984),D=i(52726);!function(e){const t=e=>(0,r.pipe)(x.In.getActiveItemOfType(a)(e),L.chain(O.P.Capabilities.toAlertItem));function i(e){return x.nL.Items.mapper((e=>e.kind),{[O.P.Kind]:e})}function a(e){return e.kind===O.P.Kind}function s(){return{viewState:()=>e=>(e.kind,O.P.Kind,{view:e,kind:"alertRefSDUI"})}}e.isSelectableItem=a,e.getActiveItemWithAlert=function(e){return t(e)},e.getActiveAlignableItem=e=>t(e),e.getActiveFocusableItem=e=>t(e),e.checksFeedItemsMapper=i,e.isAlertRefSDUI=a,e.defaultOrd=t=>(0,I.fold)(P.getMonoid())([(0,r.pipe)(P.ordBoolean,P.contramap((0,F.ff)(O.P.Item.isBulkAcceptSDUI))),(0,r.pipe)(P.ordBoolean,P.contramap(O.P.Item.isBulkDismissSDUI)),e.getByActiveAlertPositionOrd(t)]),e.sduiToChecksFeedOrd=function(t){return i=>P.fromCompare(((a,s)=>N.e.isSDUIItem(a)&&N.e.isSDUIItem(s)?N.e.getOrd(i).compare(a,s):e.getByActiveAlertPositionOrd(t).compare(a,s)))},e.getByActiveAlertPositionOrd=e=>(0,I.fold)(P.getMonoid())([(0,r.pipe)(C.h$.ordHRange,P.contramap((t=>(0,r.pipe)(e.hasActiveAlert(t),L.map((e=>e.alert)),L.getOrElse((()=>({getHighlightRanges:()=>[{start:0,end:0}]})))))))]),e.item=e=>V.UI.Union.make("kind",{alertRefSDUI:B.p.SingleCard(e),empty:U.Q.Empty}),e.viewState=s,e.createCardListFlow=D.p,e.listItemOrd=e=>P.contramap((e=>e.cell.item.view))(e).compare;const n={equals:(e,t)=>e.kind===t.kind&&M.s.eqById.equals(e,t)},o=e=>({equals:(t,i)=>{const a={[O.P.Kind]:e};return n.equals(t,i)&&function(e,t){return(i,a)=>t[e(i)].equals(i,a)}((e=>e.kind),a)(t,i)}});function l(){return{changePosition:e=>i(O.P.Capabilities.changePosition(e))}}function c(){return{completeTransition:e=>i(O.P.Capabilities.animatable.completeTransition(e)),transitionTo:e=>i(O.P.Capabilities.animatable.transitionTo(e)),changeVisualState:e=>i(O.P.Capabilities.animatable.changeVisualState(e))}}function d(){return{select:(e,t)=>i(O.P.Capabilities.select.select(e,t)),selectByAlert:(e,t,a)=>i(O.P.Capabilities.select.selectByAlert(e,t,a)),unselect:(e,t)=>i(O.P.Capabilities.select.unselect((0,g.MZ)(e),t))}}function u(){return{removeAlertFromItem:(e,t)=>i((i=>i.id===y.D.SuccessReport.ID?i:O.P.Capabilities.removeAlert.removeAlertFromItem(e,t)(i)))}}function p(){return{remove:(e,t)=>i(O.P.Capabilities.remove.remove(e,t))}}function m(){return{updateWithAlerts:e=>i(g.yR)}}function h(){return{nextAlert:i((()=>L.none)),prevAlert:i((()=>L.none))}}function f(){return{updateUserInput:e=>i(g.yR)}}e.equatable={structEq:o(O.P.eq),idEq:o(n),visualStateEq:o(O.P.eq)},e.changePosition=l,e.disposable={isScheduledToDispose:i(O.P.Capabilities.disposable.isScheduledToDispose)},e.hidable={isHidden:i(T.o.isHidden)},e.animatableItem=c,e.hasAlertsQueries={isSelectableByAlert:e=>i(O.P.Capabilities.hasAlerts.isSelectableByAlert(e)),hasAlert:e=>i(O.P.Capabilities.hasAlerts.hasAlert(e)),hasActiveAlert:i(O.P.Capabilities.hasAlerts.hasActiveAlert)},e.changePositionStrategyQueries={useReferenceHeightOnRemove:i(g.jv)},e.select=d,e.removeAlert=u,e.remove=p,e.updateWithAlert=m,e.releaseAlert=()=>R.v.Capabilities.getAlertReleaser({...u(),...e.disposable}),e.unselectable=()=>R.v.Capabilities.getUnselectable(x.In.getActiveItem,d()),e.selectableByAlert=()=>R.v.Capabilities.getSelectableByAlert(x.In.getActiveItem,{...e.hasAlertsQueries,...d(),...R.v.Capabilities.getHasChecksFeed()}),e.selectableById=()=>R.v.Capabilities.getSelectableById(x.In.getActiveItem,d()),e.updateMeta=()=>({updateMeta:R.v.Capabilities.getMetaUpdatable().updateMeta}),e.animatableFeed=e=>R.v.Capabilities.getAnimatable(e,{...u(),...c(),...R.v.Capabilities.getHasChecksFeed()}),e.hasPriorityToggle=()=>R.v.WithPriority.getHasPriorityToggle({...c(),...e.hasAlertsQueries,...e.disposable}),e.alignable={isValidToAlign:i((t=>!e.disposable.isScheduledToDispose(t)))},e.alertIterator=h,e.itemReleaser=()=>R.v.Capabilities.getItemReleaser(),e.hasAlerts=R.v.Capabilities.getHasAlerts,e.hasUserInput=f,e.verifiable=()=>R.v.Capabilities.getVerifiable(e.disposable),e.cloneable=()=>({clone:i(M.s.Capabilities.getPojoCloneable().clone)});const v={getFeatures:i((e=>O.P.Item.isBulkDismissSDUI(e)?[O.P.Features.BulkDismiss]:O.P.Item.isBulkAcceptSDUI(e)?[O.P.Features.BulkAccept]:[]))};e.getCapabilities=function(t,i){return{...s(),...e.disposable,...e.hidable,...e.equatable,...f(),...e.cloneable(),...l(),...c(),...d(),...p(),...u(),...m(),...e.hasAlertsQueries,...e.changePositionStrategyQueries,...e.alignable,...e.releaseAlert(t),...e.unselectable(t),...e.selectableByAlert(t),...e.selectableById(t),...e.updateMeta(t),...e.animatableFeed(t),...e.hasPriorityToggle(t),...e.itemReleaser(),...v,...e.verifiable(),...e.cloneable(),...e.hasAlerts(h(),i,(()=>e.isSelectableItem),{...e.hasAlertsQueries,...e.disposable})}}}(A||(A={}));var H=i(53844);class G{constructor(e,t){this._domain=e,this._gnar=t}getDomain(){return this._domain}submitFeedback(e){this._gnar.assistantFeedbackSubmitButtonClick("single_card_assistant",e.domain,e.text,(0,H.dK)(e)?e.score:void 0)}}var j,W=i(14532),z=i(60797),q=i(98403),Z=i(77176),K=i(41398),$=i(71249),X=i(38983);!function(e){e.correct="correct",e.incorrect="incorrect",e.neutral="neutral"}(j||(j={}));class Y{constructor(e,t,i,a,s){this._learnMoreInfo=X.h.create(null),this._sub=new E.w;const n=(0,r.pipe)(a,Z.U((0,g.ls)((e=>e.actions),$.Ew((e=>"openLearnMore"===e.type||"switchView"===e.type&&"learn-more"===e.selected)))),z.oA);this._sub.add((0,r.pipe)(n,K.M(e),Z.U((([e,a])=>{let n=null;if(x.nL.hasItems(a)){const o=(0,r.pipe)(s(a.currentLens),L.getOrElseW((()=>null))),l=o?(0,r.pipe)(t.getById(o.activeAlert.id),L.getOrElseW((()=>null))):null,d=(0,r.pipe)(L.fromNullable(l),L.chain(C.bZ.getRawId),L.getOrElseW((()=>null))),u=d?i.alerts.getAlertById(d):null;u&&c.S.isCapiAlert(u)&&(n={title:u.todo,showTitleOnContent:"switchView"===e.type,details:u.details||u.explanation,examples:(0,r.pipe)(W.J.parse(u.examples,u.point.includes("Italicization")),L.map((e=>e.map((e=>e.map((e=>({type:e.color===W.J.Color.green?j.correct:e.color===W.J.Color.red?j.incorrect:j.neutral,title:(0,r.pipe)(e.title,L.map((e=>`${e}:`)),L.getOrElseW((()=>null))),text:e.text,useItalicText:!e.hasItalic}))))).flat())),L.getOrElseW((()=>[])))})}return n}))).subscribe(q.wW(this._learnMoreInfo)))}get learnMoreInfo(){return this._learnMoreInfo.view()}dispose(){this._sub.unsubscribe()}}var Q=i(95300),J=i(9922),ee=i(32952),te=i(2844),ie=i(2834),ae=i(21038);class se{constructor(e,t){this.popView=new ee.xQ,this._header=X.h.create(L.none),this._feed=new Q.X(L.none),this._defaultFeedId=X.h.create(L.none),this._subs=new J.w.Keeper,this._subs.push((0,g.zG)(this.popView,K.M(te.aj([t.sduiManager.state,t.sduiFeedManager.feed])),Z.U((([e,[t,i]])=>y.D.AssistantFeed.Header.getSelectedViewBackButtonActions(t,i.feedId))),z.oA,ie.b((t=>e.actionEvents.next(y.f.create(t))))).subscribe()),this._subs.push(t.sduiFeedManager.header.pipe(Z.U(L.of)).subscribe(q.wW(this._header))),this._subs.push(t.sduiFeedManager.feed.pipe(Z.U(L.of)).subscribe(this._feed)),this._subs.push(t.sduiManager.state.pipe(Z.U((e=>y.D.GButton.getPushAssistantFeedAction(e,y.D.GButton.DEFAULT_GBUTTON_ID))),Z.U((e=>(0,g.zG)(e,L.map((e=>ae.j.Item.Id.from(e.feedId))))))).subscribe(q.wW(this._defaultFeedId)))}get header(){return this._header}get feed(){return this._feed}get defaultFeedId(){return this._defaultFeedId}dispose(){this._subs.dispose()}}var ne=i(28043),re=i(66310),oe=i(40151),le=i(18208),ce=i(95195),de=i(40330),ue=i(79880);function pe(e,t,i){const{title:a,subTitle:s}=function(e,t){return{title:t<2?"Looking good so far":e>0?`${e} ${le._6(e,"issue addressed","issues addressed")}`:"Nice job!",subTitle:t<2?"Keep writing to see suggestions.":e>0?"All clear!":"You made that look easy!"}}(e,t);return{type:"assistantCard",id:y.D.SuccessReport.ID,child:{type:"viewStack",id:"card-viewStack",views:{"default-suggestion":{type:"column",id:de.JX.from("column"),children:[{type:"block",id:de.JX.from("block"),parts:[{type:"image",id:de.JX.from("image"),name:de.yL.unknown("success_report_image"),url:"https://assets.grammarly.com/icons/v1/notification-ok.svg",width:2,height:2}],name:de.yL.unknown("success_report_image_block"),spacing:{top:ue.T.D1,right:ue.T.D0,bottom:ue.T.D075,left:ue.T.D0},horizontalAlign:ue.Kq.Center},{type:"block",id:de.JX.from("block"),parts:[{type:"text",id:de.JX.from("text"),size:ue.yH.Regular,text:a,textColor:ue.Il.CoreNeutral90,format:[ue.SQ.Bold]}],name:de.yL.unknown("success_report_title_block"),horizontalAlign:ue.Kq.Center},{type:"block",id:de.JX.from("block"),parts:[{type:"text",id:de.JX.from("text"),size:ue.yH.Regular,text:s,textColor:ue.Il.CoreNeutral50,format:[]}],name:de.yL.unknown("success_report_subtitle_block"),horizontalAlign:ue.Kq.Center},{type:"block",id:de.JX.from("block"),parts:[],name:de.yL.unknown("success_report_subtitle_space_1_block"),spacing:{top:ue.T.D0,right:ue.T.D0,bottom:ue.T.D1,left:ue.T.D0}},{type:"block",id:de.JX.from("block"),parts:[],name:de.yL.unknown("success_report_subtitle_space_2_block"),spacing:{top:ue.T.D0,right:ue.T.D0,bottom:ue.T.D1,left:ue.T.D0}},{type:"block",id:de.JX.from("block"),parts:[],name:de.yL.unknown("success_report_subtitle_space_3_block"),spacing:{top:ue.T.D0,right:ue.T.D0,bottom:ue.T.D1,left:ue.T.D0}},{type:"block",id:de.JX.from("block"),parts:[],name:de.yL.unknown("success_report_subtitle_space_4_block"),spacing:{top:ue.T.D0,right:ue.T.D0,bottom:ue.T.D1,left:ue.T.D0}}],name:de.yL.unknown("success_report_content_column")},"tone-insights":{type:"nativeToneInsightsModal",id:"card-nativeToneInsightsModal"},feedback:{type:"nativeFeedbackModal",id:"card-nativeFeedbackModal"},settings:{type:"nativeSettingsModal",id:"card-nativeSettingsModal"}},selected:"default-suggestion"},onFocus:[{type:"switchView",where:"openToneDetectorButton-viewStack",selected:"show-open-tone-detector-button"},{type:"switchView",where:"card-viewStack",selected:"default-suggestion"},{type:"switchView",where:"header-viewStack",selected:"default-suggestion"},{type:"notify",userAction:ue.nz.Focus}],properties:i}}i(36572);const me=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g;var he=i(73582),ge=i(88661),fe=i(73763),ve=i(4390),we=i(85985),be=i(24209),_e=i(83078);const Se={"Style/ToneImprovement/ConfidentRewrite/ToneAI":"1f91d","Style/ToneImprovement/PersonableRewrite/ToneAI":"1f917","Style/ToneImprovement/PositiveFraming/ToneAI":"1f64c"},ye=["Style/Sensitivity/SupportUkraine/WarLanguage","Style/Sensitivity/ExtremelySensitive/SuicideIdeation"],Ee=e=>e.patternName.startsWith("Style/Sensitivity")&&!ye.some((t=>e.patternName===t));var ke;!function(e){e.isToneImprovementSuggestionInfo=function(e){return"emojiId"in e},e.isInclusiveLanguageToneSuggestionInfo=function(e){return"iconId"in e&&"inclusive_language"===e.toneCategory},e.createToneImprovementSuggestionUphookInfo=function(e){const t=e._raw.minicardTitle||e._raw.title||"",i=t.replace(me,"").trim(),a=t.match(me),s=a&&a.length?a[0]:null,n=Se[e.patternName];return{...s?{emojiLiteral:s}:n?{emojiId:n}:{},title:i,alertId:e.id,toneCategory:i,patternName:e.patternName,isUphook:!0}},e.isToneImprovementSuggestionUphookInfo=function(e){return"isUphook"in e&&e.isUphook}}(ke||(ke={}));class Ae{constructor(e,t,i,a,s,n,r,o,l,c){this._alertsReader=e,this._getSessionUuid=i,this._gnar=a,this.emogenieService=n,this._upgradeViewModel=r,this._cardActions=l,this._sduiItems=c,this._toneSuggestionInfo=X.h.create(void 0),this._sub=new E.w;const d=this._sduiItems.view(y.D.StrongAlertRef.getStrongAlertRefBulkDismissAlertIds),u=X.h.combine(t,d,((e,t)=>ve.p.reduce([],((e,i)=>(t.has(i.id)||e.push(i.alert),e)))(e))),p=n.viewState.view("isBrandTonesEnabled"),m=o.view("isPremium"),h=o.view("isGrammarlyEmployee"),g=X.h.combine(u,p,m,h,((e,t,i,a)=>Ae.getToneSuggestionInfoFromAlerts(e,t,i,a?s.isGateEnabled(ge.K.InclusiveLanguageRedesignInternal):"test"===s.getTreatment(fe.p.InclusiveLanguageRedesignExternal)))),f=g.pipe(we.h((e=>void 0===e||!ke.isToneImprovementSuggestionUphookInfo(e)))),v=g.pipe(we.h((e=>void 0!==e&&ke.isToneImprovementSuggestionUphookInfo(e)&&"test"===s.getTreatment(fe.p.ToneDetectorUphook))));this._sub.add(be.T(f,v).subscribe(q.wW(this._toneSuggestionInfo))),this.toneSuggestionInfo=this._toneSuggestionInfo.view()}static getToneSuggestionInfoFromAlerts(e,t,i,a){let s;if(i){s=e.filter((e=>e.patternName.startsWith("Style/ToneImprovement")||a&&Ee(e))).map((e=>{var t,i,a;return Ee(e)?{iconId:null!==(t=e._raw.extra_properties.icon_id)&&void 0!==t?t:"",title:e.miniCardTitle,alertId:e.id,toneCategory:"inclusive_language",patternName:e.patternName}:{emojiId:null!==(i=e._raw.extra_properties.emoji_id)&&void 0!==i?i:"",title:C.bZ.isToneAI(e)?e.miniCardTitle:e.miniCardTitle.replace(me,"").trim(),alertId:e.id,toneCategory:null!==(a=e._raw.extra_properties.tone)&&void 0!==a?a:"",patternName:e.patternName}}))}else{s=e.filter((e=>e._raw.hidden&&(e=>e.patternName.startsWith("Style/ToneImprovement"))(e))).map(ke.createToneImprovementSuggestionUphookInfo)}const n=new Set(s.map((e=>e.toneCategory))),r=s[0],o=t?"Want to sound more on-brand?":n.size>1?"Strike the right tone":null==r?void 0:r.title;return r?{...r,title:o}:r}_getCurrentSessionUuid(){return(0,r.pipe)(this._getSessionUuid(),L.getOrElse((()=>"")))}onShowToneSuggestionInfo(e){const t=ke.isToneImprovementSuggestionInfo(e)?e.emojiId:ke.isInclusiveLanguageToneSuggestionInfo(e)?e.iconId:e.emojiId||e.emojiLiteral||"",i=ke.isToneImprovementSuggestionUphookInfo(e);this._gnar.toneDetectorToneSuggestionInfoShow(i,e.patternName,this._getCurrentSessionUuid(),e.title,t)}onClickToneSuggestionInfoCta(e){const t=ke.isToneImprovementSuggestionInfo(e)?e.emojiId:ke.isInclusiveLanguageToneSuggestionInfo(e)?e.iconId:e.emojiId||e.emojiLiteral||"",i=ke.isToneImprovementSuggestionUphookInfo(e);if(this._gnar.toneDetectorToneSuggestionInfoCtaClick(i,e.patternName,this._getCurrentSessionUuid(),e.title,t),i)this._upgradeViewModel.openUpgradeUrl(he.L.Place.toneSuggestion);else{const t=this._sduiItems.get(),i=(0,r.pipe)(this._alertsReader.getById(e.alertId),L.chain(C.bZ.getRawId),L.chain((e=>y.D.getByAlertId(t,e))),_e.MH);this._cardActions.next(y.f.create([y.D.AssistantFeed.createPushAssistantFeedAction(y.D.AssistantFeed.TONE_INSIGHTS_SUGGESTIONS_FEED_ID,i.id)]))}}dispose(){this._sub.unsubscribe()}}var Ie=i(66896),Ce=i(60682),Me=i(22232),Te=i(73975);const xe=e=>{switch(e){case Ie.R.Type.Critical:case Ie.R.Type.Correctness:return ue.Il.CoreRed50;case Ie.R.Type.Clarity:return ue.Il.CoreBlue50;case Ie.R.Type.Engagement:return ue.Il.CoreGreen60;case Ie.R.Type.Delivery:return ue.Il.CorePurple40;case Ie.R.Type.Vox:return ue.Il.CoreNeutral50;case Ie.R.Type.Plagiarism:return ue.Il.CoreCyan50;case Ie.R.Type.Advanced:case Ie.R.Type.Other:return;default:return(0,Me.vE)(e)}},Re=(e,t,i)=>{var a;const s=(a=e,Object.values(a.reduce(((e,t)=>{const i=t.lensType;return e[i]?e[i]={...e[i],lensNames:$.jj(Te.w4)([...e[i].lensNames,t.lensName]),alertsCount:e[i].alertsCount+1}:e[i]={lensNames:[t.lensName],lensType:t.lensType,alertsCount:1},e}),{}))).map((e=>{var t;return de.X2.create([{type:"block",fraction:1,horizontalAlign:ue.Kq.Center,id:de.JX.from("block"),name:de.yL.unknown("upgrade_hook_counter"),parts:[de.XF.create(e.alertsCount.toString(),null!==(t=xe(e.lensType))&&void 0!==t?t:ue.Il.CoreNeutral50)]},{type:"block",fraction:11,id:de.JX.from("block"),name:de.yL.unknown("upgrade_hook_alert_group"),parts:[de.xv.create(le.kC(e.lensType),ue.yH.Regular,[],ue.Il.CoreNeutral90,void 0,void 0),de.xv.create(` · ${e.lensNames.join(", ")}`,ue.yH.Regular,[],ue.Il.CoreNeutral50,void 0,void 0)]}],[],de.Ki.create("0.5","0.25","0.25","0.75"),ue.g$.Middle)})),n=de.sg.create([de.X2.create([de.gO.create("title",void 0,void 0,de.xv.create("Premium suggestions available:",ue.yH.Regular,[ue.SQ.Bold],ue.Il.CoreNeutral90,void 0,void 0))],[],de.Ki.create("0.75","0.25","0.5","0.75"),ue.g$.Middle),de.gO.create("content",void 0,void 0,...s),de.X2.create([{...de.gO.create("actions",void 0,de.n4.create("0.5","0"),{type:"button",id:de.JX.from("goPremium"),name:i?de.yL.unknown("goPremiumExp"):de.yL.unknown("goPremium"),shape:ue.jL.Square,actions:[{type:"upgradeToPremium"},{type:"notify",userAction:ue.nz.Click}],kind:ue.Lv.Primary,state:ue.BN.Enabled,label:{...de.gO.create("",de.Ki.create("0","0.5","0","0.25"),de.n4.create("0.25","0.25"),de.JO.create(de.JO.Source.createKnown(ue.Tb.Diamond),void 0),de.xv.create("Unlock Premium",ue.yH.Regular,[],i?ue.Il.CoreYellow80:ue.Il.CoreNeutral0,void 0,void 0)),verticalAlign:ue.g$.Middle}},{type:"button",id:de.JX.from("button"),name:de.yL.unknown("dismiss"),shape:ue.jL.Square,actions:[{type:"removeCard"},{type:"notify",userAction:ue.nz.Click}],kind:ue.Lv.Secondary,state:ue.BN.Enabled,label:de.gO.create("",de.Ki.create("0","0.5","0","0.5"),{horizontal:ue.T.D025,vertical:ue.T.D0},de.xv.create("Dismiss",ue.yH.Regular,[],ue.Il.CoreNeutral50,void 0,void 0))}),verticalAlign:ue.g$.Middle}],[de.gO.create("navigation-arrows",void 0,void 0,de.zx.createIcon(ue.MU.ButtonPrev,de.JO.Source.createKnown(ue.Tb.ArrowLeft),[{type:"prevCard"},{type:"transition",fromName:"content",toName:"content",animateFrom:ue.c1.SlideRight,animateTo:ue.c1.SlideRight},{type:"transition",fromName:"title",toName:"title",animateFrom:ue.c1.SlideRight,animateTo:ue.c1.SlideRight},{type:"notify",userAction:ue.nz.Click}],ue.Lv.Secondary,"Previous suggestion"),de.zx.createIcon(ue.MU.ButtonNext,de.JO.Source.createKnown(ue.Tb.ArrowRight),[{type:"nextCard"},{type:"notify",userAction:ue.nz.Click}],ue.Lv.Secondary,"Next suggestion"))],de.Ki.create("0.5","0.25","1","0.75"),ue.g$.Middle)]);return{id:y.D.UpgradeHook.ID,type:"assistantCard",child:{...de.XJ.create("default-suggestion",{"default-suggestion":n,feedback:{type:"nativeFeedbackModal",id:"card-nativeFeedbackModal"},settings:{type:"nativeSettingsModal",id:"card-nativeSettingsModal"},"tone-insights":{type:"nativeToneInsightsModal",id:"card-nativeToneInsightsModal"}}),id:"card-viewStack"},onFocus:[{type:"switchView",where:"openToneDetectorButton-viewStack",selected:"show-open-tone-detector-button"},{type:"switchView",where:"card-viewStack",selected:"default-suggestion"},{type:"switchView",where:"header-viewStack",selected:"default-suggestion"},{type:"notify",userAction:ue.nz.Focus}],properties:{...t,"feed-order":1}}};var Fe=i(31699);const Le=({htmlToSanitize:e,...t})=>o.createElement("div",{...t,dangerouslySetInnerHTML:{__html:(0,Fe.sanitize)(e)}});var Pe=i(12187),Ve=i(7538);const Oe=({title:e,details:t,examples:i})=>o.createElement("div",{className:Ve.learnMore},void 0!==e?o.createElement("div",{className:Ve.learnMoreTitle},le.kC(e)):null,o.createElement(Le,{htmlToSanitize:t}),i.map(((e,t)=>{const i=e.type===j.correct,a=e.type===j.incorrect,s=i||a?o.createElement("div",{...(0,Pe.Sh)(Ve.learnMoreExampleIcon,i?Ve.learnMoreExampleCorrectIcon:null,a?Ve.learnMoreExampleIncorrectIcon:null)}):null;return o.createElement("div",{className:Ve.learnMoreExample,key:`learn-more-example-${t}`},e.title?o.createElement(o.Fragment,null,o.createElement("div",{className:Ve.learnMoreExampleIconAndTitle},s,o.createElement("div",{className:Ve.learnMoreExampleTitle},e.title)),o.createElement(Le,{...(0,Pe.Sh)(s?Ve.learnMoreExampleTextMarginLeft:null,e.useItalicText?Ve.learnMoreExampleTextItalic:null),htmlToSanitize:e.text})):o.createElement(Le,{...(0,Pe.Sh)(e.useItalicText?Ve.learnMoreExampleTextItalic:null),htmlToSanitize:e.text}))})));var Ne=i(5739);const Be=({learnMoreInfo:e})=>o.createElement(Ne.F.Fragment,null,e.view((e=>e?o.createElement(Oe,{title:e.showTitleOnContent?e.title:void 0,details:e.details,examples:e.examples}):null)));var Ue=i(55364),De=i(73008),He=i(88326);const Ge=({children:e,popActiveView:t,panelClassName:i,contentClassName:a,footer:s,onClickBack:n,hideBackButton:r=X.h.create(!1),dataPartName:l})=>o.createElement("div",{className:De.viewOverlay,"data-grammarly-part":"assistant-view-overlay"},o.createElement(Ne.F.Fragment,null,r.view((e=>!e&&o.createElement(He.M,{className:De.viewOverlayGoBack,clickHandler:()=>n?n():t(),dataGrammarlyPart:"assistant-go-back"},"<- Back")))),o.createElement("div",{className:i||De.defaultViewOverlayPanel},o.createElement("div",{className:a||De.content,"data-grammarly-part":l},e),s&&o.createElement("div",{className:De.footer},s)));var je=i(86705);const We=({popActiveView:e,browser:t,onClickBack:i,children:a})=>{const[s,n]=o.useState(!1);return o.createElement(Ge,{dataPartName:"proofit-view-overlay",popActiveView:e,panelClassName:Ue.proofitViewOverlayPanel,onClickBack:i},o.createElement("div",{className:Ue.proofitViewOverlayContent,tabIndex:-1,ref:e=>{null===e||s||(e.focus(),n(!0))}},o.createElement("div",{className:De.defaultViewOverlayHeader},o.createElement("div",{className:Ue.proofitViewOverlayHeader},"Expert Writing Help",o.createElement(je.v,{browser:t,className:Ue.proofitViewOverlayHeaderBetaBadge}))),a))};var ze=i(10247),qe=i(24606),Ze=i(31944),Ke=i(81108);var $e=i(59e3),Xe=i(41063),Ye=i(17487);const Qe=({turnaroundTime:e})=>o.createElement("div",{className:Xe.proofitHowItWorksSteps},o.createElement("div",{...(0,Pe.Sh)(Xe.proofitHowItWorksStep,Xe.proofitHowItWorksStepOne)},"Your draft will be minimized and shared with writing experts.",o.createElement("div",{...(0,Pe.Sh)(Xe.proofitHowItWorksStepNumberContainer,Xe.proofitHowItWorksStepOneNumberContainer)},o.createElement("div",{...(0,Pe.Sh)(Xe.proofitHowItWorksStepNumber,Xe.proofitHowItWorksStepOneNumber)},"1"))),o.createElement("div",{...(0,Pe.Sh)(Xe.proofitHowItWorksStep,Xe.proofitHowItWorksStepTwo)},"You will see progress indication. The average turnaround is ",e," seconds.",o.createElement("div",{...(0,Pe.Sh)(Xe.proofitHowItWorksStepNumberContainer,Xe.proofitHowItWorksStepTwoNumberContainer)},o.createElement("div",{...(0,Pe.Sh)(Xe.proofitHowItWorksStepNumber,Xe.proofitHowItWorksStepTwoNumber)},"2"))),o.createElement("div",{...(0,Pe.Sh)(Xe.proofitHowItWorksStep,Xe.proofitHowItWorksStepThree)},"Your draft will re-open with revisions highlighted.",o.createElement("div",{...(0,Pe.Sh)(Xe.proofitHowItWorksStepNumberContainer,Xe.proofitHowItWorksStepThreeNumberContainer)},o.createElement("div",{...(0,Pe.Sh)(Xe.proofitHowItWorksStepNumber,Xe.proofitHowItWorksStepThreeNumber)},"3")))),Je=({turnaroundTime:e,freeTrialQuota:t,onSubmit:i,disabledInfo:a=null,isLoading:s=!1,style:n,onTogglePrivacyInfo:r,showPrivacyInfo:l,disableHowItWorksInfo:c=!1,onDisableHowItWorksInfo:d,showHowItWorksInfo:u,onShowHowItWorksInfo:p})=>{const[m,h]=o.useState(null!=l&&l),[g,f]=o.useState(null!=u&&u),v=t>0?t:0;var w,b;o.useEffect((()=>{null==r||r(m)}),[m]),o.useEffect((()=>{h(null!=l&&l)}),[l]),o.useEffect((()=>{f(null!=u&&u)}),[u]),w=()=>null==p?void 0:p(),b=g,o.useEffect((()=>{b&&w()}),[b]);const _=o.useCallback((()=>{c||g?i():f(!0)}),[c,g,i]);return o.createElement("div",{"data-grammarly-part":"proofit-request-form",style:{width:"100%",height:"100%",...n}},o.createElement("div",{className:Ye.proofitRequestForm},m?o.createElement(o.Fragment,null,o.createElement("div",{className:Ye.proofitRequestFormPrivacyInfoTitle},"How we protect you"),o.createElement("div",{className:Ye.proofitRequestFormPrivacyInfoDescription},o.createElement("div",{className:Ye.proofitRequestFormPrivacyInfoDescriptionItem},o.createElement("div",{className:Ye.proofitRequestFormPrivacyInfoDescriptionItemBulletPoint}),o.createElement("div",{className:Ye.proofitRequestFormPrivacyInfoDescriptionItemText},"Our writing experts will see only your current email draft—no prior messages or contact details.")),o.createElement("div",{className:Ye.proofitRequestFormPrivacyInfoDescriptionItem},o.createElement("div",{className:Ye.proofitRequestFormPrivacyInfoDescriptionItemBulletPoint}),o.createElement("div",{className:Ye.proofitRequestFormPrivacyInfoDescriptionItemText},"We will not sell, rent, or make public any of your personal data."))),o.createElement(qe.z,{kind:"outlined",onClick:()=>h(!1)},"Continue")):o.createElement(o.Fragment,null,g?o.createElement(Qe,{turnaroundTime:e}):o.createElement(o.Fragment,null,o.createElement("div",{className:Ye.proofitRequestFormImg}),o.createElement("div",{className:Ye.proofitRequestFormTitle},"Get instant writing help"),o.createElement("div",{className:Ye.proofitRequestFormDescription},"Our writing experts are standing by to review your email."),o.createElement("div",{className:Ye.proofitRequestFormCostAndTime},o.createElement("div",{className:Ye.proofitRequestFormCost},o.createElement("div",{className:Ye.proofitRequestFormCostAndTimeTitle},v," free ",le._6(v,"review","reviews")),o.createElement("div",{className:Ye.proofitRequestFormCostAndTimeSubtitle},"left this month",o.createElement("sup",null,"*"))),o.createElement("div",{className:Ye.proofitRequestFormTime},o.createElement("div",{className:Ye.proofitRequestFormCostAndTimeTitle},e," seconds"),o.createElement("div",{className:Ye.proofitRequestFormCostAndTimeSubtitle},"average turnaround")))),o.createElement(qe.z,{kind:"primary",className:Ye.proofitRequestFormRequestBtn,disabled:Boolean(a||s),onClick:_},s?o.createElement("div",{className:$e.proofitRequestFormBtnLoadingSpinner}):c||g?"Start review":"Request now"),a||s?a?o.createElement("div",{className:Ye.proofitRequestFormUnavailableMsg},o.createElement(Ke.Q,{info:a})):null:o.createElement(qe.z,{kind:"link",onClick:()=>h(!0)},"Learn how we protect your privacy"),o.createElement("div",{...(0,Pe.Sh)(Ye.proofitRequestFormFootnote,g?Ye.proofitRequestFormFootnoteHowItWorksDontShowAgainCheckbox:Ye.proofitRequestFormFootnoteFreeTrial)},g?o.createElement(Ze.J,{labelId:"proofit-request-form-how-it-works-dont-show-again",onChange:d},"Don't show this again"):o.createElement("span",null,o.createElement("sup",null,"*")," included with your Premium subscription")))))};var et=i(2027);const tt=({proofitVM:e,...t})=>{const i=(0,et.fW)(),[a,s]=o.useState(!1),[n,r]=o.useState(!1),l=o.createElement(Ne.F.Fragment,null,(0,te.aj)([e.feature.layoutCreated,e.feature.requestInfo,e.feature.turnaroundTime,e.feature.quotaRemaining,e.feature.requestDisabledInfo,e.feature.disableHowItWorksInfo]).pipe((0,Z.U)((([t,l,c,d,u,p])=>t&&l.status!==ze.eE.REVIEWING?o.createElement(Je,{turnaroundTime:c,freeTrialQuota:d,onSubmit:()=>e.onSubmitRequest(i),style:{height:"calc(100% - 48px)"},disabledInfo:u,isLoading:l.status===ze.eE.PREPARING||l.status===ze.eE.PRE_SUBMIT,showPrivacyInfo:a,onTogglePrivacyInfo:s,disableHowItWorksInfo:p,onDisableHowItWorksInfo:t=>e.feature.onDisableHowItWorksInfo(t),showHowItWorksInfo:n,onShowHowItWorksInfo:()=>r(!0)}):null))));return t.insideSingleCardAssistant?l:o.createElement(We,{popActiveView:t.popActiveView,browser:t.browser,onClickBack:()=>{a?s(!1):n?r(!1):t.popActiveView()}},l)};var it=i(8400);const at=({suggestionsMade:e,onAccept:t,onFeedbackFormSubmitted:i})=>o.createElement("div",{className:it.proofitReviewForm,"data-grammarly-part":"proofit-review-form"},o.createElement("div",{className:it.proofitReviewFormTitle},"Our experts made ",e," ",le._6(e,"suggestion","suggestions")),o.createElement("div",{className:it.proofitReviewFormDescription},"Are you satisfied with the suggestions that our experts provided?"),o.createElement("div",{className:it.proofitFeedbackForm},o.createElement(H.q5,{hideLogo:!0,hideTitle:!0,hideTextBoxTitle:!0,withScore:!0,placeholderText:"How can we improve?",onSubmit:i,showPostSubmitScreen:!1})),o.createElement("div",{className:it.proofitDoneButton},o.createElement(qe.z,{kind:"link",onClick:t},"Done"))),st=({proofitVM:e,...t})=>{const i=(0,et.fW)(),a=o.createElement(Ne.F.Fragment,null,(0,te.aj)([e.feature.layoutCreated,e.feature.requestInfo]).pipe((0,Z.U)((([t,a])=>t&&a.status===ze.eE.REVIEWING?o.createElement(at,{suggestionsMade:a.suggestionsMade,onAccept:()=>e.onCompleteRequest(i),onFeedbackFormSubmitted:t=>{e.onSubmitFeedback(t),e.onCompleteRequest(i)}}):null))));return t.insideSingleCardAssistant?a:o.createElement(We,{popActiveView:t.popActiveView,browser:t.browser},a)};var nt=i(5178),rt=i(22679),ot=i(20855),lt=i(47960),ct=i(25262),dt=i(90282);const ut=({feedbackVM:e,entryPoint:t})=>o.createElement(ot.u,{showDelay:rt.gk,message:"Leave feedback"},o.createElement("div",{className:dt.feedbackButton,onClick:()=>e.openFeedback(t),"data-grammarly-part":"assistant-feedback-btn"},o.createElement(lt.A,{color:ct.Z.blue50}),"Anything we can improve?"));var pt=i(19106),mt=i(17324),ht=i(50034),gt=i(99446);const ft=()=>o.createElement("svg",{width:"11",height:"12",viewBox:"0 0 11 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{d:"M4 1H2.5C1.39543 1 0.5 1.89543 0.5 3V9C0.5 10.1046 1.39543 11 2.5 11H8.5C9.60457 11 10.5 10.1046 10.5 9V7.5M5.5 6L10.5 1M10.5 1H6.5M10.5 1V5",stroke:"#4A6EE0",strokeLinecap:"round"}));var vt=i(5872),wt=i(90361),bt=i(26485),_t=i(68089);const St=({children:e,blocked:t,wrapperClassName:i})=>t?o.createElement(ot.u,{message:"Sign in to use this feature",position:"top"},o.createElement("div",{className:i},o.createElement("div",{className:_t.hover_blocker,onClick:wt.EI,onDoubleClick:wt.EI},e))):o.createElement(o.Fragment,null,e);var yt=i(92783);class Et extends o.Component{constructor(){super(...arguments),this.handleChange=e=>{(this.props.skipTrustedCheck||e.isTrusted)&&this.props.onChange(e)}}render(){return o.createElement("div",{...(0,Pe.Sh)(this.props.extraClassName,bt.setting_item,this.props.disabled&&bt.disabled)},o.createElement("label",{className:(0,vt.cs)(bt.select_checkbox,this.props.centered?bt.centered:void 0),"data-grammarly-part":this.props.dataGrammarlyPart},o.createElement("div",{className:bt.select_children},this.props.children,this.props.beta&&o.createElement("span",{className:(0,yt.G6)()?bt.new:bt.beta}),this.props.alpha&&o.createElement("span",{className:(0,yt.G6)()?bt.new:bt.alpha})),o.createElement(St,{wrapperClassName:bt.checkbox_control_wrapper,blocked:this.props.disabled}),o.createElement("input",{className:bt.checkbox,onChange:this.props.disabled?wt.EI:this.handleChange,checked:this.props.checked,type:"checkbox"}),o.createElement("div",{...(0,Pe.Sh)(bt.checkbox_check,this.props.grayOut&&bt.grayOut,this.props.checked?bt.on:bt.off)},o.createElement("div",{...(0,Pe.Sh)(bt.on_off)},this.props.checked?"ON":"OFF"),o.createElement("div",{className:bt.checkbox_check_round}))))}}var kt=i(62111),At=i(47740);const It=({showTitle:e,showBackground:t,openGBLanding:i})=>o.createElement("div",{...(0,Pe.Sh)(At.container,t?At.containerWithBackground:null)},o.createElement("div",{className:At.content},e&&o.createElement("div",{className:At.title},"Grammarly for your team"),o.createElement("div",null,"Help your team make your business look great with top-notch writing."),o.createElement(qe.z,{size:"medium",onClick:()=>{i((0,yt.Um)().businessEHomepage),(0,kt.T)().gGbUpHookClick()},className:At.button},"Explore Grammarly Business")));var Ct=i(1005);const Mt=({heading:e,enabled:t,children:i})=>t?o.createElement(o.Fragment,null,o.createElement("div",{className:Ct.heading},e),o.createElement("div",null,i)):o.createElement(o.Fragment,null,i);var Tt=i(4120),xt=i(24372);class Rt extends o.Component{constructor(){super(...arguments),this.onEnableDefsClick=e=>{const{toggleDefs:t}=this.props,i=e.target.checked;t(i),xt.J.definitionToggleClick(i?"on":"off"),(0,kt.T)().toggleExtensionDefs(i)}}render(){const{enabledDefs:e,disabled:t}=this.props;return o.createElement(Et,{onChange:this.onEnableDefsClick,checked:e,extraClassName:mt.def_switcher,dataGrammarlyPart:"definitionAndSynonymsSwitcher",disabled:t,skipTrustedCheck:this.props.skipTrustedCheck},"Show definitions and synonyms ",o.createElement("br",null),"via double clicks (all sites)")}}var Ft=i(6304),Lt=i(66402);const Pt=()=>o.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{d:"M13.9207 15L15.5 17.2562L17.0793 15H13.9207Z",stroke:"#6D758D",strokeWidth:"2"}));var Vt=i(64757),Ot=i(18813),Nt=i(71527);const Bt={american:o.createElement((()=>o.createElement("div",{className:Lt.american,role:"presentation"})),null),australian:o.createElement((()=>o.createElement("div",{className:Lt.australian,role:"presentation"})),null),british:o.createElement((()=>o.createElement("div",{className:Lt.british,role:"presentation"})),null),canadian:o.createElement((()=>o.createElement("div",{className:Lt.canadian,role:"presentation"})),null)},Ut=["british","american","australian","canadian"],Dt=e=>{return o.createElement(o.Fragment,null,Bt[e.dialect],o.createElement("span",{"data-test-attr":`dialect_${e.dialect}`,className:Nt.label},(t=e.dialect).charAt(0).toUpperCase()+t.slice(1)+" English"));var t};class Ht extends o.Component{render(){const e=this.props.dropdownOnTop?{customPosition:{top:"-100px",left:"0"},vAlign:"top"}:{customPosition:{top:"36px",left:"0"}};return o.createElement(Ot.L,{...e,showDelay:0,closeDelay:150,appearanceBehavior:"mouseClick",name:"dialect",label:o.createElement(Vt.zx.White,{name:"dialect.box",style:{padding:"0"}},o.createElement("div",{className:Nt.selected},o.createElement(Dt,{dialect:this.props.dialect}),o.createElement(Pt,null)))},Ut.filter((e=>e!==this.props.dialect)).map((e=>o.createElement(Vt.zx.Flat,{name:e,key:e,onClick:t=>(null==t?void 0:t.isTrusted)&&this.props.onSetDialect(e)},o.createElement("div",{className:Nt.option},o.createElement(Dt,{dialect:e}))))))}}class Gt extends o.Component{constructor(){super(...arguments),this.setDialect=e=>{const{changeStrongDialect:t,dialectWeak:i}=this.props;t(e);const a=e+"English";xt.J.languageSettingUpdate(a,"user",i&&e===i)}}render(){const e=this.props.dialectStrong||this.props.dialectWeak||"american";return o.createElement("div",{...(0,Pe.Sh)(Ft.line,this.props.disabled&&Ft.disabled)},o.createElement("div",null,"I write in"),o.createElement(St,{blocked:this.props.disabled},o.createElement("div",{className:Ft.dialectPicker},o.createElement(Ht,{dialect:e,onSetDialect:this.setDialect,dropdownOnTop:!!this.props.dropdownOnTop}))))}}const jt=e=>{const t="docs.google.com"===e.domain,i=t?"Google Docs":e.domain,a=t&&!(0,yt.Am)(),{enabledInConfig:s,siteSwitcherChecked:n,favicon:r}=e,l=n.checked&&s,c=s?"Check for writing suggestions":"Checking is not supported";return o.createElement(Et,{grayOut:!s,onChange:e=>n.update(e.target.checked),checked:l,extraClassName:mt.site_switcher,dataGrammarlyPart:"siteSwitcher",skipTrustedCheck:e.skipTrustedCheck,centered:!!e.centeredToggle},o.createElement("div",{"data-test-attr":"siteControlsLabelText"},c,o.createElement("br",null)," ",o.createElement("span",{...(0,Pe.Sh)(mt.domain,e.centeredToggle&&mt.centered)},o.createElement("span",{className:mt.thin_text},"on")," ",r&&o.createElement("span",{className:mt.favicon},o.createElement("img",{width:"16px",height:"16px",src:r})),i,a&&o.createElement("span",{className:bt.beta}))))};var Wt=i(56542),zt=i(37896),qt=i(23345);const Zt=o.createContext({}),Kt=e=>{const t=o.useContext(Zt),{registrationDate:i}=e.user,a=(0,zt.p6)(i);return o.createElement("div",{className:qt.line},o.createElement("div",{className:qt.content},a&&o.createElement("div",{"data-test-attr":"checked_since"},"Grammarly has been correcting your text since ",a,"."),o.createElement("div",{"data-grammarly-part":"summaryUpgradeBtn",className:qt.upgrade,onClick:()=>{e.openSubscriptionDialog({utmSource:"upHook",utmCampaign:"extensionSettingsToolbar"}),xt.J.getPremiumButtonClick(e.isAssistant?"assistantSettings":"settingsToolbar","GoPremiumToEnableAdvancedFixes"),(0,kt.T)().userUpgradeClick("settingsToolbar")},style:{fontSize:t.ctaFontSize}},"Go Premium to Enable Advanced Fixes")))},$t=e=>o.createElement(Et,{onChange:t=>{e.toggle(t.target.checked)},checked:e.enabled,extraClassName:mt.def_switcher},"Correct spelling automatically"),Xt=e=>o.createElement(Et,{checked:!e.enabled,extraClassName:mt.def_switcher,onChange:t=>{e.toggle(!t.target.checked)},dataGrammarlyPart:"disableDesktopIntegrationToggle"},o.createElement("div",{className:mt.llamaTitle},"Check text with browser extension"),e.enabled&&o.createElement("div",{className:mt.llamaDescription},"Grammarly's browser extension was deactivated since you're using Grammarly's desktop application.")),Yt=e=>o.createElement(Et,{onChange:t=>{e.toggle(t.target.checked)},beta:!0,checked:e.enabled,extraClassName:mt.def_switcher},"Show phrasal predictions"),Qt=e=>o.createElement(Et,{onChange:t=>{e.toggle(t.target.checked)},checked:e.enabled,extraClassName:mt.def_switcher,dataGrammarlyPart:"settings-toggle-show-emoji-for-detected-tones"},"Show emoji for detected tones"),Jt=e=>o.createElement(Et,{onChange:t=>{e.toggle(t.target.checked)},beta:!0,checked:e.enabled,extraClassName:mt.def_switcher},"Show email recaps"),ei=e=>o.createElement(Et,{onChange:t=>{e.toggle(t.target.checked)},checked:e.enabled,extraClassName:mt.def_switcher},"Show Knowledge Hub"),ti=e=>o.createElement(Et,{onChange:t=>{e.toggle(t.target.checked)},beta:!0,checked:e.enabled,extraClassName:mt.def_switcher},"Show “Get citation” button on ",e.domain),ii=e=>{var t,i,a,s,n,r,l;const{actions:c,activeTab:d,config:u,settings:p,dapi:m,user:h,siteCategory:g,openSubscriptionDialog:f,openGBLanding:v,showGBUpHook:w,placement:b,dynamicConfig:_,enableRenderingHack:S=!1,isReaderSupported:y=!1,citationBuilderSessionId:E,isKnowledgeHubSupported:k=!1}=e;S&&o.useEffect((()=>{(0,yt.CB)()&&(self.screenLeft<0||self.screenTop<0||self.screenLeft>self.screen.width||self.screenTop>self.screen.height)&&chrome.runtime.getPlatformInfo((e=>{if("mac"===e.os){const e=new CSSStyleSheet;e.insertRule("\n            @keyframes redraw {\n              0% {\n                opacity: 1;\n              }\n              100% {\n                opacity: .99;\n              }\n            }\n          "),e.insertRule("\n            html {\n              animation: redraw 1s linear infinite;\n            }\n          "),document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}}))}),[]);const{premium:A,experiments:I,anonymous:C}=h,M=w&&A&&!Tt.n5.doesUserBelongToInstitution(h),T=A||C,x=e.siteSwitcherChecked||{checked:!!p.enabled,update:t=>{const{siteCategory:i}=e;c.toggleSite(t,u.domain),xt.J.checkingToggleClick("toolbar",i,t?"on":"off"),(0,kt.T)().toggleExtension(t,"toolbar")}},R=!1;return o.createElement("div",{className:Wt.settingsContent,"data-grammarly-part":"settings"},o.createElement("div",{className:Wt.heading},o.createElement("div",null,"Quick Settings"),o.createElement(qe.z,{kind:"link",onClick:()=>{e.openUrl((0,yt.Um)().allSettings),xt.J.allSettingsButtonClick(b)}},o.createElement("div",{className:Wt.allSettings},o.createElement("span",null,"All Settings"),o.createElement(ft,null)))),E&&o.createElement(Mt,{heading:"CITATION BUILDER SETTING",enabled:R},o.createElement(ti,{enabled:(0,ht.Ov)(u.domain,{user:h,dynamicConfig:_},p),domain:u.domain,toggle:e=>{c.toggleCitationBuilderForDomain({domain:u.domain,enabled:e}),e||xt.J.citePopupButtonDisable(u.domain,"permanent",E,"toolbar")}}),o.createElement("div",{className:Wt.separator})),gt.q.showSettingPopupToggle(m,p,_,null==d?void 0:d.url)&&o.createElement(Mt,{heading:"DESKTOP INTEGRATION SETTING",enabled:R},o.createElement(Xt,{toggle:e=>{c.setDesktopIntegration(e),xt.J.desktopIntegrationToggleClick(e?"on":"off")},enabled:p.isDesktopIntegrationEnabled}),o.createElement("div",{className:Wt.separator})),o.createElement(Mt,{heading:"SITE SETTINGS",enabled:R},o.createElement(jt,{domain:u.domain,enabledInConfig:null!==(t=u.enabled)&&void 0!==t&&t,siteSwitcherChecked:x,favicon:null==d?void 0:d.favIconUrl,siteCategory:g,experiments:I}),o.createElement("div",{className:Wt.separator})),o.createElement(Mt,{heading:"FEATURES (ALL SITES)",enabled:R},o.createElement(Rt,{disabled:C,enabledDefs:p.enabledDefs,toggleDefs:c.toggleDefs}),o.createElement("div",{className:Wt.separator}),o.createElement($t,{enabled:p.autocorrectEnabled||!1,toggle:e=>{c.toggleAutocorrect(e),xt.J.autocorrectToggleClick(e?"on":"off")}}),o.createElement("div",{className:Wt.separator}),o.createElement(Yt,{enabled:p.autocompleteEnabled||!1,toggle:e=>{c.toggleAutocomplete(e),xt.J.autocompleteFeatureToggleClick("popup",e?"on":"off")}}),o.createElement("div",{className:Wt.separator}),o.createElement(Qt,{enabled:"hide"!==m.emogenieEmojiState,toggle:e=>{c.setEmogenieEmojiState(!0===e?"show":"hide"),xt.J.settingsShowEmojiForDetectedTonesToggleClick(u.domain,!0===e?"on":"off")}}),y&&(null===(a=null===(i=p.reader)||void 0===i?void 0:i.gmail)||void 0===a?void 0:a.seenOnboarding)&&o.createElement(o.Fragment,null,o.createElement("div",{className:Wt.separator}),o.createElement(Jt,{enabled:(null===(n=null===(s=p.reader)||void 0===s?void 0:s.gmail)||void 0===n?void 0:n.enabled)||!1,toggle:e=>{c.toggleReader(e),xt.J.readerMailFeatureToggleClick(e?"on":"off")}})),k&&o.createElement(o.Fragment,null,o.createElement("div",{className:Wt.separator}),o.createElement(ei,{enabled:null===(l=null===(r=p.knowledgeHubSettings)||void 0===r?void 0:r.enabled)||void 0===l||l,toggle:e=>{c.toggleKnowledgeHub(e),xt.J.knowledgeHubFeatureToggleClick("popup",e?"on":"off")}}))),o.createElement(Mt,{heading:"CUSTOMIZE GRAMMARLY",enabled:R},o.createElement("div",{className:Wt.separator}),o.createElement(Gt,{changeStrongDialect:c.changeStrongDialect,dialectStrong:m.dialectStrong,dialectWeak:m.dialectWeak,dropdownOnTop:T,disabled:C}),R),!T&&o.createElement(Kt,{user:h,openSubscriptionDialog:f,isAssistant:"assistant"===b}),M&&o.createElement(It,{openGBLanding:v,showTitle:"popup"===b,showBackground:"popup"===b}))};var ai=i(32138),si=i(82785),ni=i(91574);const ri=({assistantSettingsViewModel:e,upgradeViewModel:t,assistantFeedbackViewModel:i,onClose:a,children:s})=>{const{domain:n,actions:r,state:l}=e,[c,d]=o.useState(!!l.view("page","enabled").get()),u={checked:c,update:d};return s({content:o.createElement(Ne.F.Fragment,null,l.view((({user:e,page:i,dynamicConfig:a,dapi:s})=>o.createElement(Zt.Provider,{value:{ctaFontSize:13}},o.createElement(ii,{actions:r,config:{enabled:!0,domain:n},settings:i,user:e,dapi:s,dynamicConfig:a,siteCategory:si.y.other,openSubscriptionDialog:()=>t.openUpgradeUrl(he.L.Place.extensionSettingsAssistant),openGBLanding:e=>{const t=(0,ai.Z4)(e,"gbExtensionSettingsAssistant");self.open(t),pt.J.getGBButtonClick("gbExtAssistantSettings","ExploreGrammarlyBusiness")},openUrl:e=>self.open(e),showGBUpHook:(0,yt.i7)(),placement:"assistant",siteSwitcherChecked:u})))),i?o.createElement(ut,{feedbackVM:i,entryPoint:nt.Q.settings}):null),onDone:()=>{r.toggleSite(c,n),pt.J.checkingToggleClick("assistant",si.y.other,c?"on":"off"),(0,kt.T)().toggleExtension(c,"assistant"),null==a||a()}})},oi=({viewModels:e})=>o.createElement(ri,{onClose:()=>e.assistantLayoutViewModel.popActiveView(),assistantSettingsViewModel:e.assistantSettingsViewModel,upgradeViewModel:e.upgradeViewModel,assistantFeedbackViewModel:e.assistantFeedbackViewModel},(({content:t,onDone:i})=>o.createElement(Ge,{dataPartName:"settings-view-overlay",popActiveView:()=>e.assistantLayoutViewModel.popActiveView(),panelClassName:ni.settingsViewOverlayPanel,contentClassName:ni.settingsViewOverlayContent,footer:o.createElement(qe.z,{className:ni.settingsViewDoneButton,kind:"success",type:"submit",onClick:i},"Done")},t)));var li=i(80895),ci=i(86133),di=i(48287);const ui=({message:e,children:t,placement:i,size:a,hideAfter:s,onClose:n,dataGrammarlyPart:r="ui-kit-popover-notification"})=>{const[l,c]=o.useState(!1);return o.useEffect((()=>{let e;return s>0&&(c(!0),e=self.setTimeout((()=>{c(!1),null==n||n()}),s)),()=>{e&&self.clearTimeout(e)}}),[s]),o.createElement(ci.J2,{dataGrammarlyPart:r,isOutsideReferenceElement:!1,headerContent:o.createElement("div",{className:di.popoverNotificationMessage},e),mainContent:null,show:l,placement:i,size:a,onClose:()=>{c(!1),null==n||n()},showArrow:!1,includeMainContentPadding:!1},t)};var pi=i(79921),mi=i(64229),hi=i(3860),gi=i(84966),fi=i(61922),vi=i(8471);const wi=({emotion:e,isBrandTonesEnabled:t,index:i,onFeedback:a})=>{const[s,n]=o.useState(0),r=o.createElement(ot.u,{message:`${e.prevalence} intensity`,showDelay:300},o.createElement("div",{className:vi.emogenieReportItemEmotionIntensity},[0,1,2,3,4].map((t=>{const i=t/5<=e.confidence;return o.createElement("div",{key:`${e.name}-intensity-${t}`,...(0,Pe.Sh)(vi.emogenieReportItemEmotionIntensityDot,i&&vi.emogenieReportItemEmotionIntensityDotActive)})})))),l=o.createElement(ot.u,{message:e.brandToneDescription,showDelay:300},o.createElement("div",null,o.createElement(fi.JO.Info,{width:10,className:"off"===e.brandToneLabel?vi.emogenieBrandToneInfoIconOff:vi.emogenieBrandToneInfoIconOn}))),c=o.createElement(li.C,{title:o.createElement(o.Fragment,null,e.brandToneLabel,"-BRAND ",l),kind:"off"===e.brandToneLabel?"error":"primary"}),d=e.brandToneLabel?c:r;return o.createElement(Ne.F.div,{...(0,Pe.Sh)(vi.emogenieReportItem,t?vi.emogenieReportItemBrandTone:null),"data-grammarly-part":"tone-detector-emotion","data-tone-detector-emotion-name":e.name},o.createElement("div",{role:`emotion-${i}-${e.name}`},o.createElement("div",{className:vi.emogenieReportItemEmotion},o.createElement("div",{className:vi.emogenieReportItemEmotionEmojiAndNameContainer},o.createElement(ui,{dataGrammarlyPart:"tone-detector-emotion-feedback-notification",message:"Thank you for the feedback!",hideAfter:s,placement:"right",onClose:()=>n(0),size:"medium"},o.createElement("div",{className:vi.emogenieReportItemEmotionEmojiAndName},o.createElement(pi.dy,{size:"small-medium",unicodeHexArray:[e.emojiId],unicodeLiteral:e.emoji,className:vi.emogenieReportItemEmotionEmoji}),o.createElement("span",{className:vi.emogenieReportItemEmotionName},e.name)))),o.createElement("div",{className:vi.emogenieReportItemEmotionBadgeOrIntensity},d),o.createElement(mi.m,{dataGrammarlyPart:"tone-detector-emotion-actions-menu",ariaMenuId:`${e.name}-emotion-actions-menu`,ariaMenuLabel:`${e.name} Emotion Actions Menu`,sections:[{title:"Help us improve",items:[{id:"tone-detector-emotion-actions-menu-item-like",icon:o.createElement("div",{className:vi.emogenieReportItemEmootionActionsMenuThumsUpIcon}),label:"Tone seems correct",onClick:()=>{a({emotionName:e.name,feedbackType:gi.y_.EMOTION_LIKE}),n(1200)}},{id:"tone-detector-emotion-actions-menu-item-dislike",icon:o.createElement("div",{className:vi.emogenieReportItemEmootionActionsMenuThumsDownIcon}),label:"Tone seems incorrect",onClick:()=>{a({emotionName:e.name,feedbackType:gi.y_.EMOTION_DISLIKE}),n(1200)}}]}],size:"medium",placement:"left"},o.createElement(hi.h,{dataGrammarlyPart:"tone-detector-emotion-actions-menu-button",className:vi.emogenieReportItemEmotionActionsMenuButton},o.createElement("div",{className:vi.emogenieReportItemEmotionActionsMenuIcon}))))))};var bi=i(12266);const _i=({emotions:e,isBrandTonesEnabled:t,toneSuggestionInfo:i,onMount:a,onReportEmotionFeedback:s,...n})=>{let r;switch(o.useEffect(a,[]),!0){case e.some((e=>e.brandToneLabel&&"off"===e.brandToneLabel&&e.confidence>.75)):r="Your tone may sound off to readers";break;case e.some((e=>e.brandToneLabel&&"off"===e.brandToneLabel)):r="Something sounds slightly off...";break;case e.some((e=>e.brandToneLabel&&"on"===e.brandToneLabel)):r=t?"You're on-brand! Great job!":"Your writing sounds clear and aligned. Great job!";break;default:r="How this may sound to readers:"}return o.createElement("div",{className:bi.emogenieReport,"data-grammarly-part":"tone-detector"},o.createElement("div",{className:bi.emogenieReportHeader},o.createElement("div",{className:bi.emogenieReportHeaderTitle},r),n.showBetaLabel?o.createElement(je.v,{browser:n.browser}):null),o.createElement("div",{className:bi.emogenieReportItems,"data-grammarly-part":"tone-detector-emotions"},e.map(((e,i)=>o.createElement(wi,{key:e.name,index:i,emotion:e,isBrandTonesEnabled:t,onFeedback:s})))),i?o.createElement(Si,{...i}):null)},Si=({onMount:e,emojiId:t,emojiLiteral:i,iconId:a,title:s,onClickCta:n,ctaText:r})=>(o.useEffect(e,[]),o.createElement("div",{className:bi.emogenieReportToneSuggestionInfo},o.createElement("div",{className:bi.emogenieReportToneSuggestionInfoEmojiAndTitle},t?o.createElement(pi.dy,{size:"small-medium",unicodeHexArray:[t],unicodeLiteral:null,className:bi.emogenieReportToneSuggestionInfoEmoji}):i?o.createElement(pi.dy,{size:"small-medium",unicodeHexArray:null,unicodeLiteral:i,className:bi.emogenieReportToneSuggestionInfoEmoji}):a?o.createElement("img",{alt:a,src:`https://assets.grammarly.com/icons/v1/${a}.svg`,style:{width:20,height:20},className:bi.emogenieReportToneSuggestionInfoEmoji}):null,o.createElement("div",null,s)),o.createElement(qe.z,{kind:"primary",onClick:n,dataGrammarlyPart:"tone-detector-tone-suggestion-info-cta"},r)));var yi=i(42805);const Ei=({emogenieService:e,toneSuggestionInfo:t,onShowToneSuggestionInfo:i,onClickToneSuggestionInfoCta:a,showBetaLabel:s,browser:n})=>o.createElement(Ne.F.Fragment,null,X.h.combine(e.viewState,null!=t?t:X.h.create(void 0),(({report:t,isBrandTonesEnabled:r},l)=>{let c;if(l&&(c={title:l.title,onMount(){null==i||i(l)},onClickCta(){null==a||a(l)},ctaText:"See suggestions"},ke.isToneImprovementSuggestionUphookInfo(l)&&(c={...c,ctaText:o.createElement(o.Fragment,null,o.createElement(fi.JO.Paid,{className:yi.diamondIcon,width:20}),o.createElement("span",null,"Unlock Premium")),emojiId:l.emojiId,emojiLiteral:l.emojiLiteral}),c=ke.isInclusiveLanguageToneSuggestionInfo(l)?{...c,iconId:l.iconId}:{...c,emojiId:l.emojiId}),t&&Array.isArray(t.emotions)){const i={emotions:t.emotions,isBrandTonesEnabled:r,onMount:()=>e.actions.trackReportShow(r),onReportEmotionFeedback:t=>e.actions.reportEmotionFeedback(t),toneSuggestionInfo:c};return s?o.createElement(_i,{...i,showBetaLabel:!0,browser:n}):o.createElement(_i,{...i,showBetaLabel:!1})}return null})));var ki=i(77678),Ai=i(94632),Ii=i(89894),Ci=i(46324),Mi=i(56770),Ti=i(58346);const xi={...Ci.o_,...(0,Ai.T)({default:{},hovered:{backgroundColor:ki.CoreNeutral10},clicked:{},disabled:{},toggled:{},hidden:{}})},Ri=Ii.ux.stylesheet({main:[xi],primary:[Ci.U8],toggle:[Ci.hc],round:[Ci.$O]});const Fi=({children:e})=>o.createElement("div",{className:Ti.singleCardAssistantNativeContentWithPadding},e),Li=({children:e,maxHeight:t})=>o.createElement("div",{style:{maxHeight:t,overflowY:"auto"}},e),Pi=Ii.ux.style(Ci.o_,(0,Ai.T)({default:{backgroundColor:ki.CoreYellow20,color:ki.CoreYellow80,lineHeight:Ii.ux.rem(2),transitionDuration:".2s"},hovered:{backgroundColor:ki.CoreYellow10,$nest:{"& i":{fill:ki.CoreYellow80,stroke:ki.CoreYellow80}}},disabled:{},clicked:{},toggled:{},hidden:{}}),{$nest:{"& i":{fill:ki.CoreYellow80,stroke:ki.CoreYellow80}}}),Vi=()=>{const e=(0,Ci.ND)(),t=e.primary;return{...e,primary:e=>"goPremiumExp"===e.name?o.createElement(Vt.zx.Primary,{name:e.name,onClick:e.onClick,className:Pi},e.text):o.createElement(t,{...e})}};var Oi=i(77394),Ni=i(86620),Bi=i(16868),Ui=i(40081),Di=i(62346),Hi=i(44618),Gi=i(13313),ji=i(21619),Wi=i(54216),zi=i(15787),qi=i(48052),Zi=i(20594),Ki=i(35607),$i=i(4890),Xi=i(73841),Yi=i(89770),Qi=i(39920),Ji=i(74364),ea=i(76974),ta=i(55935),ia=i(95574),aa=i(81531),sa=i(84174),na=i(8821),ra=i(64998);const oa=(e,t,i,a,s,n,l,u,p,E,I,M,T,F,P,V,N,B,U,D,j,W,z,$,Q,J)=>{const ae=aa.C8.Logging.getLogger("SingleCardAssistant.ViewModels"),le=X.h.create(Gi.A.defaultState),de=Wi.t.create(Wi.t.defaultLensFilters,{...Wi.t.defaultTextFilters,[Ie.R.SpecialId.Closed]:g.jv,[Ie.R.SpecialId.AllAlerts]:C.bZ.belongsToAllAlerts}),me=Gi.A.get(e.alertsList.state,e.alertsList.lensesScores,de).subscribe(q.wW(le)),ve=new Ui.t(le.view("lenses"),de,e.sessionModel.scoreStatus),be=(0,qi.$y)((0,Hi.a)(t).getContents),Se={features:new Set([Zi.IG.Features.showCardLabelInOutcomes]),cardLayoutDensityMode:$i.j.Density.minimal,shouldAnimateAlertApply:Zi.IG.Default.shouldAnimateAlertApply,cardVisualMode:X.h.create($i.j.CardVisualMode.RegularLightMode)},ye=(0,Zi.Ls)(be,e.alertsReader,Se,(()=>ea.of(L.none)),e.mutingAlertsReader),Ee=X.h.create(16),ke=A.getCapabilities(ye,e.alertsReader),Me=new Yi.oq(e.alertsList.state,e.alertsReader,le.view("lenses"),e.positionManager,ve,new Qi.gi(A.equatable.structEq,A.defaultOrd(ke)),(()=>()=>g.yR),ke,de),Te=X.h.create(Me.emptyState(Ie.R.SpecialId.AllAlerts).patch({alertSource:C.l$.sidebar}));i.next({kind:Oi.R.ChangeLens,selectedLens:"all"});const xe=new Ni.C(N()),Fe=new zi.Xx({flush:()=>t.flushChanges()},new ee.xQ,ye,e.alertsService,(()=>Promise.resolve()),(()=>Promise.resolve()),(0,g.zG)(e.mutedAlertsCategoriesModel,L.map((e=>({model:e,openSuggestionsManagement:()=>self.open((0,yt.Um)().suggestionsSettings)})))),L.some(w.B.getCardsViewModelSendToURLExperiment(xe,l)),g.jv,A.getActiveItemWithAlert,ke,Te,xe,{bufferTransitions:!0,showGbPrompt:w.B.shouldShow(p.get())}),Le=new sa.q(j.sduiFeedbackService,ke,Te,j.sduiManager,j.sduiFeedManager,e.alertsReader,Fe,xe),Pe=Le.sduiActionEvents.subscribe((({actions:e})=>e.forEach((e=>{"closeCard"===e.type&&E()})))),Ve=new G(u,l),Oe=new v.y(Fe.actionEvents,l,e.alertsReader),Ne=new Ki.o((()=>ce.F2(void 0))),Ue=X.h.create(!1),De=B.getTreatment(fe.p.YellowUnderlinesExtRelaunch),He="test_no_underlines"!==De,Ge="test_yellow_cta"===De,je=new he.x(e.alertsList,Te,3),We=X.h.create(!1),ze=((e,t,i,a,s,n)=>Ce.B.getPremiumAlerts(e,t).pipe(ne.x(((e,t)=>{const i=new Set(e.map((e=>e.id)));return e.length===t.length&&t.every((e=>i.has(e.id)))})),K.M(a.pipe(Z.U(y.D.UpgradeHook.findUpgradeHookSduiItem),Z.U(L.isSome)),s,i.sduiCardPropsForDefaultFeed),ie.b((([e,t,a,s])=>{if(0===e.length&&t)i.pushCapiSduiEvent({kind:"sdui_remove",rev:0,sduiRootId:y.D.UpgradeHook.ID});else if(e.length>0&&!a){let a;a=t?"sdui_update":"sdui_add",i.pushCapiSduiEvent({kind:a,rev:0,sduiRootId:y.D.UpgradeHook.ID,sdui:Re(e,s,n)})}}))).subscribe())(e.alertsList.state,Te,j.sduiManagerFactory,j.sduiManager.state,We,Ge),Ze=((e,t,i,a,s,n,o)=>e.pipe(Z.U((({actions:e,cardId:l})=>e.forEach((e=>{"upgradeToPremium"===e.type?(i.openUpgradeUrl(he.L.Place.assistantCardList),a.getPremiumButtonClick("assistantList","SeeWhatsInPremium")):"notify"===e.type&&e.userAction===ue.nz.Focus?(l===y.D.UpgradeHook.ID&&a.getPremiumButtonShow("assistantList","SeeWhatsInPremium"),l===y.D.UpgradeHook.ID&&o?(t.set(!0),a.assistantExpandedUpgradeHookShow((0,r.pipe)(i.advancedAlerts.get(),L.fold((()=>0),(e=>e.count))),100)):t.set(!1)):"removeCard"===e.type&&l===y.D.UpgradeHook.ID&&(t.set(!1),n.set(!0),s.pushCapiSduiEvent({kind:"sdui_remove",rev:0,sduiRootId:y.D.UpgradeHook.ID}))}))))).subscribe())(Le.sduiActionEvents,Ue,je,l,j.sduiManagerFactory,We,He),Ke=new Di.o$(e.alertsList,e.alertsReader,e.positionManager,e.alertsService,t,Te,te.aj([(0,Di.gM)(j.sduiManager.state,j.sduiFeedManager.feed),Ue]).pipe(Z.U((([e,t])=>i=>t?e(i)||C.bZ.isPremium(i)&&C.bZ.isHidden(i):e(i)))),A.getActiveItemWithAlert,a,!0,Ue),$e=(0,Bi.hp)(Te,Ke,Ee,Ne,t,ae),Xe=new ji.mN(t,Te,Ke,e.alertsReader,A.getActiveItemWithAlert,(t=>{const i=t.reduce(((t,i)=>(0,g.zG)(e.alertsReader.getById(i.alert.id),L.chain(C.bZ.getRawId),_e.bw((e=>t.set(e,i))),L.fold((()=>t),(()=>t)))),new Map),a=Array.from(i.keys()).map((e=>M.alerts.getAlertById(e))).filter(wt.fQ);if(a.length){const e=a.reduce(((e,t)=>c.S.ordering.greaterThanOrEqual(t,e)?t:e));return L.fromNullable(i.get(gi.wQ.Id.create(e.id)))}return L.none})),Ye=new Ae(e.alertsReader,e.alertsList.state,(()=>L.fromNullable(null==T?void 0:T.sessionUuid)),l,B,D,je,p,Fe.actionEvents,j.sduiManager.state),Qe=new Y(Te,e.alertsReader,M,Le.sduiActionEvents,A.getActiveItemWithAlert),Je=B.isGateEnabled(ge.K.SduiBulkDismiss)?new k(j.sduiManager.state,Fe):null,et=Xe.alertClicked.pipe(ta.T(1),re.w(L.fold((()=>oe.E),ea.of)),we.h((e=>e.alert.lensId!==Ie.R.SpecialId.Premium)),K.M(j.sduiManager.state),Z.U((([t,i])=>(0,g.zG)(e.alertsReader.getById(t.alert.id),L.chain(C.bZ.getRawId),L.chain((e=>y.D.getByAlertId(i,e))),_e.MH))),K.M(j.sduiFeedManager.feed)).subscribe((([e,t])=>{let i;i=t.feedId===y.D.AssistantFeed.TONE_INSIGHTS_CARD_FEED_ID?[y.D.AssistantFeed.createPopAssistantFeedAction(),y.D.AssistantFeed.createFocusAssistantCardAction(e.id)]:[y.D.AssistantFeed.createFocusAssistantCardAction(e.id)],Fe.actionEvents.next(y.f.create(i))})),it=[(0,g.zG)(Ji.EQ.focusMarkByActiveAlert(Te,Ke,e.alertsReader,A.getActiveFocusableItem,ae.getLogger("MarksEffects.focusMarkByActiveAlert")),x.nL.Effect.Producer.delayed(a)),...Fe.getApplicatorEffects(),...Le.getApplicatorEffects(),(0,g.zG)((0,Bi.k9)(Te,$e,X.h.create(L.none),A.getActiveAlignableItem,ke),x.nL.Effect.Producer.delayed(a)),na.N.PrevNextNavigation.sideEffect(na.N.PrevNextNavigation.Events.fromSduiCardActions(Le.sduiActionEvents),Te,ke),O.P.SideEffects.createSDUIFeedSideEffect(ke,j.sduiFeedManager.feed,A.sduiToChecksFeedOrd(ke),e.alertsReader)],at=({state:e,metadata:t})=>{if(!x.nL.hasCards(e))return ce.t$({state:e,metadata:t});const i=x.nL.Prism.getLens();return ce.t$({state:i.modify((e=>L.isSome(e.cardIndex)||e.items.size>1||(0,r.pipe)(e.items.getAt(0),L.map((e=>e.id!==y.D.UpgradeHook.ID)),L.getOrElse(g.jv))?e:{...e,cardIndex:L.some(0)}),e),metadata:t})},nt=({state:e,metadata:t})=>{if(!x.nL.hasCards(e))return ce.t$({state:e,metadata:t});const i=x.nL.Prism.getLens();return ce.t$({state:i.modify((e=>L.isSome(e.cardIndex)||e.items.size>1||(0,g.zG)(e.items.getAt(0),L.map((e=>e.id!==y.D.SuccessReport.ID)),L.getOrElse(g.jv))?e:{...e,cardIndex:L.some(0)}),e),metadata:t})},rt=R.v.Items.getRemoveDisposedItemsTransformer(ke),ot=ra.i.DisablePrevNextButtons.create(ke),lt=R.v.Items.getSingleItemFeedPositionsUpdateTransformer(ke),ct=(0,g.ls)(at,ia.L9(nt),ia.L9(rt),ia.L9(ot),ia.L9(lt)),dt=new Xi.l(Te,Me,e.alertsReader,e.alertsService,it,A.getActiveItemWithAlert,ct),ut=new S.X(s,n,J,u),pt=Fe.actionEvents.subscribe((0,g.ls)((0,f.JH)(e.alertsReader,f.SV.Source.assistant),_e.bw((e=>(e.kind===f.SV.Kind.alertApply&&e.source===f.SV.Source.assistant&&U.incrementCounter(),F.next(e)))))),mt=(0,b.W)(I),ht=V.pipe(re.w(L.fold((()=>oe.E),(t=>t.initSingleCardAssistantActionsProcessing(e.alertsReader,(0,m.X5)(Xe,Te)))))).subscribe(),gt=new se(Fe,j),ft=new h.D(l,$,Q,W),vt=(0,g.zG)(z,L.map((e=>new _.S(ft,e,E,l)))),bt=function(e,t,i,a,s,n,r,l){const c=()=>n.next();return{...Mi.k,button:Vi(),nativeToneInsightsModal:()=>o.createElement(Fi,null,o.createElement(Ei,{emogenieService:e.emogenieService,toneSuggestionInfo:e.toneSuggestionInfo,onShowToneSuggestionInfo:t=>e.onShowToneSuggestionInfo(t),onClickToneSuggestionInfoCta:t=>e.onClickToneSuggestionInfoCta(t),showBetaLabel:!0,browser:r})),nativeLearnMoreModal:()=>o.createElement(Li,{maxHeight:216},o.createElement(Fi,null,o.createElement(Be,{learnMoreInfo:t.learnMoreInfo}))),nativeFeedbackModal:()=>o.createElement(Fi,null,o.createElement(H.q5,{domain:i.getDomain(),hideDomainHelpText:!0,onClose:c,align:"left",title:o.createElement("span",null,"How do you like Grammarly?"),onSubmit:e=>{i.submitFeedback(e)},withScore:!0,hideLogo:!0,hideTextBoxTitle:!0,placeholderText:"How can we improve?",compactDisplay:!0,submitButtonKind:"primary"})),nativeSettingsModal:()=>o.createElement(Fi,null,o.createElement(ri,{onClose:c,assistantSettingsViewModel:a,upgradeViewModel:s},(({onDone:e,content:t})=>o.createElement(o.Fragment,null,t,o.createElement(qe.z,{kind:"primary",type:"submit",onClick:e,className:Ti.singleCardAssistantSettingsDoneButton,dataGrammarlyPart:"single-card-assistant-settings-done-button"},"Done"))))),nativeProofitModal:()=>(0,g.zG)(l,L.fold((()=>null),(e=>{const t=e.feature.dialogCaller().type;return t===d.WT.proofitReview?o.createElement(Fi,null,o.createElement(st,{proofitVM:e,insideSingleCardAssistant:!0})):t===d.WT.proofitRequest?o.createElement(Fi,null,o.createElement(tt,{proofitVM:e,insideSingleCardAssistant:!0})):null})))}}(Ye,Qe,Ve,ut,je,gt.popView,W,vt),_t={...Mi.k,button:(0,Ci.ND)(Ri)},St=Te.lens(x.nL.Prism.getLens()),Et=e=>x.nL.hasSuccess(e)&&x.nL.hasItems(e)&&(0===e.currentLens.items.size||(0,g.zG)(e.currentLens.items.getAt(0),L.map((e=>e.id===y.D.SuccessReport.ID)),L.getOrElse(g.jv))),kt=((e,t,i,a,s)=>{const n=a.sessionStats.view((e=>e?e.alertsStats.accepted.total:0));return te.aj([e.pipe(Z.U(s),ne.x()),i.pipe(Z.U(y.D.UpgradeHook.findUpgradeHookSduiItem),Z.U(L.isSome),ne.x())]).pipe(K.M(i.pipe(Z.U(y.D.SuccessReport.findSuccessReportSduiItem),Z.U(L.isSome)),t.sduiCardPropsForDefaultFeed),Z.U((([[e,i],s,n])=>{var r,o;if(e&&!i){const e=pe(null!==(o=null===(r=a.sessionStats.get())||void 0===r?void 0:r.alertsStats.accepted.total)&&void 0!==o?o:0,a.wordsCount.get(),n);return t.pushCapiSduiEvent({kind:"sdui_add",rev:0,sduiRootId:y.D.SuccessReport.ID,sdui:e}),!0}return!!s&&(t.pushCapiSduiEvent({kind:"sdui_remove",rev:0,sduiRootId:y.D.SuccessReport.ID}),!1)})),re.w((e=>e?te.aj([n,a.wordsCount,t.sduiCardPropsForDefaultFeed]).pipe(ie.b((([e,i,a])=>{const s=pe(e,i,a);t.pushCapiSduiEvent({kind:"sdui_update",rev:0,sduiRootId:y.D.SuccessReport.ID,sdui:s})}))):oe.E))).subscribe()})(Te,j.sduiManagerFactory,j.sduiManager.state,P,Et);return{checksFeedItem:()=>A.item(bt),checksFeedFlow:()=>A.createCardListFlow(St,ke),checksFeedIsInSuccess:Et,lensState:Te,cardsViewModel:Fe,lensPreviewViewModel:ve,cardsListScrollManager:Ne,alertProcessor:M,checkingService:T,assistantFeedbackViewModel:Ve,assistantSettingsViewModel:ut,marksViewModel:Ke,upgradeViewModel:je,gnar:l,user:p,positionViewModel:mt,remSize:Ee,isSingleCardAssistant:!0,statisticsService:P,toneDetectorViewModel:Ye,learnMoreViewModel:Qe,closeAssistant:E,bulkDismissViewModel:Je,nativeViewsViewModel:gt,designSystem:bt,headerDesignSystem:_t,sduiEngine:j,dispose:()=>{pt.unsubscribe(),Fe.dispose(),dt.dispose(),Ke.dispose(),me.unsubscribe(),Oe.dispose(),ht.unsubscribe(),Qe.dispose(),Ye.dispose(),null==Je||Je.dispose(),null==gt||gt.dispose(),et.unsubscribe(),kt.unsubscribe(),ze.unsubscribe(),Ze.unsubscribe(),Pe.unsubscribe(),Le.dispose()}}};var la=i(20271),ca=i(18756),da=i(38152),ua=i(51972),pa=i(40033),ma=i(68340),ha=i(10720),ga=i(61903),fa=i(93508),va=i(19962),wa=i(31881),ba=i(33751),_a=i(41572),Sa=i(89379),ya=i(28378),Ea=i(62513);const ka=o.forwardRef((({successView:e},t)=>{const i=o.useContext(_a.m.Context),a=(0,Sa.hM)((0,Sa.JT)((0,r.pipe)(e,z.oA),i));return o.createElement("div",{className:Ea.compactSuccessLens,ref:t},o.createElement("div",{className:Ea.compactSuccessLensContainer},wa.UI.mount(ya.q,a)))})),Aa=o.forwardRef((function({viewModels:e},t){return o.createElement("div",{className:ba.mainView},o.createElement(Ca,{ref:t,state:e.lensState,cardsViewModel:e.cardsViewModel,cardsListScrollManager:e.cardsListScrollManager,assistantCardListViewModel:e.assistantCardListViewModel,predictionsPreviewViewModel:e.predictionsPreviewViewModel,assistantFeedbackViewModel:e.assistantFeedbackViewModel,headerViewModel:e.assistantHeaderViewModel,layoutViewModel:e.assistantLayoutViewModel,capabilities:e.capabilities,readersAttentionItemViewModel:e.readersAttentionItemViewModel}))})),Ia=({position:e,isSuccess:t,children:i})=>o.createElement(Ne.F.Fragment,null,e.pipe(ne.x(((e,t)=>e.offset===t.offset&&e.visible===t.visible)),Z.U((e=>e.visible?o.createElement(Ne.F.div,{...(0,Pe.Sh)(ba.cardListFooterStatic,e.animationInProgress?ba.cardListFooterAnimate:void 0,t?void 0:ba.cardListFooterDynamic),style:t?{}:{transform:va.ux.translateY(e.offset)}},i):null)))),Ca=o.forwardRef((function({state:e,assistantCardListViewModel:t,cardsViewModel:i,cardsListScrollManager:a,capabilities:s,readersAttentionItemViewModel:n,...l},c){const d=q.jw((e=>{let t=7;return t=31*t+(0,ca.AC)(e.currentLens.id),t=31*t+(R.v.WithSuccess.State.isInSuccess(s)(e)?1231:1237),t}),e),u=(0,r.pipe)(d,Z.U((e=>{const t=e.get();return R.v.WithSuccess.State.isInSuccess(s)(t)}))),p=(0,r.pipe)((0,ha.ux)(e,a,s),K.M(e),Z.U((([e,t])=>({visible:!x.nL.hasCards(t)||L.isNone(t.currentLens.items.find((e=>!e.positionState.isHeightValid))),offset:e+6,animationInProgress:!0}))),fa.O({visible:!1,offset:0,animationInProgress:!0}));return o.createElement(ma.C,{className:ba.cardList,onClick:e=>{e.target.getAttribute("class")===ba.cardList&&t.assistantActions.next({type:da.lo.Type.clickOnEmpty})},footer:o.createElement(Ne.F.Fragment,null,(0,r.pipe)(u,Z.U((e=>o.createElement(Ia,{key:"assistant-footer",position:p,isSuccess:e},o.createElement(pa.pL,{predictionsVM:l.predictionsPreviewViewModel})))))),ref:e=>{t.cardListViewportHeight.set(L.fromNullable(null==e?void 0:e.offsetHeight))}},(l=>o.createElement(Ne.F.Fragment,null,(0,r.pipe)(te.aj([u,t.havePremiumAlerts]),Z.U((([r,d])=>r&&!d?o.createElement(o.Fragment,null,o.createElement(ka,{successView:t.successView,ref:c})):o.createElement(ha.hz,{state:e,cardsViewModel:i,cardsListScrollManager:a,connectorElements:l,ref:c,header:o.createElement(o.Fragment,null,d?o.createElement("div",{className:ba.upgradeHookWrapper,role:"uphook-wrapper"},wa.UI.mount(ga.n.TogglablePanel,t.upgradeHookFlow)):null),comparator:ua.O.listItemOrd,capabilities:s,readersAttentionItemViewModel:n})))))))})),Ma=o.forwardRef((({viewModels:e,header:t,footer:i,className:a},s)=>o.createElement(ma.C,{ref:t=>{"function"==typeof s?s(t):s&&(s.current=t),e.assistantCardListViewModel.cardListViewportHeight.set(L.fromNullable(null==t?void 0:t.offsetHeight))},className:a},(a=>o.createElement(ha.hz,{state:e.lensState,cardsViewModel:e.cardsViewModel,cardsListScrollManager:e.cardsListScrollManager,connectorElements:a,header:t,footer:i,comparator:ua.O.listItemOrd,capabilities:e.capabilities,readersAttentionItemViewModel:L.none})))));var Ta=i(41263),xa=i(57556),Ra=i(40145);const Fa=o.lazy((()=>i.e(2826).then(i.bind(i,73684)).then((({BrandTonesActivationUphookView:e})=>({default:e}))))),La=o.forwardRef((function({emogenieService:e,viewModels:t},i){const a=o.createElement(o.Fragment,null,o.createElement(Pa,{isBrandTonesEnabled:e.viewState.view("isBrandTonesEnabled"),institutionLogo:e.viewState.view("report").view((e=>null==e?void 0:e.institutionLogo)),institutionName:e.viewState.view("institutionName"),browser:t.assistantLayoutViewModel.browser}),o.createElement(Ei,{emogenieService:e,showBetaLabel:!1,browser:t.assistantLayoutViewModel.browser}),o.createElement(Ne.F.Fragment,null,e.viewState.view((t=>!t.isBrandTonesEnabled&&!t.isBrandTonesConfigured&&!t.settings.hideBrandTonesActivationUphook&&t.settings.shouldShowBrandTonesActivationUphook&&o.createElement(o.Suspense,{fallback:o.createElement(o.Fragment,null)},o.createElement(Ta.L,{chunkName:"brandTonesActivationUphook"},o.createElement(Fa,{trackShow:e.actions.trackBrandToneActivationUphookShow,onActivateClick:e.actions.brandToneActivationUphookCTAClick,onDismissClick:e.actions.brandToneActivationUphookDismissClick})))))));return o.createElement(Ge,{dataPartName:"emogenie-view-overlay",popActiveView:()=>t.assistantLayoutViewModel.popActiveView(),panelClassName:De.gradientViewOverlayPanel,hideBackButton:t.user.view((e=>e.isAnonymous))},o.createElement(Ne.F.Fragment,null,t.lensPreviewViewModel.getLens(Ie.R.SpecialId.PredictionEmogenie).pipe(Z.U((e=>e.count>0)),ne.x(),Z.U((e=>e?o.createElement(Ma,{key:"emogeniePredictionCardList",viewModels:t,ref:i,header:o.createElement(o.Fragment,null,a,o.createElement("div",{className:Ra.relatedSuggestionsTitle},"RELATED SUGGESTIONS"))}):o.createElement("div",{className:De.gradientViewOverlayContent},a))))))}));La.displayName="EmogenieView";const Pa=({isBrandTonesEnabled:e,institutionLogo:t,institutionName:i,browser:a})=>o.createElement(Ne.F.Fragment,null,X.h.combine(e,t,i,((e,t,i)=>o.createElement("div",{className:De.defaultViewOverlayHeader},o.createElement("div",{className:xa.emogenieViewOverlayHeader},e?o.createElement("div",null,t?o.createElement("img",{className:De.logo,src:t}):null,i," Tone detector"):"Tone detector",o.createElement(je.v,{browser:a,className:xa.emogenieViewOverlayHeaderBetaBadge})))))),Va=({feedbackVM:e,layoutVM:t})=>o.createElement(Ge,{dataPartName:"feedback-view-overlay",popActiveView:()=>t.popActiveView(),panelClassName:De.gradientViewOverlayPanel},o.createElement("div",{className:De.gradientViewOverlayContent},o.createElement("div",{className:De.defaultViewOverlayHeader},"Product Feedback"),o.createElement(H.q5,{domain:e.getDomain(),onClose:()=>t.popActiveView(),align:"left",style:{height:"calc(100% - 48px)"},onSubmit:t=>e.submitFeedback(t),withScore:!0,fixSubmitButtonOverflowBottomPadding:!0,hideLogo:!0})));var Oa=i(22667),Na=i(57398);const Ba=o.memo((({width:e,strokeWidth:t,generalScore:i,componentStyle:a,fontSize:s=9,isLoading:n})=>{const r=e/2,l=r-t/2,c=2*l*Math.PI,d=(n?75:i)/100*c,u=c-d,p=(e=>{const{red40:t,yellow50:i,green50:a}=ct.Z;return e<65?t:e<95?i:a})(i);return o.createElement("div",{...(0,Pe.Sh)(Na.scoreRing,n&&Na.loading),style:a},o.createElement("svg",{width:e,height:e,viewBox:`0 0 ${e} ${e}`},o.createElement("circle",{fill:"white",r:l,cx:r,cy:r}),o.createElement("circle",{stroke:ct.Z.neutral20,fill:"transparent",strokeWidth:t,style:{strokeDashoffset:d},r:l,cx:r,cy:r}),o.createElement("circle",{stroke:p,fill:"transparent",strokeWidth:t,strokeDasharray:`${c} ${c}`,style:{strokeDashoffset:u},r:l,cx:r,cy:r}),o.createElement("text",{className:Na.scoreText,x:"50%",y:"-35%",fontSize:s,fill:"black",textAnchor:"middle",transform:"rotate(90)"},i>0&&!n?i:"")))}));var Ua=i(93756),Da=i(78846);const Ha=e=>{const t=wa.Z.animatingFlow((()=>e.headerVM.logoScore),Ga);return o.createElement("div",{className:Da.logo_score},wa.UI.mount(Za,t))},Ga=(e,t)=>(0,r.pipe)(e,L.filter((e=>e.type!==t.type)),L.map((()=>Ua.Hk("fadeout","fadein")))),ja=wa.UI.Node.make((()=>o.createElement(Oa.K,{className:Da.grammarly_logo,size:22}))),Wa=wa.UI.Node.make((({view:e})=>o.createElement(Ne.F.div,{className:Da.score_container,"data-grammarly-part":"assistant-score"},(0,r.pipe)(e("score"),(0,Z.U)((({capiScore:e,isLoading:t})=>o.createElement(o.Fragment,null,o.createElement(Ba,{generalScore:e,strokeWidth:2,width:22,fontSize:e<100?11:9,isLoading:t,componentStyle:{transform:"translate(2px, -2px) rotate(-90deg)",cursor:"default"}})))))))),za=wa.UI.Union.make("type",{logo:ja,score:Wa}),qa=wa.UI.Transition.make({fadein:Da.logoscore_fadein},{fadeout:Da.logoscore_fadeout}),Za=wa.UI.Animated.make(qa,za);var Ka=i(1620),$a=i(29417);const Xa=e=>{const[t,i]=o.useState(!1),[a,s]=o.useState(!1),n=e.viewModels.assistantLayoutViewModel,l=e.viewModels.assistantHeaderViewModel,c=o.useContext(la.O.Context),d=(0,r.pipe)(e.viewModels.assistantProofitViewModel,L.map((e=>e.feature)),L.map((t=>o.createElement(Ne.F.Fragment,null,te.aj([t.layoutCreated,n.activeView.view((e=>e.type===t.assistantViewType()))]).pipe(Z.U((([i,a])=>i?o.createElement(ot.u,{message:c.proofitTooltip,showDelay:rt.gk,disabled:a},o.createElement(hi.h,{onClick:()=>{a?n.popActiveView():(e.viewModels.gnar.proofitButtonClick("assistant_header"),n.pushActiveView({type:t.assistantViewType()}))},dataGrammarlyPart:"assistant-header-action-btn-proofit"},o.createElement("div",{className:Da.headerActionBtnProofitIcon}))):null)))))),L.toNullable),u=o.createElement(Ka.P,{onClick:l.close,tooltipMessage:"Close panel",dataGrammarlyPart:"assistant-header-action-btn-close"});return o.createElement(ot.u,{message:"Grab and drag to move panel",showDelay:rt.gk,disabled:t},o.createElement("div",{...(0,Pe.Sh)(Da.header,a&&Da.actions_hovered),ref:e.draggableRef,onMouseDown:()=>i(!0),onMouseOut:()=>i(!1)},o.createElement(Ha,{headerVM:l}),o.createElement(Ya,null),o.createElement(Ne.F.div,{className:Da.headerActions,onMouseOver:()=>s(!0),onMouseOut:()=>s(!1)},n.isHeaderNavigationEnabled.view((e=>e?o.createElement(o.Fragment,null,d,o.createElement(Ne.F.Fragment,null,l.showSetGoalsActionButton.view((e=>e&&o.createElement(ot.u,{message:c.setGoalsTooltip,showDelay:rt.gk},o.createElement(hi.h,{onClick:()=>l.open("setGoals"),dataGrammarlyPart:"assistant-header-action-btn-set-goals"},o.createElement("div",{className:Da.headerActionBtnGoalsIcon})))))),o.createElement(Ne.F.Fragment,null,X.h.combine(l.showSettingsActionButton,n.activeView,((e,t)=>{const i=t.type===h.a.Type.settings;return e&&o.createElement($a.l,{onClick:()=>i?n.popActiveView():n.pushActiveView({type:h.a.Type.settings}),enableTooltip:!i,dataGrammarlyPart:"assistant-header-action-btn-settings"})}))),u):u)))))},Ya=()=>o.createElement("div",{className:Da.draggableWrapper,"data-grammarly-part":"assistant-draggable-handler"},o.createElement("div",{className:Da.draggable}));class Qa extends o.Component{render(){return this._idSuffix=this._idSuffix||"readersAttentionOnboardingBanner_"+Qa._nextIdSuffix++,o.createElement("svg",{className:this.props.className,viewBox:"0 2 296 144",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("g",{clipPath:`url(#clip0_${this._idSuffix})`},o.createElement("rect",{width:"296",height:"144",fill:"#4A6EE0"}),o.createElement("path",{d:"M-5.5 -3.5H261.5V47.5H-5.5V-3.5Z",fill:"#6E66DE",stroke:"#1F243C"}),o.createElement("path",{d:"M-2.79293 -197.5L429.5 234.793V-197.5H-2.79293Z",fill:"#15C39A",stroke:"#1F243C"}),o.createElement("path",{d:"M219.057 33C222.992 33 226.182 29.8101 226.182 25.875C226.182 21.94 222.992 18.7501 219.057 18.7501C215.122 18.7501 211.932 21.94 211.932 25.875C211.932 29.8101 215.122 33 219.057 33Z",fill:"#1F243C",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("path",{d:"M221.477 31.0899C225.92 31.0899 229.522 27.4881 229.522 23.045C229.522 18.6018 225.92 15 221.477 15C217.033 15 213.432 18.6018 213.432 23.045C213.432 27.4881 217.033 31.0899 221.477 31.0899Z",fill:"#41D9B5",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("path",{d:"M220.188 27.045C220.009 27.045 219.841 26.9778 219.717 26.8434L216.927 24.0646C216.67 23.8069 216.67 23.3811 216.927 23.1122C217.185 22.8545 217.611 22.8545 217.88 23.1122L220.188 25.4204L225.353 20.2662C225.611 20.0085 226.037 20.0085 226.306 20.2662C226.563 20.5239 226.563 20.9497 226.306 21.2186L220.67 26.8546C220.535 26.9778 220.367 27.045 220.188 27.045Z",fill:"white"}),o.createElement("path",{d:"M68.125 57C72.06 57 75.25 53.8101 75.25 49.875C75.25 45.94 72.06 42.7501 68.125 42.7501C64.19 42.7501 61 45.94 61 49.875C61 53.8101 64.19 57 68.125 57Z",fill:"#1F243C",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("path",{d:"M70.545 55.0899C74.9881 55.0899 78.5899 51.4881 78.5899 47.045C78.5899 42.6018 74.9881 39 70.545 39C66.1018 39 62.5 42.6018 62.5 47.045C62.5 51.4881 66.1018 55.0899 70.545 55.0899Z",fill:"#41D9B5",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("path",{d:"M69.2564 51.045C69.0771 51.045 68.909 50.9778 68.7858 50.8434L65.9958 48.0646C65.7381 47.8069 65.7381 47.3811 65.9958 47.1122C66.2535 46.8545 66.6793 46.8545 66.9482 47.1122L69.2564 49.4204L74.4217 44.2662C74.6794 44.0085 75.1052 44.0085 75.3741 44.2662C75.6318 44.5239 75.6318 44.9497 75.3741 45.2186L69.7382 50.8546C69.6037 50.9778 69.4357 51.045 69.2564 51.045Z",fill:"white"}),o.createElement("rect",{x:"132",y:"38",width:"39",height:"24",rx:"2",fill:"#1F243C",stroke:"#1F243C"}),o.createElement("rect",{x:"135",y:"35",width:"39",height:"24",rx:"2",fill:"#F8C6DA",stroke:"#1F243C"}),o.createElement("path",{d:"M135 58.3296L149.303 47.4857L153.298 44.4591C154.007 43.923 154.993 43.923 155.702 44.4591L159.697 47.4857L174 58.3296",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("path",{d:"M173.914 35.5L159.698 47.6583L155.806 50.9962C155.063 51.6361 153.956 51.6361 153.212 50.9962L149.303 47.6583L135.087 35.5",fill:"#F8C6DA"}),o.createElement("path",{d:"M173.914 35.5L159.698 47.6583L155.806 50.9962C155.063 51.6361 153.956 51.6361 153.212 50.9962L149.303 47.6583L135.087 35.5",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("rect",{x:"135",y:"35",width:"39",height:"24",rx:"2",stroke:"#1F243C"}),o.createElement("rect",{y:"32",width:"296",height:"112",fill:`url(#paint0_linear_${this._idSuffix})`}),o.createElement("path",{d:"M185.5 22C185.5 18.961 183.039 16.5 180 16.5C183.039 16.5 185.5 14.039 185.5 11C185.5 14.039 187.961 16.5 191 16.5C187.965 16.5 185.5 18.9651 185.5 22Z",fill:"#F9EA9E",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round"}),o.createElement("path",{d:"M239.5 128C239.5 124.961 237.039 122.5 234 122.5C237.039 122.5 239.5 120.039 239.5 117C239.5 120.039 241.961 122.5 245 122.5C241.965 122.5 239.5 124.965 239.5 128Z",fill:"#F9EA9E",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round"}),o.createElement("path",{d:"M24.5 63C24.5 59.961 22.039 57.5 19 57.5C22.039 57.5 24.5 55.039 24.5 52C24.5 55.039 26.961 57.5 30 57.5C26.9651 57.5 24.5 59.9651 24.5 63Z",fill:"#F9EA9E",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round"}),o.createElement("rect",{x:"263",y:"76",width:"63",height:"77",rx:"2",fill:"#1F243C",stroke:"#1F243C"}),o.createElement("rect",{x:"267",y:"72",width:"63",height:"77",rx:"2",fill:"#F9FAFF",stroke:"#1F243C"}),o.createElement("path",{d:"M318.759 89.7112H278",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("path",{d:"M318.759 101.227H278",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("path",{d:"M318.759 112.743H278.095",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("path",{d:"M318.759 124.259H278",stroke:"#1F243C",strokeMiterlimit:"10"}),o.createElement("g",{style:{mixBlendMode:"multiply"},opacity:"0.4"},o.createElement("path",{d:"M318.759 101.227H278",stroke:"#41D9B5",strokeWidth:"10",strokeMiterlimit:"10"})),o.createElement("g",{style:{mixBlendMode:"multiply"},opacity:"0.4"},o.createElement("path",{d:"M305.43 112.743H278.095",stroke:"#41D9B5",strokeWidth:"10",strokeMiterlimit:"10"}))),o.createElement("defs",null,o.createElement("linearGradient",{id:`paint0_linear_${this._idSuffix}`,x1:"148",y1:"32",x2:"148",y2:"144",gradientUnits:"userSpaceOnUse"},o.createElement("stop",{stopColor:"#26307D",stopOpacity:"0"}),o.createElement("stop",{offset:"1",stopColor:"#26307D",stopOpacity:"0.5"})),o.createElement("clipPath",{id:`clip0_${this._idSuffix}`},o.createElement("rect",{width:"296",height:"144",fill:"white"}))))}}Qa._nextIdSuffix=0;var Ja=i(44715);const es=({layoutVM:e})=>o.createElement(Ge,{dataPartName:"readers-attention-help-overlay",popActiveView:()=>e.popActiveView(),panelClassName:Ja.helpPanel,contentClassName:Ja.helpPanelContent},o.createElement("div",{className:Ja.helpBanner},o.createElement(Qa,{className:Ja.helpBannerImage}),o.createElement("div",{className:Ja.helpHeader},"Reader′s attention",o.createElement(li.C,{title:"NEW",kind:"gold"})),o.createElement("div",{className:Ja.helpBannerMessage},"Get your important information across")),o.createElement("div",{className:Ja.helpContent},o.createElement("div",null,"Grammarly predicts which parts of your email will be read.",o.createElement("ul",null,o.createElement("li",null,o.createElement("span",{className:Ja.heatmap},o.createElement("b",null,"Highlighted text is most likely to be read."))),o.createElement("li",null,"The rest of the text may be skimmed or skipped.")),"Follow Grammarly’s suggestions to keep your reader’s attention.")));var ts=i(35327);const is=e=>{const t=wa.Z.animatingFlow((()=>e.summaryVM.summary),as);return o.createElement("div",{...(0,Pe.Sh)(ts.summary_wrapper,e.className)},wa.UI.mount(rs,t))},as=(e,t)=>(0,r.pipe)(e,L.filter((e=>e.content!==t.content)),L.map((()=>Ua.Hk("fadeout","fadein")))),ss=wa.UI.Node.make((({view:e})=>o.createElement(Ne.F.div,{className:ts.summary_heading,"data-grammarly-part":"assistant-summary-header"},e("content")))),ns=wa.UI.Transition.make({fadein:ts.summary_fadein},{fadeout:ts.summary_fadeout}),rs=wa.UI.Animated.make(ns,ss);var os=i(35501),ls=i(82318);const cs=o.forwardRef((function({viewModels:e,readersAttentionVM:t},i){return o.createElement(Ge,{dataPartName:"readers-attention-view-overlay",popActiveView:()=>e.assistantLayoutViewModel.popActiveView(),panelClassName:De.gradientViewOverlayPanel},o.createElement(Ma,{key:"takeawaysPredictionCardList",ref:i,viewModels:e,className:ls.cardList,header:o.createElement(ds,{readersAttentionVM:t,layoutVM:e.assistantLayoutViewModel}),footer:o.createElement(ut,{feedbackVM:e.assistantFeedbackViewModel,entryPoint:nt.Q.readersAttention})}))})),ds=({readersAttentionVM:e,layoutVM:t})=>{const i=e.panelState.pipe(Z.U(L.fold((()=>({content:""})),(e=>({content:e.headerMessage})))));return o.createElement(o.Fragment,null,o.createElement("div",{className:De.defaultViewOverlayHeader},o.createElement("div",{className:ls.headerGroup},"Reader′s attention",o.createElement("div",{onClick:()=>e.showHelp(),className:ls.questionMarkButton,"data-grammarly-part":"readers-attention-question-mark-button"},o.createElement(fi.JO.QuestionMark,{width:12,className:ls.questionMarkIcon}))),o.createElement(je.v,{browser:t.browser})),o.createElement(is,{summaryVM:{summary:i},className:ls.summaryWrapper}),o.createElement("div",{className:ls.message},V.UI.mount(V.UI.Union.asOption(os.r),(()=>e.panelState))),o.createElement(Ne.F.div,{...(0,Pe.Sh)(Ra.relatedSuggestionsTitle,ls.relatedSuggestionsTitle)},e.panelState.pipe(Z.U(L.fold(g.gn,(e=>`${e.numChecklistItemsChecked} OF ${e.numChecklistItems} COMPLETED`))))))};var us=i(62727),ps=i(80550),ms=i(92132),hs=i(70091),gs=i(63544),fs=i(17161),vs=i(53447),ws=i(67521),bs=i(5817),_s=i(64078),Ss=i(42103),ys=i(33678),Es=i(15073),ks=i(101),As=i(85089),Is=i(16118),Cs=i(83401),Ms=i(89068),Ts=i(78674),xs=i(50628),Rs=i(72481),Fs=i(8313);const Ls=o.memo((function({viewModels:e,emogenieService:t,height:i,ready:a,OuterElementsPortalSource:s}){const n=new Ni.C;(0,F.iR)("viewModels",e);const l=(0,et.IQ)(),c=(0,et.e8)(),d=o.useContext(et.Dg).state.pipe(we.h((e=>!e.dragging)),fa.O(gs.zM)),u=o.useContext(fs.Y4),p=(0,vs.C7)(),m=X.h.create(va.UL.empty);(0,ws.A)(te.aj([d,u]).pipe(Z.U((([e,t])=>{const i=t.top+e.translate.y,a=t.left+e.translate.x,s=p.height-i-t.height,n=p.width-a-t.width;return{height:t.height,width:t.width,top:i,left:a,bottom:s,right:n}})),ie.b(q.wW(m)))),(0,ws.A)(d.pipe(ie.b((t=>e.positionViewModel.onDrag(t))))),(0,ws.A)(e.assistantLayoutViewModel.activeView.pipe(Is.G(),ie.b((([t,i])=>{t.type!==i.type&&h.a.isDefault(i)&&e.cardsListScrollManager.paddingTop.set(0)}))));const g=o.useRef(null);return o.useEffect((()=>{e.assistantCardListViewModel.cardListContext.next(L.fromNullable(g.current));const t=g.current?As.rl(g.current,{subtree:!0,childList:!0}):Cs.C,i=m.view((e=>({top:e.top,left:e.left}))),s=(0,r.pipe)(t,Ms.V((0,bs.m9)(1)),Ts.b(10),xs.P()).subscribe((()=>a(i,l)),(()=>{a(i,l,!0)}));return()=>{s.unsubscribe()}}),[]),o.createElement(Ps,{remSize:e.remSize,environment:n,viewport:m},o.createElement(Ne.F.div,{"data-grammarly-part":"assistant-popup-content",...(0,Pe.Sh)(ba.assistant,l.pipe(fa.O(!1),Z.U((e=>e?ba.dragging:null)))),style:{height:i,maxHeight:"90vh"}},o.createElement(Xa,{viewModels:e,draggableRef:c}),e.assistantLayoutViewModel.activeView.view((i=>h.a.isDefault(i)?o.createElement(Aa,{viewModels:e,ref:g,key:"default-view"}):h.a.isEmogenie(i)?o.createElement(La,{emogenieService:t,viewModels:e,key:"emogenie-view",ref:g}):h.a.isReadersAttention(i)?o.createElement(cs,{viewModels:e,readersAttentionVM:e.readersAttentionViewModel,key:"readers-attention-view",ref:g}):h.a.isReadersAttentionHelp(i)?o.createElement(es,{layoutVM:e.assistantLayoutViewModel,key:"readers-attention-help"}):h.a.isFeedback(i)?o.createElement(Va,{feedbackVM:e.assistantFeedbackViewModel,layoutVM:e.assistantLayoutViewModel,key:"feedback-view"}):h.a.isSettings(i)?o.createElement(oi,{viewModels:e,key:"settings-view"}):h.a.isProofitRequest(i)&&L.isSome(e.assistantProofitViewModel)?o.createElement(tt,{browser:e.assistantLayoutViewModel.browser,popActiveView:()=>e.assistantLayoutViewModel.popActiveView(),proofitVM:e.assistantProofitViewModel.value,key:"proofit-request-view"}):h.a.isProofitReview(i)&&L.isSome(e.assistantProofitViewModel)?o.createElement(st,{browser:e.assistantLayoutViewModel.browser,popActiveView:()=>e.assistantLayoutViewModel.popActiveView(),proofitVM:e.assistantProofitViewModel.value,key:"proofit-review-view"}):null))),o.createElement(s,null,o.createElement(hs.jv,null,o.createElement(ps.L,{modalManager:e.assistantModalManager}))),o.createElement(_s.X,null))})),Ps=({environment:e,viewport:t,children:i,remSize:a})=>{var s;const n=o.useRef((0,la.I)(_a.m.getConfig(e.has(Ni.U.Flag.isAppleSystem)?"mac":"windows"))),r=null===(s=o.useContext(us.n.Context))||void 0===s?void 0:s.host;return o.createElement(ms.Q,{remSize:a,setter:e=>Es.u.setRootCssVar(r||document.documentElement,e)},o.createElement(Rs.p.Manager,{cardWidth:Rs.p.withCardWidthEffect(Rs.p.defaultSizeObserver,(e=>{Rs.p.setRootCssVar(r||document.documentElement,e)}))},o.createElement(Ni.U.Context.Provider,{value:e},o.createElement(ys.a.Context.Provider,{value:e},o.createElement(la.O.Context.Provider,{value:n.current.assistant},o.createElement(_a.m.Context.Provider,{value:n.current.denali},o.createElement(Fs.TG.ContextMock,null,o.createElement(ks.l.RootVirtualContainer,{viewport:t,name:"draggable"},o.createElement(Ss.G.DefaultProvider,null,o.createElement(hs.jv,null,i))))))))))};var Vs=i(7309),Os=i(63919),Ns=i(62337);const Bs=({textFieldRect:e,viewModels:t,gButtonRect:i,draggableGButtonType:a,children:s})=>{const{initialPositionOffset:n}=t.positionViewModel,r=Ns.UL.shift(i,Os.E9.minus(e.client,e.page)),l=null===a?{...e.client,...e.size}:r,c=(0,vs.C7)(),d=null===a?t.assistantLayoutViewModel.layout:Vs.V.draggableGButtonAssistantLayout(r,e);return o.createElement(et._l,{bounds:c,hasDragHandle:!0},(({translate:e})=>o.createElement(fs.sX,{anchorRect:l,viewportRect:c,anchorOrigin:d.anchorOrigin,elementOrigin:d.assistantOrigin,anchorMargin:d.anchorMargin,repositioning:d.repositioningStrategy,stickToTarget:!1,viewportMargin:0,postRepositioningOffset:{horizontal:n.left,vertical:n.top}},(({top:t,left:i})=>o.createElement("div",{"data-grammarly-part":"assistant-popup",style:{position:"fixed",transform:`translate(${e.x}px, ${e.y}px)`,zIndex:rt.Eq,top:t,left:i}},s)))))},Us=({gbuttonRect:e,viewModels:t,onDomRectChange:i,children:a})=>{const s=(0,vs.C7)(),[n,r]=o.useState(gs.zM),[l,c]=o.useState(null),[d,u]=o.useState(null),[p,m]=o.useState(fs.KC.top),[h,g]=o.useState(fs.KC.left),[f,v]=o.useState(fs.KC.height),[w,b]=o.useState(fs.KC.width),_=o.useRef(new Q.X(fs.KC)),S=null!=d?d:n.translate;return o.useEffect((()=>{const e=_.current.pipe(Is.G()).subscribe((([e,t])=>{let i,a;h!==fs.KC.left&&e.left===t.left||(i=t.left),p===fs.KC.top?a=t.top:e.height!==t.height&&(a=p-(t.height-e.height),a<0&&(a=0)),void 0!==a&&m(a),void 0!==i&&g(t.left),v(t.height),b(t.width)}));return()=>e.unsubscribe()}),[p,h]),o.useEffect((()=>{const e=s.height-p-f,t=s.height-h-w;i({top:p,left:h,bottom:e,right:t,height:f,width:w})}),[p,h,w,f]),o.useEffect((()=>{!n.dragging&&n.dragEnd&&(m(p+S.y),g(h+S.x),c(n.translate),u({x:0,y:0}))}),[n]),o.useEffect((()=>{n.dragging&&d&&l&&u({x:n.translate.x-l.x,y:n.translate.y-l.y})}),[n]),o.createElement(et._l,{bounds:s,hasDragHandle:!0,onChangeDragState:r},o.createElement(fs.sX,{anchorRect:e,viewportRect:s,anchorOrigin:{horizontal:"right",vertical:"top"},elementOrigin:{horizontal:"right",vertical:"bottom"},anchorMargin:{top:0,bottom:0,left:0,right:0},repositioning:[{horizontal:"translate",vertical:"flip"}],stickToTarget:!1,viewportMargin:0,postRepositioningOffset:{horizontal:t.positionViewModel.initialPositionOffset.left,vertical:t.positionViewModel.initialPositionOffset.top},onChangePosition:e=>_.current.next(e)},o.createElement("div",{style:{position:"fixed",transform:`translate(${S.x}px, ${S.y}px)`,zIndex:rt.Eq,top:p,left:h}},a)))};var Ds=i(57635),Hs=i(15646),Gs=i(86638),js=i(94810);const Ws=o.memo((function({viewModels:e,height:t,domRect:i,ready:a}){var s,n;const l=new Ni.C;(0,F.iR)("viewModels",e);const c=(0,et.IQ)(),d=(0,et.e8)(),u=o.useContext(et.Dg).state.pipe(we.h((e=>!e.dragging)),fa.O(gs.zM));(0,ws.A)(u.pipe(ie.b((t=>e.positionViewModel.onDrag(t))))),o.useEffect((()=>{const e=i.view((e=>({top:e.top,left:e.left})));a(e,c)}),[]);const p=e.lensState.pipe(Z.U((t=>e.checksFeedIsInSuccess(t)))),m=e.nativeViewsViewModel.header.view(L.fold((()=>o.createElement(o.Fragment,null)),(t=>o.createElement(Gs.P,{key:"header",sduiRootId:t.id,content:t,designSystem:e.headerDesignSystem,notify:(i,a,s)=>e.cardsViewModel.actionEvents.next({type:Hs.lY.Type.sduiCardAction,sourceId:i,cardId:t.id,actions:a,scope:s}),transitions:[],prevContent:L.none,onAnimationEnd:F.Q1,onMount:F.Q1})))),h=e.checksFeedFlow(),f=(0,r.pipe)(h,V.Z.extendActions(ie.b((t=>{"content"===t.key&&"card"===t.action.key&&"alertRefSDUI"===t.action.action.key&&e.cardsViewModel.actionEvents.next(t.action.action.action)}))));return o.createElement(Ps,{remSize:e.remSize,environment:l,viewport:i},o.createElement(Ne.F.Fragment,null,te.aj([p,null!==(n=null===(s=e.bulkDismissViewModel)||void 0===s?void 0:s.bulkDismissAlertsCount)&&void 0!==n?n:X.h.create(0),e.nativeViewsViewModel.defaultFeedId,e.nativeViewsViewModel.feed]).pipe(Z.U((([i,a,s,n])=>{const l=(0,r.pipe)((0,g.bc)(s,n),(0,g.og)(_e.vB(((e,t)=>t.feedId===e))),L.getOrElse((()=>!0)))&&i;return o.createElement(Ds.V,{key:"single-card-assistant",className:Ti.singleCardAssistant,draggableRef:d,headerContent:m,footer:l&&a>0?{content:o.createElement(o.Fragment,null,"We hid ",a," suggestions that didn’t seem relevant to your text. Want to review them?"),tooltip:"Review suggestions",onClick:()=>{var t;null===(t=e.bulkDismissViewModel)||void 0===t||t.showBulkDismissFeed()}}:void 0,onHeightChange:e=>t.set(e)},V.UI.mount(js.c.assistant(e.checksFeedItem(e.cardsViewModel.actionEvents)),f))})))),o.createElement(_s.X,null))}));var zs,qs=i(95572),Zs=i(79692),Ks=i(49708),$s=i(2768),Xs=i(8829);(0,p.C)();class Ys{constructor(e,t){this._params=e,this._felog=t,this._log=l.Y.create(Ys.name),this._integration=null,this._viewModels=X.h.create(null),this._assistantPopupIsReady=new ee.xQ,this._initPerformance=void 0,this._openMeasure=void 0,this._height=X.h.create(0),this._domRect=X.h.create(va.UL.empty),this._openState=X.h.create("closed"),this._subs=new J.w.Keeper,this.openState=this._openState.view(),this.open=e=>{var t,i;const a=this._params.contentScriptState.view("user").view((e=>({isPremium:e.premium,isAnonymous:e.anonymous,experiments:e.experiments,customFields:e.customFields,institutionInfo:e.institutionInfo,isGrammarlyEmployee:Tt.n5.isGrammarlyEmployee(e)}))),s=this._viewModels.get();if(null!==s)this._subs.push(Js(s,e));else{this._openMeasure=this._felog.assistant.openTime.startMeasure();const s=this._felog.assistant.initTime.startMeasure();this._openState.set("opening");const n=this._params.assistantService,o=n.createIntegration({gnar:this._params.gnar,felog:this._felog,readersAttentionFeature:this._params.readersAttentionFeature,snippetsFeature:this._params.snippetsFeature,shortenItFeature:this._params.shortenItFeature,experimentClient:this._params.experimentClient});if(!o)return this._log.warn("tried to open assistant with checking service not initialized"),s.cancelMeasure(),void this._openMeasure.cancelMeasure();null===(i=(t=this._params).onOpen)||void 0===i||i.call(t,o),this._integration=o;const l=(0,r.pipe)(L.fromNullable(e.type===d.WT.card?e.alertId:null),L.map(gi.wQ.Id.create)),c=L.isSome(o.engine.sduiEngine)?oa(o.engine,o.denaliViewAdapter,n.sidebarEvents,this._assistantPopupIsReady,this._params.contentScriptState,this._params.contentScriptActions,this._params.gnar,this._params.domain,a,this.close,this._params.assistantService.positionModel,this._params.alertProcessor,this._params.checkingService,this._params.cardEvents,this._params.statisticsService,this._params.toneAIFeature,(()=>this._params.envFactory()),this._params.experimentClient,this._params.userEngagedByAlertsAcceptedService,this._params.emogenieService,o.engine.sduiEngine.value,this._params.browser,L.fromNullable(this._params.proofitFeature),this._params.assistantService.selectedHighlightsTracker,this._params.assistantService.isTextFieldEmpty,this._params.dapiActions):(0,m.n)(o.engine,o.denaliViewAdapter,o.document.settings.lens("selectedLens"),this._params.emogenieService,L.fromNullable(this._params.readersAttentionFeature),this._params.shortenItFeature,this._params.toneAIFeature,this._params.ethicalAIFeature,this._params.snippetsFeature,L.fromNullable(this._params.proofitFeature),n.sidebarEvents,this._assistantPopupIsReady,l,this._params.contentScriptState,this._params.contentScriptActions,this._params.gnar,this._params.statisticsService,this._params.domain,a,this.close,this._params.assistantService.selectedHighlightsTracker,this._params.assistantService.isTextFieldEmpty,this._params.assistantService.positionModel,this._params.alertProcessor,this._params.cardEvents,this._params.browser,this._params.layout.assistant,(()=>this._params.envFactory()),this._params.userEngagedByAlertsAcceptedService,this._params.experimentClient,this._params.dapiActions);this._subs.push(Js(c,e)),c.isSingleCardAssistant&&this._subs.push(c.cardsViewModel.actionEvents.pipe(we.h(Xs.t.isSduiCardAction),we.h((e=>e.sourceId===y.D.Proofit.ID)),Z.U((e=>Qs(e.actions,c.sduiEngine.sduiFeedManager.currentFeed))),we.h((e=>e.length>0))).subscribe((()=>{c.gnar.proofitButtonClick("assistant_header")}))),this._initPerformance=s.endMeasure(),this._viewModels.set(c)}},this.close=()=>{var e,t,i,a;null!==this._viewModels.get()&&(this._trackAssistantClose(),null===(t=(e=this._params).onClose)||void 0===t||t.call(e),this._openState.set("closed"),null===(i=this._integration)||void 0===i||i.dispose(),this._integration=null,null===(a=this._viewModels.get())||void 0===a||a.dispose(),this._viewModels.set(null))},this._asyncReadyCbSub=null,this._getReadyFn=()=>{const e=this._felog.assistant.renderTime.startMeasure();return(t,i,a)=>{const s=e.endMeasure();let n;if((0,Me.kG)(!!this._openMeasure,"Expected Assistant to be open"),a)this._openMeasure.cancelMeasure();else{const e=this._openMeasure.endMeasure();n=null==e?void 0:e.duration,this._initPerformance&&s&&e&&e.duration>500&&this._log.warn("assistant popup took too long to open:",{init:this._initPerformance.duration,render:s.duration,total:e.duration})}this._asyncReadyCbSub=Zs.E.schedule((()=>{this._openState.set("open"),this._assistantPopupIsReady.next(),this._trackAssistantOpen(t,n),this._trackAssistantDrag(t,i)}))}},this._applyIframeOffset=e=>{var t,i;const a=null===(i=(t=this._params).getCustomOffset)||void 0===i?void 0:i.call(t);return a?{...e,size:{width:a.width,height:a.height},client:{...e.client,left:a.left+e.client.left,top:a.top+e.client.top},offset:{...e.offset,left:a.left+e.offset.left,top:a.top+e.offset.top},page:{...e.page,left:a.left+e.page.left,top:a.top+e.page.top}}:e}}get view(){return this._viewModels.pipe(re.w((e=>null===e?ea.of(null):Ks.R(self,"resize").pipe(fa.O(null),K.M(this._params.layout.textField.rect.behavior),K.M(te.aj([this._params.layout.gbutton.positionBehavior,this._params.layout.gbutton.sizeBehavior]).pipe(Z.U((([e,t])=>{const i=t.draggable?t.width:t.heightAndWidth,a=t.draggable?t.height:t.heightAndWidth;return{top:e.draggable?e.client.top:e.client.top-a,left:e.draggable?e.client.left:e.client.left-i,width:i,height:a}})))),Z.U((([[t,i],a])=>{const s=this._applyIframeOffset(i),n=this._getReadyFn();return e.isSingleCardAssistant?o.createElement(Us,{gbuttonRect:a,viewModels:e,onDomRectChange:e=>this._domRect.set(e)},o.createElement(Ws,{viewModels:e,height:this._height,ready:n,domRect:this._domRect.view()})):o.createElement(Bs,{textFieldRect:s,gButtonRect:a,viewModels:e,draggableGButtonType:this._params.draggableGButtonType},o.createElement(Ls,{viewModels:e,emogenieService:this._params.emogenieService,height:(0,u.Y)(e,s).pipe($s.R(this._assistantPopupIsReady.asObservable()),ie.b(q.wW(this._height))),ready:n,OuterElementsPortalSource:this._params.OuterElementsPortalSource}))}))))))}get activeView(){return this._viewModels.pipe(re.w((e=>{var t;return(null==e?void 0:e.isSingleCardAssistant)?ea.of(null):null!==(t=null==e?void 0:e.assistantLayoutViewModel.activeView)&&void 0!==t?t:ea.of(null)})))}dispose(){var e;this.close(),this._subs.dispose(),null===(e=this._asyncReadyCbSub)||void 0===e||e.unsubscribe()}_trackAssistantOpen(e,t){var i,a;const s=this._viewModels.get();if(null!==s){const n=s.isSingleCardAssistant?{top:0,left:0}:s.positionViewModel.initialPositionOffset,{statisticsService:r}=this._params,o=r.alertCounts.get(),l=0===n.top&&0===n.left?s.isSingleCardAssistant||"default"===s.assistantLayoutViewModel.layout.name?"smart":"hardcoded":"sticky",d=s.isSingleCardAssistant?"default":s.assistantLayoutViewModel.activeView.get().type;this._params.gnar.assistantPopupShow(d,this._height.get(),e.get().left,e.get().top,o.unmutedCapiAlerts,o.filter((e=>c.S.isCapiAlert(e)&&e.outcome===qs.TC.clarity)).visibleNotInlineCapiAlerts,o.visibleInlineCapiAlerts,o.filter((e=>c.S.isCapiAlert(e)&&"priority"===e.assistantView)).unmutedCapiAlerts,r.wordsCount.get(),l,null!==(a=null===(i=this._params.checkingService)||void 0===i?void 0:i.sessionUuid)&&void 0!==a?a:"",void 0,t,r.generalScore.get())}}_trackAssistantClose(){var e;const{statisticsService:t}=this._params,i=t.alertCounts.get(),a=this._viewModels.get(),s=(null==a?void 0:a.isSingleCardAssistant)?"default":null!==(e=null==a?void 0:a.assistantLayoutViewModel.activeView.get().type)&&void 0!==e?e:h.a.Type.default;this._params.gnar.assistantPopupCloseButtonClick(s,i.unmutedCapiAlerts,i.filter((e=>c.S.isCapiAlert(e)&&e.outcome===qs.TC.clarity)).visibleNotInlineCapiAlerts,i.visibleInlineCapiAlerts,i.filter((e=>c.S.isCapiAlert(e)&&"priority"===e.assistantView)).unmutedCapiAlerts,void 0)}_trackAssistantDrag(e,t){const i=e.get();let a=i;this._subs.push(t.pipe(Is.G(),we.h((([e,t])=>e&&!t))).subscribe((()=>{const t=e.get();Os.E9.l1Distance(t,a)<10||(this._params.gnar.assistantPopupDrag(t.left,t.top,this._height.get(),i.left,i.top),a=t)})))}}function Qs(e,t){return(0,r.pipe)(t,L.fold((()=>e),(({feedId:t})=>e.filter((e=>"pushAssistantFeed"===e.type&&e.feedId!==t)))))}function Js(e,t){if(e.isSingleCardAssistant){const i=(0,r.pipe)(function(e){const t=e.type;switch(t){case d.WT.gButton:case d.WT.card:return L.some({id:y.D.GButton.DEFAULT_GBUTTON_ID,getContent:y.D.GButton.getContent});case d.WT.emogenie:return L.some({id:y.D.GButton.TONE_GBUTTON_ID,getContent:y.D.GButton.getContent});case d.WT.proofitRequest:case d.WT.proofitReview:return L.some({id:y.D.Proofit.ID,getContent:y.D.Proofit.getContent});default:(0,Me.L0)(t)}}(t),L.getOrElse((()=>({id:y.D.GButton.DEFAULT_GBUTTON_ID,getContent:y.D.GButton.getContent}))));return e.sduiEngine.sduiManager.state.pipe(Z.U((e=>i.getContent(e,i.id))),we.h(L.isSome),Z.U(_e.MH),xs.P(),K.M(e.sduiEngine.sduiManager.state),Z.U((([e,i])=>{const a=t.type===d.WT.card?t.alertId:null;return(0,r.pipe)(L.fromNullable(a),L.chain((e=>y.D.getByAlertId(i,e))),L.map((e=>e.id)),L.fold((()=>({initialSduiItemId:L.none,openingButtonActions:e.actions})),(t=>({initialSduiItemId:L.some(t),openingButtonActions:e.actions}))))})),Z.U((({initialSduiItemId:i,openingButtonActions:a})=>{const s=Qs(a,e.sduiEngine.sduiFeedManager.currentFeed),n=y.f.create(s);return(0,r.pipe)(i,L.fold((()=>((t.type===d.WT.proofitRequest||t.type===d.WT.proofitReview)&&s.some((e=>"pushAssistantFeed"===e.type))&&e.gnar.proofitButtonClick("gmail_toolbar"),n)),(e=>({...n,actions:n.actions.map((t=>"pushAssistantFeed"===t.type?{...t,cardId:e}:t))}))))}))).subscribe((t=>e.cardsViewModel.actionEvents.next(t)))}return t.type===d.WT.emogenie?e.assistantLayoutViewModel.pushActiveView({type:h.a.Type.emogenie}):t.type===d.WT.proofitRequest?e.assistantLayoutViewModel.pushActiveView({type:h.a.Type.proofitRequest}):t.type===d.WT.proofitReview?e.assistantLayoutViewModel.pushActiveView({type:h.a.Type.proofitReview}):e.assistantLayoutViewModel.pushActiveView({type:h.a.Type.default}),E.w.EMPTY}!function(e){e.Mock=class extends Ys{constructor(e,t){super(e,t),this.debugView=this._viewModels.pipe(re.w((e=>{if(null!==e){this._getReadyFn()(X.h.create(Os.E9.create({top:0,left:0})),ea.of(!1))}return ea.of(null)}))),this.viewModels=this._viewModels.view()}}}(zs||(zs={}));var en=i(18126),tn=i(16037),an=i(64213),sn=i(14568),nn=i(99015);class rn{constructor(e,t,i,a,s,n,r,o,l,c){this.connectionState=e,this.gnar=t,this.user=i,this._hoverProvider=a,this.document=s,this.formattingService=n,this.denaliViewAdapter=r,this.capiProxy=o,this.engine=l,this.experimentClient=c,a.setAssistantHover(r.highlightHoverProvider)}static create(e){var t;const i=new tn.t(e.highlights,e.textObserver,e.replacementService.get(),e.layout,e.scroller,e.selectedHighlightsTracker,void 0,e.requestAwaitService,null===(t=e.formattingService)||void 0===t?void 0:t.get()),a=sn.p.create(e.checkingService.get(),e.checkingServiceInitialState,e.alertsTransformer,e.alertProcessor,e.sidebarEvents,e.customEventsFilter),s=(0,nn.r)(a,i,e.document.settings.lens("context"),(()=>{var t,i;return null!==(i=null===(t=e.getExistingAlerts)||void 0===t?void 0:t.call(e))&&void 0!==i?i:(0,an.q)(e.alertProcessor)}),e.textObserver,(()=>e.checkingServiceInitialState.value.lastStart),e.readersAttentionFeature,e.shortenItFeature,e.snippetsFeature,e.sduiManagerFactory,e.felog);return new rn(e.connectionState,e.gnar,e.user,e.hoverProvider,e.document,e.formattingService,i,a,s,e.experimentClient)}dispose(){this.capiProxy.dispose(),this.denaliViewAdapter.dispose(),this.engine.shutdown(),this._hoverProvider.removeAssistantHover()}}var on=i(8467);class ln{constructor({layout:e}){this._scroller=(0,on.t)({scrollToMarkRect(t,i){const a=e.textField.visibleRect.getApproximate();let s=(i&&i.paddingTop||0)-a.client.top;(s<=0||s>=a.size.height)&&(s=a.size.height/2);const n=t.top-s-a.client.top,r=t.right-t.left,o=Math.max(0,(a.size.width-r)/2);t.left,a.client.left;requestAnimationFrame((()=>e.textField.scroller.scrollBy({top:n,left:void 0})))},scrollToRange(){}})}scrollToMark(e,t){return this._scroller.scrollToMark(e,t)}}var cn=i(50004);class dn{constructor(e){this._params=e,this.sidebarEvents=new ee.xQ,this.hoverProvider=new en.f(this._params.hoverProvider),this.selectedHighlightsTracker=this._params.highlights.getSelectedHighlightsTracker({textField:this._params.originalTextField,selectionService:this._params.selectionService}),this.positionModel=((e,t,i,a)=>{const s=t.view("page","domain").get(),n=(0,cn.U)(e,s),r=i.view((({widgetOffset:e})=>null!=e?e:Os.E9.zero));return{initialPositionOffset:r,updateInitialPositionOffset:e=>{Os.E9.equals(e,r.get())||a.field.patchFieldSettings({fieldId:n,fieldSettings:{widgetOffset:e}})}}})(this._params.originalTextField,this._params.state,this._params.fieldSettings,this._params.actions),this.isTextFieldEmpty=this._params.textObserver.contentChanges.async.pipe(Z.U((e=>""===e.newText.trim())),ne.x()),this._checkingService=null}setCheckingService(e){this._checkingService=e}getCheckingServiceState(){var e;return null===(e=this._checkingService)||void 0===e?void 0:e.state.value}createIntegration(e){var t,i;const{layout:a,highlights:s,textObserver:n,replacementService:r,alertProcessor:o,state:l,document:c,requestAwaitService:d,formattingService:u,sduiManagerFactory:p}=this._params;if(null==this._checkingService)return null;const m=null===(i=(t=this._params).getCheckingServicePreviousState)||void 0===i?void 0:i.call(t);m&&(this._checkingService.state.value=m);const h=this._params.createAssistantScroller?this._params.createAssistantScroller():new ln({layout:a}),{user:g}=l.get();return rn.create({layout:a,alertProcessor:o,connectionState:l.view((e=>e.connection)),highlights:s,textObserver:n,replacementService:r,checkingService:this._checkingService.lazyCheckingService,checkingServiceInitialState:this._checkingService.state,gnar:e.gnar,felog:e.felog,user:{isPremium:g.premium,isAnonymous:g.anonymous,experiments:g.experiments,customFields:g.customFields,isGrammarlyEmployee:Tt.n5.isGrammarlyEmployee(g)},hoverProvider:this.hoverProvider,selectedHighlightsTracker:this.selectedHighlightsTracker,scroller:h,sidebarEvents:this.sidebarEvents,document:c,alertsTransformer:this._params.alertsTransformer,requestAwaitService:d,formattingService:u,getExistingAlerts:this._params.getExistingAlerts?()=>this._params.getExistingAlerts?this._params.getExistingAlerts():null:void 0,readersAttentionFeature:e.readersAttentionFeature,shortenItFeature:e.shortenItFeature,snippetsFeature:e.snippetsFeature,experimentClient:e.experimentClient,sduiManagerFactory:p,customEventsFilter:this._params.customEventsFilter})}dispose(){var e;null===(e=this._checkingService)||void 0===e||e.state.dispose()}}},99015:(e,t,i)=>{i.d(t,{r:()=>G});var a=i(57050),s=i(35214),n=i(40327),r=i(72398),o=i(73353),l=i(21729),c=i(83078),d=i(51072),u=i(5114),p=i(38983);var m=i(8482),h=i(65421),g=i(65451),f=i(74850),v=i(25938),w=i(80358),b=i(84966),_=i(34101),S=i(6488),y=i(79227),E=i(16724),k=i(95362),A=i(5008),I=i(43320),C=i(35301),M=i(85654),T=i(55360),x=i(9922),R=i(98403),F=i(67434),L=i(41398),P=i(2834),V=i(78674),O=i(77176),N=i(95574),B=i(71249),U=i(95195),D=i(31903),H=i(15467);const G=(e,t,i,G,j,W,z,q,Z,K,$)=>{const X=f.Y.create("createEngine"),Y=new x.w.Keeper,Q=function(e,t,i){const s=p.h.create(u.none),r=p.h.create(u.none);return{score:p.h.create(u.none),scoreStatus:p.h.create(u.none),title:p.h.create(void 0),textInfo:p.h.create(u.none),checkingState:p.h.create(e.checkingState),asyncChecksState:p.h.create(e.asyncChecksState),context:i,contextCompleteness:i.view(l.j.calculateCompleteness),updateContext:e=>{const t=!o.R$.eq.equals(i.get(),e);return i.set(e),t},defaultContext:s,updateDefaultContext:e=>{const t=!(0,n.pipe)((0,a.bc)([s.get(),e],c.vB(o.R$.eq.equals)));return s.set(e),t},documentText:t.getText(),documentLength:p.h.create({full:t.getTextLength(),trimmed:t.getTextLength()}),counters:p.h.create(l.dM.group.empty),calculateStats:()=>d.Vi(e.requestDocStats).then((e=>(r.set(u.some(e)),e))),recentDocumentStats:r}}(e,t,i),J=t.changes.pipe(F.R(((e,i)=>v.RI.isReset(i)?(0,n.pipe)(i.text,U.g_((()=>t.getText()),a.yR)):v.RI.isDelta(i)?(0,n.pipe)(v.RI.resFromText(e).compose(i),N.VS((e=>e.text)),U.g_((()=>t.getText()),a.yR)):e),""));Y.push(e.events.pipe(L.M(J),P.b((([e,t])=>{if("alert_received"===e.kind){const i=(0,h.IM)(e.alert,g.Q.fromString("fake"));m.$.isConsistentWithText(i,t)||($.alerts.inconsistentAlertWithText("assistant"),(0,r.i)(X,i,t,"logging"))}}))).subscribe(),e.events.pipe(P.b((t=>{Q.checkingState.set(e.checkingState),w.h.is("text_info")(t)?Q.textInfo.set(u.some(t.data)):w.h.is("finish")(t)?(Q.score.set(t.score),Q.scoreStatus.set(t.scoreStatus)):w.h.is("feedback_ack")(t)?((0,n.pipe)(t,u.fromPredicate(w.h.isUserFeedbackWithGeneralScore),u.map((e=>e.outcomeScores.GeneralScore)),u.map((e=>Math.trunc(100*e))),c.bw((e=>Q.score.modify((0,a.ls)(u.map((t=>({...t,rank:e}))),c.vx(u.some({errorRateScore:0,rank:e}))))))),(0,n.pipe)(t,u.fromPredicate(w.h.isUserFeedbackWithScoreStatus),u.map((e=>e.scoreStatus)),c.bw((e=>Q.scoreStatus.set(u.some(e)))))):w.h.is("session_started")(t)&&Q.updateDefaultContext(t.defaultDocumentContext)}))).subscribe(),e.events.pipe(P.b((e=>{(w.h.is("session_started")(e)||w.h.is("finish")(e))&&(0,n.pipe)(K,u.map((t=>t.pushStartFinishEvent(e))))}))).subscribe(),j.contentChanges.async.pipe(V.b(300),O.U((e=>e.newText)),O.U((e=>({full:e.length-1,trimmed:e.trim().length}))),P.b(R.wW(Q.documentLength))).subscribe()),(0,n.pipe)(W(),u.map((e=>{Q.updateDefaultContext(o.R$.parseDefault(e.defaultDocumentContext))})));const ee=new T.Xr,te=new k.Ek,ie=(0,s.fold)((0,s.getEndomorphismMonoid)())(B.oA([u.fromNullable(null==z?void 0:z.takeawaysFeedbackStore.addFeedbackToRawAlertTransformer),u.some((e=>(0,n.pipe)(q.get(),u.fold((()=>e),(t=>t.addStateToRawAlertTransformer(e)))))),u.some((e=>(0,n.pipe)(Z.get(),u.fold((()=>e),(t=>t.addSnippetsTriggerToAlert(e))))))])),ae=new _.a,se=new E.SC(ee,te,(()=>t.getContents().delta),e.events,e,Q.counters,ie,void 0,ae),ne=S.e.create(se.state),re=new y.k(ne,se._ops);Y.push(I.R.init(I.R.UserTextChangesSync.create(t),e.events,A.n.ignoreTEResult(e),A.n.ignoreResult(ee),te,A.A.merge([se])).subscribe()),e.loadAlerts(G()),se.flushAlerts();const oe=u.some(C.J.CategoriesModel.create(e.events,e,se.state,re,b.JW.ScopeType.GLOBAL)),le=u.some(M.k.create(ne)),ce=(0,n.pipe)(K,u.map((t=>{const i=new D.Q(e),a=t.createSDUIManager(se.state,ae.getByRawAlertId.bind(ae));return{sduiManagerFactory:t,sduiFeedbackService:i,sduiManager:a,sduiFeedManager:new H._(a.state)}})));return{alertsList:se,alertsReader:ne,alertsService:re,positionManager:ee,sessionModel:Q,mutedAlertsCategoriesModel:oe,mutingAlertsReader:le,shutdown:()=>{se.dispose(),Y.dispose(),(0,n.pipe)(ce,u.map((e=>{e.sduiManager.dispose(),e.sduiFeedManager.dispose()})))},sduiEngine:ce}}},37532:(e,t,i)=>{i.d(t,{aU:()=>ot,X5:()=>lt,n:()=>ct});var a,s=i(57050),n=i(35214),r=i(5114),o=i(40327),l=i(32281),c=i(50622),d=i(25913),u=i(9671),p=i(38152),m=i(51972),h=i(5178),g=i(19654),f=i(2844),v=i(75003),w=i(81301),b=i(9922),_=i(77176),S=i(28043),y=i(16118),E=i(22232),k=i(83078),A=i(38983);!function(e){e.equals=(e,t)=>"score"in e&&"score"in t?e.score===t.score:e.type===t.type}(a||(a={}));class I{constructor(e,t,i,n,l,c){this._sessionModel=e,this._layoutVM=t,this._modalManager=i,this._user=n,this._gnar=l,this._closeAssistant=c,this.showSetGoalsActionButton=A.h.create(!0),this.showSettingsActionButton=A.h.create(!0),this.close=()=>{this._closeAssistant()},this.score=f.aj([this._sessionModel.score.view(r.map((e=>({capiScore:e.rank})))),this._sessionModel.checkingState]).pipe(_.U((([e,t])=>(0,o.pipe)(e,r.map((e=>({...e,isLoading:"idle"!==t}))))))),this.summary=this._sessionModel.textInfo.view((0,s.ls)(r.chain((e=>e.messages)),r.map((e=>e.assistantHeader)),r.getOrElse((()=>"Looking good so far")),(e=>({content:e})))),this.logoScore=(0,f.aj)([this._layoutVM.activeView,this.score]).pipe(_.U((([e,t])=>(0,o.pipe)(t,r.fold((()=>({type:"logo"})),(t=>e.type!==v.a.Type.default?{type:"logo"}:{type:"score",score:t}))))),S.x(a.equals)),this.visibility=this._layoutVM.activeView.view((e=>e.type===v.a.Type.default?"visible":"hidden")),this._subs=new b.w.Keeper,this._trackHeaderMessageChanges(),this._trackToShowActionButtons()}open(e){if("setGoals"===e)this._subs.push(this._modalManager.show(w.Iy.setGoals("user")).subscribe());else(0,E.vE)(e)}_trackHeaderMessageChanges(){const e=this.summary.pipe(y.G()).subscribe((([e,t])=>{var i,a;this._gnar.assistantHeaderMessageUpdate(e.content,t.content,null===(i=(0,o.pipe)(this._sessionModel.textInfo.get(),r.toUndefined))||void 0===i?void 0:i.wordsCount,null===(a=(0,o.pipe)(this._sessionModel.score.get(),k.Fc))||void 0===a?void 0:a.rank)}));this._subs.push(e)}_trackToShowActionButtons(){const e=this._user.subscribe((e=>{e.isAnonymous?(this.showSetGoalsActionButton.set(!1),this.showSettingsActionButton.set(!1)):(this.showSetGoalsActionButton.set(!0),this.showSettingsActionButton.set(!0))}));this._subs.push(e)}dispose(){this._subs.dispose()}}var C=i(59456),M=i(40033),T=i(66896),x=i(98403),R=i(31881);class F{constructor(e,t,i,a,s,n,l){this._lensPreviewVM=e,this._layoutVM=t,this._readersAttentionVM=i,this._emogenieService=a,this._session=s,this._readersAttentionPredictionCardState=n,this._gnar=l,this._subs=new b.w.Keeper,this.previewState=A.h.create({kind:M.fA.hidden}),this.previewFlow=R.Z.fromSideEffect((e=>{switch(e.action.key){case"tone":{const e=this._emogenieService.viewState.view("prevalentEmotion").get();return e&&this._gnar.emogeniePredictionButtonClick(e.name),this._layoutVM.pushActiveView({type:v.a.Type.emogenie})}case"readersAttention":return this._readersAttentionVM.openPanel({type:v.a.ReadersAttention.Caller.Type.predictionWidget});default:(0,E.vE)(e.action)}}),this.previewState),this._previewState=(0,o.pipe)(f.aj([this._emogenieService.viewState.view((e=>r.fromNullable(e.settings.hiddenReport?void 0:e.prevalentEmotion))),this._emogenieService.viewState.view("brandToneOffImageUrl"),this._readersAttentionPredictionCardState,this._session.documentLength,this._lensPreviewVM.getLens(T.R.SpecialId.PredictionEmogenie),this._lensPreviewVM.getLens(T.R.SpecialId.PredictionTakeaways)]),_.U((([e,t,i,a,s,n])=>(r.isSome(e)||r.isSome(i))&&a.trimmed>0?{kind:M.fA.visible,tone:(0,o.pipe)(e,r.map((e=>({emotion:e,alertsCount:s.count,brandToneOffImageUrl:t})))),readersAttention:(0,o.pipe)(i,r.map((e=>({...e,alertsCount:(0,o.pipe)(i,r.map((e=>e.alertsCount)),r.getOrElse((()=>n.count)))}))))}:a.trimmed>0?{kind:M.fA.zero}:{kind:M.fA.hidden}))),this._subs.push(this._previewState.subscribe(x.wW(this.previewState)))}dispose(){this._subs.dispose()}}var L=i(19043),P=i(17771),V=i(90361),O=i(40018),N=i(85985),B=i(14601),U=i(15646),D=i(35416);class H{constructor(e,t,i,a,n){this._feature=e,this._assistantLensState=t,this._assistantCardActions=i,this._getAlertById=a,this._getActiveAlert=n,this._subs=new B.w,(0,o.pipe)(this._feature,k.bw((e=>{var t,i;this._subs.add((t=this._assistantCardActions,i=e=>this._getAlertById(e),t.pipe(N.h(U.lY.isTakeawayAction)).pipe(_.U((e=>(0,o.pipe)(i(e.alertId),r.chain((t=>P.Y(r.option)({id:r.some(t.id),rawId:O.bZ.getRawId(t),isLikelyToRead:(0,o.pipe)(t.extraProperties.takeaway,r.map((e=>e.isLikelyToBeRead))),score:(0,o.pipe)(t.extraProperties.takeaway,r.map((e=>e.score))),textRange:r.fromNullable(t.getHighlightRanges()[0]),action:r.some(e)}))),k.Fc))),N.h(V.fQ))).subscribe((t=>{e.tracking.onTakeawayUserAction(t.isLikelyToRead,t.score,t.action,t.textRange)}))),this._subs.add(function(e,t,i){return e.pipe(_.U(D.nL.getActiveAlert(i)),_.U(r.map((e=>e.id)))).pipe(_.U(k.Fc),N.h(V.fQ),S.x(),_.U((0,s.ls)(t,r.chain((e=>(0,o.pipe)(e.extraProperties.takeaway,r.map((({score:t})=>({score:t,textRange:e.getHighlightRanges()[0]})))))),k.Fc)),N.h(V.fQ))}(this._assistantLensState,(e=>this._getAlertById(e)),this._getActiveAlert).subscribe((t=>{e.tracking.onKeyTakeawayCardShow(t.score,t.textRange)})))})))}dispose(){this._subs.unsubscribe()}}var G=i(41354),j=i(31536),W=i(16868),z=i(74364),q=i(60797),Z=i(66310),K=i(91402),$=i(40151),X=i(76974),Y=i(78674),Q=i(41398),J=i(95195);function ee(e,t,i,a,s){return{id:"changeAlertEffect",when:T.R.isWithAlertsId,what:D.nL.Effect.SwitchAlert.create(e.actionEvents.pipe(Z.w((e=>{const n=t.get();if(!D.nL.hasCards(n))return K._(new E.ej("Cannot update state without cards"));switch(e.type){case U.lY.Type.alertMinicardButtonClick:return(0,o.pipe)(i.getRegistered(e.alertHighlight.alert.id),r.fold((()=>(s.warn("somehow we got click on non registered alert",e.alertHighlight.alert),$.E)),(()=>X.of(e.alertHighlight))));case U.lY.Type.cardMatchesNavigationButtonClick:const t=e.transitionTo;switch(t.kind){case"anotherAlert":return(0,o.pipe)("right"===e.direction?a.nextAlert(t.card):(0,o.pipe)(a.prevAlert(t.card),k.vx(a.anyRegisteredAlert(t.card))),r.fold((()=>$.E),(e=>X.of({alert:e,highlightIndex:0}))));case"sameAlert":return(0,o.pipe)(i.getRegistered(t.card.activeAlert.id),r.fold((()=>$.E),(()=>X.of({alert:t.card.activeAlert,highlightIndex:t.highlightIndex}))));default:return(0,E.vE)(t)}default:return $.E}})),_.U((e=>({alertHighlight:e,alertSource:O.l$.sidebar,options:{order:"lensOrder"}})))))}}function te(e,t,i){const a=e.pipe(N.h(D.nL.hasCards),Y.b(0),_.U((e=>e)),N.h((e=>e.currentLens.items.size>0&&r.isNone(D.In.getActiveItem(e.currentLens))&&i.get())),_.U((e=>(0,o.pipe)(e.currentLens.items.getAt(0),r.chain(m.O.checksFeedItemsMapper((e=>r.some(e.activeAlert)),(e=>r.some(e.activeAlert)),(()=>r.none),(()=>r.none),(()=>r.none))),k.bw((()=>t.set(r.some(W.CV.skip))))))),q.oA,N.h((e=>e.state.type===O.bZ.State.Type.REGISTERED)),S.x());return{id:"focusFirstCardSideEffect",when:e=>e!==T.R.SpecialId.PredictionTakeaways&&e!==T.R.SpecialId.PredictionEmogenie,what:D.nL.Effect.SwitchLens.create(a.pipe(Q.M(e),_.U((([e,t])=>({lensId:t.currentLens.id,alertSource:O.l$.text,options:{order:"lensOrder",toFocus:D.nL.Effect.FocusBehavior.focusAlert({alert:e,highlightIndex:0})}})))))}}function ie(e,t,i){const a=e.pipe(_.U((e=>a=>e.type===z.ay.Type.AppliedAlertAnimationFinished&&a.currentLens.meta.filter(e.alert)&&D.nL.hasItems(a)?a.patch({currentLens:(0,o.pipe)(J.Y3((()=>O.bZ.isApplicableAlert(e.alert)?t.finishApplyAnimation([e.alert])(a.currentLens):a.currentLens),(e=>i.error("could not update lens state on applied animation finish",e))),J.fS((()=>a.currentLens))),alertSource:e.alert.state.source}):a)));return{id:"onAlertApply",when:s.W8,what:D.nL.Effect.Applicator.create(a)}}function ae(e,t){return{id:"lensChangeEffect",when:s.W8,what:D.nL.Effect.SwitchLens.create(e.pipe(Q.M(t),N.h((([e,t])=>e.lensId!==t)),_.U((([e])=>({lensId:e.lensId,alertSource:O.l$.sidebar,options:{order:"lensOrder",toFocus:e.focusFirstCard?D.nL.Effect.FocusBehavior.focusFirst:D.nL.Effect.FocusBehavior.noFocus}})))))}}var se=i(5920),ne=i(16892),re=i(48521),oe=i(25975),le=i(55415),ce=i(65060);const de=(e,t)=>i=>(0,s.zG)(t,r.fold((()=>r.some({lens:i,newItem:r.none})),(t=>(0,s.zG)(e,r.fold((()=>r.some({lens:i,newItem:r.some(ce.g.create(t,ne.s.PositionState.empty,re.o.VisualState.initial({type:"rendered",clockwise:!0},!1)))})),(e=>(0,s.zG)(ce.g.create(t,e.positionState,e.visualState),r.fromPredicate((t=>ce.g.hashCodeOwnFields(t)!==ce.g.hashCodeOwnFields(e))),r.map((e=>({lens:i,newItem:r.some(e)}))))))))));var ue=i(48439),pe=i(19751),me=i(32952),he=i(8125),ge=i(73975),fe=i(74850),ve=i(71249),we=i(16314);const be=fe.Y.create("ReadersAttentionItemSideEffects");function _e(e){return e.pipe(_.U((()=>s.yR)))}function Se(e,t){return e.pipe(N.h(we.Vl),_.U((e=>i=>i.patch({currentLens:(0,o.pipe)(i.currentLens.items.find((t=>t.id===e.id)),r.fold((()=>(be.error("Cannot focus non-existing ReadersAttentionItem."),i.currentLens)),(()=>(0,s.MZ)((0,o.pipe)(i.currentLens,t.selectItemById(e.id))))))}))))}class ye{constructor(e,t,i,a,n,o,l,c,d){this._cardActions=e,this._readersAttentionItemInfo=t,this._assistantLensState=i,this._checksFeedCapabilities=a,this._heatmapVisible=n,this._layoutViewModel=o,this._onDismiss=l,this._gnar=c,this._statistics=d,this._subs=new B.w,this.actions=new me.xQ,this._relayBaseActions=this.actions.pipe(N.h((0,he.Kg)(U.eI.isStartTransitionTo,U.eI.isCompleteTransitionTo))).subscribe((e=>this._cardActions.next(e))),this._goToReadersAttentionView=this.actions.pipe(N.h(we.Q)).subscribe((e=>{this._gnar.attentionScoreFullCardSeeSuggestionsButtonClick(),this._layoutViewModel.pushActiveView({type:v.a.Type.readersAttention,caller:{type:v.a.ReadersAttention.Caller.Type.readersAttentionItem,item:e.item}})})),this._goToFeedbackView=this.actions.pipe(N.h(we.RJ)).subscribe((()=>{this._layoutViewModel.pushActiveView({type:v.a.Type.feedback})})),this._dismissItem=this.actions.pipe(N.h(we.l9)).subscribe((()=>{this._gnar.attentionScoreFullCardDismissButtonClick(),this._onDismiss()})),this._toggleHeatmapVisibility=this._assistantLensState.pipe(_.U((e=>(0,s.zG)(J.DT(D.nL.hasItems,(()=>e.currentLens.id))(e),J.UI(D.nL.Prism.getLens().get),J.tS((e=>(0,s.zG)(e,D.In.getActiveItemOfType(ce.m),J.Yo((()=>e.id)),J.UI((e=>e.id)))))))),pe.skipBy(J.Eh(ge.yv,ge.yv))).subscribe(J.g_((e=>{e!==T.R.SpecialId.PredictionTakeaways&&this._heatmapVisible.set(!1)}),(()=>this._heatmapVisible.set(!0)))),this._activeCardOpenStats=null,this._trackOpenClose=this._assistantLensState.pipe(_.U((e=>(0,s.zG)(r.fromPredicate(D.nL.hasItems)(e),r.map(D.nL.Prism.getLens().get),r.chain(D.In.getActiveItemOfType(ce.m)),r.fold(s.jv,s.W8)))),S.x()).subscribe((e=>{(0,s.zG)(this._readersAttentionItemInfo.get(),r.map((e=>ue.T.prism.reverseGet(e.attentionScore))),k.bw((t=>{const i=this._statistics.wordsCount.get();e?(this._gnar.attentionScoreFullCardShow(i,t),this._activeCardOpenStats={numWords:i,attentionScore:t}):this._activeCardOpenStats&&(this._gnar.attentionScoreFullCardHide(i,t,this._activeCardOpenStats.numWords,this._activeCardOpenStats.attentionScore),this._activeCardOpenStats=null)})))})),this._subs.add(this._relayBaseActions),this._subs.add(this._toggleHeatmapVisibility),this._subs.add(this._goToReadersAttentionView),this._subs.add(this._goToFeedbackView),this._subs.add(this._dismissItem),this._subs.add(this._trackOpenClose)}getApplicatorEffects(){return e=this._readersAttentionItemInfo,t=this.actions,i=this._checksFeedCapabilities,(0,o.pipe)([[_e(e),"newReadersAttentionInfo"],[Se(t,i),"focusReadersAttentionItem"]],ve.UI((([e,t])=>({id:`readersAttentionFeedItem.effects.${t}`,when:T.R.isMainLens,what:D.nL.Effect.Applicator.create(e)}))));var e,t,i}dispose(){if(this._activeCardOpenStats){const e=this._activeCardOpenStats.numWords,t=this._activeCardOpenStats.attentionScore;(0,s.zG)(this._readersAttentionItemInfo.get(),r.map((e=>ue.T.prism.reverseGet(e.attentionScore))),k.bw((i=>{this._gnar.attentionScoreFullCardHide(this._statistics.wordsCount.get(),i,e,t)}))),this._heatmapVisible.set(!1),this._activeCardOpenStats=null}this._subs.unsubscribe()}}var Ee,ke=i(15787);!function(e){const t=(e,t)=>e.pipe(N.h(U.lY.isCreateSnippetAction),_.U((({id:e})=>i=>{const a=(0,s.zG)(i.currentLens.items.update(e,t({type:"success",clockwise:!0})),J.g_((()=>i.currentLens.items),s.yR));return ke.sU.itemsLens.set(a,i)})));e.applicatorEffects=(e,i)=>(0,s.zG)([[t(e,i),"suggestedSnippetSuccessEffect"]],ve.UI((([e,t])=>({id:`cardsViewModel.effects.${t}`,when:T.R.isWithAlertsId,what:D.nL.Effect.Applicator.create(e)}))))}(Ee||(Ee={}));var Ae=i(77394),Ie=i(86620),Ce=i(51540),Me=i(40081),Te=i(62346),xe=i(780),Re=i(73582),Fe=i(73763),Le=i(92783),Pe=i(4120),Ve=i(44618),Oe=i(84966),Ne=i(13313),Be=i(21619),Ue=i(54216),De=i(48052),He=i(91549),Ge=i(83167),je=i(20594),We=i(35607),ze=i(20291),qe=i(34383),Ze=i(33806),Ke=i(86775),$e=i(11245),Xe=i(4890),Ye=i(73841),Qe=i(89770),Je=i(39920),et=i(88772),tt=i(93508),it=i(68425),at=i(24209),st=i(17343),nt=i(95574),rt=i(81531);const ot=e=>e.view((e=>(0,o.pipe)(r.fromPredicate(D.nL.hasItems)(e),r.map((e=>e.currentLens.items)),r.map((e=>e.filter((0,he.Kg)(m.O.isAlertCard,m.O.isAlertsBundle)))),r.map((e=>e.filter((e=>"rendered"===e.visualState.transition.type)))),r.fold((()=>null),(e=>e.values()))))).pipe(tt.O([]),N.h(V.Nf),y.G(),_.U((([e,t])=>{const i=new Set(e.map((e=>e.id)));return t.filter((e=>!i.has(e.id)))})),it.J()),lt=(e,t)=>e.alertClicked.pipe(_.U((e=>(0,o.pipe)(e,r.fold(s.gn,(e=>e.alert))))),N.h(V.fQ),Q.M((e=>e.pipe(_.U((e=>D.nL.hasCards(e)&&T.R.isMainLens(e.currentLens.id)?m.O.getActiveItemWithAlert(e.currentLens):r.none)),_.U((e=>(0,o.pipe)(e,r.fold((()=>null),(e=>e.activeAlert)))))))(t)),N.h((([e,t])=>e.id!==(null==t?void 0:t.id))),_.U((([e,t])=>e))),ct=(e,t,i,a,f,b,E,M,R,P,B,q,K,Y,Q,ne,re,ue,pe,ge,fe,ve,we,be,_e,Se,it,ct,dt,ut,pt)=>{const mt=rt.C8.Logging.getLogger("view_models"),ht=A.h.create(Ne.A.defaultState),gt=A.h.create(s.jv),ft=A.h.create(!1),vt=A.h.create(!1),wt=A.h.create(!1),bt=Pe.n5.isFree(Y.view("user").get())&&"test_no_underlines"!==ut.getTreatment(Fe.p.YellowUnderlinesExtRelaunch),_t=e=>(0,he.W9)((()=>!vt.get()),(0,he.W9)((e=>!wt.get()||O.bZ.isInline(e)),e)),St=Ue.t.create({...Ue.t.defaultLensFilters,[T.R.SpecialId.Priority]:O.bZ.belongsToPriorityLens,[T.R.SpecialId.AllAlerts]:(0,he.W9)(O.bZ.belongsToAllAlerts,(0,s.ff)(O.bZ.isTakeaway))},{...Ue.t.defaultTextFilters,[T.R.SpecialId.Closed]:s.jv,[T.R.SpecialId.Priority]:_t(O.bZ.belongsToPriorityLens),[T.R.SpecialId.AllAlerts]:_t((0,he.W9)(O.bZ.belongsToAllAlerts,(0,s.ff)(O.bZ.isTakeaway))),[T.R.SpecialId.PredictionTakeaways]:e=>gt.get()(e)}),yt=at.T(gt,vt,ft,wt).pipe(st.h(x.PU)),Et=Ne.A.get(e.alertsList.state,e.alertsList.lensesScores,St).subscribe(x.wW(ht)),kt=new Me.t(ht.view("lenses"),St,e.sessionModel.scoreStatus),At=(0,De.$y)((0,Ve.a)(t).getContents),It={features:new Set([je.IG.Features.showCardLabelInOutcomes]),cardLayoutDensityMode:Xe.j.Density.minimal,shouldAnimateAlertApply:je.IG.Default.shouldAnimateAlertApply,cardVisualMode:A.h.create(Xe.j.CardVisualMode.RegularLightMode)},Ct=(0,je.Ls)(At,e.alertsReader,It,(()=>X.of(r.none)),e.mutingAlertsReader),Mt=He.R.ItemFactory.create(At,e.mutingAlertsReader,It,(()=>X.of(r.none))),Tt=(0,$e.U)(At,e.alertsReader,It,qe.T.ordAlert),xt=A.h.create(qe.D.empty()),Rt=A.h.create(r.none),Ft=A.h.create(16),Lt=(0,d.q)((()=>Ut.get().currentLens.id),(()=>Rt.get()),(()=>Ft.get())),Pt=m.O.getCapabilities(Ct,Mt,Tt,e.alertsReader,At,xt,(()=>Ut.get().currentLens.id),Lt),Vt=new Je.gi(m.O.equatable.structEq,m.O.defaultOrd),Ot=(0,Je.is)(Ct,Pt),Nt=new Qe.oq(e.alertsList.state,e.alertsReader,ht.view("lenses"),e.positionManager,kt,new Je.ad((e=>e.id===T.R.SpecialId.Priority),new Ze.c(Tt,xt,e.alertsReader,(e=>e.id===T.R.SpecialId.PredictionTakeaways),Vt,m.O.equatable.structEq),m.O.equatable.structEq,m.O.bundlesOrd),(0,Je.kn)(Mt,It,(e=>e===T.R.SpecialId.Priority),(0,Ze.E)(Tt,xt,e.alertsReader,(e=>e===T.R.SpecialId.PredictionTakeaways),Ot,Pt),Pt),Pt,St),Bt=i.get(),Ut=A.h.create(Nt.emptyState(Bt).patch({alertSource:O.l$.sidebar})),Dt=Ut.view((e=>(0,o.pipe)(r.fromPredicate(D.nL.hasItems)(e),r.map((e=>D.nL.Prism.getLens().get(e))),r.filter((e=>e.id===T.R.SpecialId.PredictionTakeaways)),r.chain(D.In.getActiveItem)))).view(r.fold((()=>s.jv),(e=>t=>Pt.hasAlert(t.id)(e)))).subscribe(x.wW(gt)),Ht=Ut.view((e=>(0,o.pipe)(r.fromPredicate(D.nL.hasItems)(e),r.map((e=>D.nL.Prism.getLens().get(e))),r.chain(D.In.getActiveItem),r.filter(ce.m),r.fold(s.jv,s.W8)))).subscribe(x.wW(vt));B.next({kind:Ae.R.ChangeLens,selectedLens:Bt===T.R.SpecialId.Priority?"priority":"all"});const Gt=(0,Ge.u0)((()=>t.getCursor().index),Nt),jt=new Re.x(e.alertsList,Ut,3),Wt=new w.EQ(new xe.o(e.sessionModel,jt,pe.get().isPremium,ne)),zt=new Ie.C(ct()),qt=new ke.Xx({flush:()=>t.flushChanges()},new me.xQ,Ct,e.alertsService,(()=>Promise.resolve()),(()=>Promise.resolve()),(0,o.pipe)(e.mutedAlertsCategoriesModel,r.map((e=>({model:e,openSuggestionsManagement:()=>self.open((0,Le.Um)().suggestionsSettings)})))),r.some(g.B.getCardsViewModelSendToURLExperiment(zt,ne)),(()=>!1),m.O.getActiveItemWithAlert,Pt,Ut,zt,{bufferTransitions:!0,showGbPrompt:g.B.shouldShow(pe.get())}),Zt=new u.y(qt.actionEvents,ne,e.alertsReader),Kt=new v.D(ne,fe,ve,Se,it),$t=new G.X(f,Kt,e.alertsList.state,e.alertsReader,Ut),Xt=new F(kt,Kt,$t,a,e.sessionModel,$t.predictionCardState,ne),Yt=new p.WY(Ut,Xt,jt,Pt,ne,bt),Qt=new We.o((()=>J.F2(void 0))),Jt=Yt.upgradeHookExpanded.pipe(_.U((e=>e&&bt)),S.x()).subscribe(x.wW(ft)),ei=(0,Te.xl)(Ut,St,yt,ft),ti=new Te.o$(e.alertsList,e.alertsReader,e.positionManager,e.alertsService,t,Ut,ei,m.O.getActiveItemWithAlert,q,!0,ft),ii=(0,W.hp)(Ut,ti,A.h.create(16),Qt,t,mt),ai=new me.xQ,si=Ut.pipe(_.U((e=>e.currentLens.id))),ni=$t.checklist.subscribe(x.wW(xt)),ri=new I(e.sessionModel,Kt,Wt,pe,ne,ge),oi=Kt.activeView.pipe(_.U((e=>e.type)),tt.O(v.a.Type.startupPlaceholder),y.G(),_.U((([e,t])=>e===v.a.Type.startupPlaceholder&&t===v.a.Type.proofitRequest))).subscribe(x.wW(wt)),li=Yt.cardListViewportHeight.subscribe(x.wW(Rt)),ci=new h._(Kt,ue,ne),di=(0,o.pipe)(P,r.map((e=>new L.S(Kt,e,ge,ne)))),ui=new Be.mN(t,Ut,ti,e.alertsReader,m.O.getActiveItemWithAlert,(t=>{const i=t.reduce(((t,i)=>(0,o.pipe)(e.alertsReader.getById(i.alert.id),r.chain(O.bZ.getRawId),k.bw((e=>t.set(e,i))),r.fold((()=>t),(()=>t)))),new Map),a=Array.from(i.keys()).map((e=>be.alerts.getAlertById(e))).filter(V.fQ);if(a.length){const e=a.reduce(((e,t)=>l.S.ordering.greaterThanOrEqual(t,e)?t:e));return r.fromNullable(i.get(Oe.wQ.Id.create(e.id)))}return r.none})),pi=ot(Ut),mi=lt(ui,Ut),hi=E.pipe(Z.w(r.fold((()=>$.E),(t=>t.initAssistantCardActionsProcessing(qt.actionEvents,e.alertsReader,Ut,pi,mi))))).subscribe(),gi=M.pipe(Z.w(r.fold((()=>$.E),(t=>t.initCardActionsProcessing(qt.actionEvents,e.alertsReader,pi,mi,Ut))))).subscribe(),fi=R.pipe(Z.w(r.fold((()=>$.E),(t=>t.initCardActionsProcessing(qt.actionEvents,e.alertsReader,pi,Ut))))).subscribe(),vi=A.h.create((0,o.pipe)(K,r.fold((()=>W.CV.skip),(()=>O.l$.text)),r.some)),wi=(0,o.pipe)(f,r.map((e=>new ye(qt.actionEvents,e.feedItemInfo,Ut,Pt,e.heatmap.visible,Kt,(()=>e.onDismissFeedItem()),ne,re)))),bi=[(0,Ce.A7)(ui,Ut,bt),(0,o.pipe)(z.EQ.focusMarkByActiveAlert(Ut,ti,e.alertsReader,m.O.getActiveFocusableItem,mt.getLogger("MarksEffects.focusMarkByActiveAlert")),D.nL.Effect.Producer.delayed(q)),ie(ti.events,Pt,mt.getLogger("createOnAlertApplySideEffect")),ee(qt,Ut,e.alertsReader,Ct,mt),te(Ut,vi,Yt.autoFocusEnabled),...qt.getApplicatorEffects(),Yt.applicatorEffects,ze.R7(Ut,Qt,Pt,(0,s.MZ)(qt.actionEvents),{cardsAroundActive:10,cardsBeyondViewport:10}),(0,o.pipe)((0,W.k9)(Ut,ii,vi,m.O.getActiveAlignableItem,Pt),D.nL.Effect.Producer.delayed(q)),ze.XU(Ut,Qt,Pt),ae(ai,si),ke.dv.createSendActiveAlertFeedbacksEffect(Ut,m.O.getActiveItemWithAlert,e.alertsService,e.alertsReader,mt.getLogger("CardsViewModelEffects.createSendActiveAlertFeedbacksEffect")),Ke.G.getChecklistHandlerSideEffect(Tt,$t.checklist,e.alertsReader,m.O.getActiveItemWithAlert,(e=>e===T.R.SpecialId.PredictionTakeaways)),...(0,o.pipe)(wi,r.fold((()=>[]),(e=>e.getApplicatorEffects()))),...Ee.applicatorEffects(qt.actionEvents,Pt.transitionTo)],_i=A.h.create(T.R.SpecialId.AllAlerts),Si=Ut.view((e=>e.currentLens.id)).pipe(N.h((e=>e===T.R.SpecialId.Priority||e===T.R.SpecialId.AllAlerts))).subscribe(x.wW(_i)),yi=(0,Ge.VC)(Nt,Gt,_i,Pt),Ei=A.h.create(K),ki=(0,Ge.Dv)((e=>T.R.isMainLens(e.currentLens.id)),yi,Pt),Ai=new Ge.vM(e.sessionModel.checkingState,Ut),Ii=(0,o.pipe)([(0,o.pipe)((e=>Ge.Py.whenShouldVerifyCurrentLens(m.O.getActiveItemWithAlert,Pt)(e)&&e.currentLens.id!==T.R.SpecialId.PredictionTakeaways),Ge.Py.behaviorToEffect((()=>r.some(D.nL.Effect.FocusBehavior.focusNext)))),(0,o.pipe)((0,he.W9)((()=>r.isSome(Ei.get())),Ge.Py.whenNoActiveCard),Ge.Py.behaviorToEffect((e=>(0,o.pipe)((e=>{const t=(0,r.fromPredicate)((0,he.Kg)(m.O.isAlertCard,m.O.isAlertsBundle));return(0,o.pipe)(Ei.get(),r.chain((i=>(Ei.set(r.none),D.nL.hasCards(e)?(0,o.pipe)(e.currentLens.items.reduce(((e,a)=>(0,o.pipe)(e,r.alt((()=>(0,o.pipe)(a,t,r.chain((e=>r.fromNullable(e.alerts.find((e=>e.id.startsWith(i+"_"))))))))))),r.none),r.map((t=>({alert:t,highlightIndex:0,lensId:e.currentLens.id})))):r.none))))})(e),r.map((e=>D.nL.Effect.FocusBehavior.focusAlert(e))))))),(0,o.pipe)((0,he.W9)((()=>Yt.autoFocusEnabled.get()),(0,he.W9)(Ge.Py.whenFirstOpeningDocumentWithAlerts(Ai),Ge.Py.whenNoActiveCard)),Ge.Py.behaviorToEffect((()=>r.some(D.nL.Effect.FocusBehavior.focusFirst))))],(0,n.fold)((0,n.getFunctionMonoid)(r.getFirstMonoid())())),Ci=Ge.Py.getStateTransformer(Ii,ki,e.alertsReader,Pt,(e=>Yt.autoFocusEnabled.get()&&"text"!==e.alertSource),s.Q1,_i),Mi=oe.v.Items.getItemsPositionsUpdateTransformer(Pt),Ti=(0,o.pipe)(f,r.fold((()=>et.t.nothing),(e=>{return t=e.feedItemInfo,({state:e,metadata:i})=>{if(!D.nL.hasItems(e)||!T.R.isMainLens(e.currentLens.id)||!D.nL.isLensview(e))return J.t$({state:e,metadata:i});const a=(0,s.zG)(se.l.find(e.currentLens.items,ce.m),r.map(le.ei("value")));return(0,s.zG)(e,D.nL.getLens,r.chain(de(a,t.get())),r.map((({lens:t,newItem:i})=>D.nL.Prism.getLens().compose(oe.v.Prism.items).set((0,s.zG)(a,r.fold((()=>t.items),(e=>t.items.remove(e.id))),(e=>(0,s.zG)(i,r.fold((()=>e),(t=>e.add(t)))))),e))),r.getOrElse((()=>e)),(e=>J.t$({state:e,metadata:i})))};var t}))),xi=(0,s.ls)(Ci,nt.L9(Mi),nt.L9(Ti)),Ri=new Ye.l(Ut,Nt,e.alertsReader,e.alertsService,bi,m.O.getActiveItemWithAlert,xi),Fi=ai.pipe(_.U((({lensId:e})=>e)),N.h((e=>e===T.R.SpecialId.AllAlerts||e===T.R.SpecialId.Priority)),S.x()).subscribe((e=>{i.set(e),B.next({kind:Ae.R.ChangeLens,selectedLens:e===T.R.SpecialId.Priority?"priority":"all"})})),Li=Kt.activeView.pipe(_.U((e=>{switch(e.type){case v.a.Type.default:return i.get();case v.a.Type.emogenie:return T.R.SpecialId.PredictionEmogenie;case v.a.Type.readersAttention:return T.R.SpecialId.PredictionTakeaways;case v.a.Type.readersAttentionHelp:return T.R.SpecialId.Closed;case v.a.Type.proofitReview:return T.R.SpecialId.RealTimeProofit;default:return null}})),N.h(V.fQ),S.x(),_.U((e=>[e,e===T.R.SpecialId.AllAlerts||e===T.R.SpecialId.Priority]))).subscribe((([e,t])=>ai.next({lensId:e,focusFirstCard:t}))),Pi=new j.X(Y,Q,pt,ue),Vi=new H(f,Ut,qt.actionEvents,(t=>e.alertsReader.getById(t)),m.O.getActiveItemWithAlert),Oi=b.pipe(Z.w(r.fold((()=>$.E),(t=>t.initAssistantSession(qt.actionEvents,e.alertsReader,Ut,e.alertsService,e.alertsList.state))))).subscribe(),Ni=qt.actionEvents.pipe(N.h(U.lY.isOpenIdeasGallery)).subscribe((()=>self.open((0,Le.Um)().grammarlyIdeasSales,"_blank"))),Bi=(0,C.W)(we),Ui=qt.actionEvents.subscribe((0,s.ls)((0,c.JH)(e.alertsReader,c.SV.Source.assistant),k.bw((e=>{(async()=>{e.kind===c.SV.Kind.alertApply&&e.source===c.SV.Source.assistant&&await dt.incrementCounter(),_e.next(e)})()}))));return{lensState:Ut,cardsViewModel:qt,lensPreviewViewModel:kt,cardsListScrollManager:Qt,upgradeViewModel:jt,alertProcessor:be,assistantHeaderViewModel:ri,assistantLayoutViewModel:Kt,assistantCardListViewModel:Yt,lensChanged:ai,predictionsPreviewViewModel:Xt,assistantFeedbackViewModel:ci,assistantSettingsViewModel:Pi,assistantProofitViewModel:di,readersAttentionViewModel:$t,readersAttentionItemViewModel:wi,assistantModalManager:Wt,marksViewModel:ti,gnar:ne,positionViewModel:Bi,user:pe,capabilities:Pt,remSize:Ft,isSingleCardAssistant:!1,dispose:()=>{Ui.unsubscribe(),Vi.dispose(),Dt.unsubscribe(),ni.unsubscribe(),qt.dispose(),Ri.dispose(),ti.dispose(),Xt.dispose(),Fi.unsubscribe(),Et.unsubscribe(),Li.unsubscribe(),ri.dispose(),Yt.dispose(),Wt.hideAll(),$t.dispose(),Si.unsubscribe(),li.unsubscribe(),Oi.unsubscribe(),Ht.unsubscribe(),oi.unsubscribe(),Ni.unsubscribe(),gi.unsubscribe(),fi.unsubscribe(),hi.unsubscribe(),Jt.unsubscribe(),(0,o.pipe)(di,k.bw((e=>e.dispose()))),(0,o.pipe)(wi,k.bw((e=>e.dispose()))),Zt.dispose()}}}},9671:(e,t,i)=>{i.d(t,{t:()=>l,y:()=>o});var a=i(15090),s=i(15646),n=i(77176),r=i(85985);class o{constructor(e,t,i){this._cardActions=e,this._gnar=t,this._alertsReader=i,this._subs=[l(this._cardActions,this._gnar,"assistant"),a.g.createSubscription(this._cardActions,this._gnar,this._alertsReader.getById)]}dispose(){this._subs.forEach((e=>e.unsubscribe()))}}const l=(e,t,i)=>e.pipe(n.U((e=>e.type)),r.h((e=>e===s.lY.Type.muteAlertCategory||e===s.lY.Type.undoMuteAlertCategory||e===s.lY.Type.mutedAlertSuggestionManagementClick||e===s.lY.Type.mutedAlertSuccessShow))).subscribe((e=>{switch(e){case s.lY.Type.muteAlertCategory:t.mutedAlertsCardTurnOffButtonClick(i);break;case s.lY.Type.undoMuteAlertCategory:t.mutedAlertsTurnBackOnButtonClick(i);break;case s.lY.Type.mutedAlertSuggestionManagementClick:t.suggestionManagementClick(i);break;case s.lY.Type.mutedAlertSuccessShow:t.categoryDeactivatedShow(i)}}))},38152:(e,t,i)=>{i.d(t,{WY:()=>U,lo:()=>a});var a,s=i(57050),n=i(40327),r=i(51972),o=i(40033),l=i(73582),c=i(90361),d=i(66896),u=i(40018),p=i(70023),m=i(61903),h=i(9922),g=i(77176),f=i(95300),v=i(28043),w=i(2834),b=i(95093),_=i(32952),S=i(16782),y=i(85985),E=i(24209),k=i(78674),A=i(60797),I=i(57091),C=i(50628),M=i(66310),T=i(85089),x=i(41398),R=i(16118),F=i(35416),L=i(25975),P=i(27125),V=i(5114),O=i(8125),N=i(38983),B=i(31881);!function(e){let t;!function(e){e.clickOnEmpty="clickOnEmpty",e.clickOnFakeCard="clickOnFakeCard",e.clickOnUpgradeCard="clickOnUpgradeCard"}(t=e.Type||(e.Type={}))}(a||(a={}));class U{constructor(e,t,i,U,D,H){this._lensState=e,this._predictionsVM=t,this._upgradeViewModel=i,this._capabilities=U,this._gnar=D,this._isYellowUnderlinesExperimentActive=H,this._subs=new h.w.Keeper,this.activeAlert=this._lensState.pipe(g.U((e=>F.nL.hasCards(e)&&d.R.isMainLens(e.currentLens.id)?r.O.getActiveItemWithAlert(e.currentLens):V.none)),g.U((e=>(0,n.pipe)(e,V.fold((()=>null),(e=>e.activeAlert)))))),this.successView=N.h.combine(this._lensState,this._predictionsVM.previewState,((e,t)=>L.v.WithSuccess.State.isInSuccess(this._capabilities)(e)?t.kind===o.fA.visible?V.some(P.g.SuccessType.applied):V.some(P.g.SuccessType.small):V.none)),this._premiumAlertsCount=this._upgradeViewModel.advancedAlerts.view((0,s.ls)(V.map((e=>e.count)),V.getOrElse((()=>0)))),this.havePremiumAlerts=this._premiumAlertsCount.view((e=>e>0)),this._upgradeHookExpanded=new f.X(!1),this.upgradeHookExpanded=(0,n.pipe)(this._upgradeHookExpanded,v.x()),this.upgradeHookFlow=(0,n.pipe)((0,p.d)(this._upgradeViewModel.advancedAlerts),B.Z.extendActions(w.b((e=>{e.key===m.n.State.expanded?"upgrade"===e.action.kind?(this._upgradeViewModel.openUpgradeUrl(l.L.Place.assistantCardList),this._gnar.getPremiumButtonClick("assistantList","SeeWhatsInPremium")):"onUpgradeButtonMount"===e.action.kind&&this._onUpgradeButtonMount.next(e.action.element):e.key===m.n.State.minimized&&"onClick"===e.action.action&&(this._upgradeHookExpandReason.next("click"),this._isYellowUnderlinesExperimentActive&&this.assistantActions.next({type:a.Type.clickOnUpgradeCard}))}))),B.Z.patchState(b.T(this._minimizeUpgradeHook())),B.Z.patchState(b.T(this._autoOpenUpgradeHook())),B.Z.patchState(w.b((e=>this._onUpgradeHookShown.next(function(e){switch(e){case"hidden":return m.n.State.hidden;case"expanded":return m.n.State.expanded;case"minimized":return m.n.State.minimized;default:(0,c.vE)(e)}}(e.kind))))),B.Z.patchState(w.b((e=>this._upgradeHookExpanded.next("expanded"===e.kind))))),this.cardListContext=new f.X(V.none),this.assistantActions=new _.xQ,this.autoFocusEnabled=N.h.create(!0),this.cardListViewportHeight=N.h.create(V.none),this._onUpgradeButtonMount=new S.t,this._upgradeHookExpandReason=new S.t,this._onUpgradeHookShown=new _.xQ,this._unselectActiveAlert=this.assistantActions.pipe(y.h((e=>e.type===a.Type.clickOnEmpty||e.type===a.Type.clickOnFakeCard||!(!this._isYellowUnderlinesExperimentActive||e.type!==a.Type.clickOnUpgradeCard))),w.b((()=>this.autoFocusEnabled.set(!1))),g.U((()=>e=>e.patch({currentLens:(0,n.pipe)(F.In.getActiveItem(e.currentLens),V.fold((()=>e.currentLens),(t=>F.nL.hasItems(e)?this._capabilities.unselectItem()(e.currentLens):e.currentLens))),switchOrder:"lensOrder",alertSource:u.l$.sidebar})))),this.applicatorEffects={id:"assistantCardListViewModel.effects",when:d.R.isWithAlertsId,what:F.nL.Effect.Applicator.create(E.T(this._unselectActiveAlert))},this._subs.push(this._onUpgradeHookShown.pipe(k.b(1),v.x(),y.h((e=>e===m.n.State.minimized))).subscribe((()=>this._gnar.assistantCollapsedUpgradeHookShow())),this._onUpgradeButtonMount.pipe(A.oA,I.a(this.cardListContext.pipe(A.oA,C.P())),M.w((([e,t])=>T.n(e,{root:t}).pipe(C.P()))),y.h(O.Dw),g.U((e=>Math.trunc(100*e[0].intersectionRatio))),x.M(this._upgradeHookExpandReason,this._premiumAlertsCount)).subscribe((([e,t,i])=>this._gnar.assistantExpandedUpgradeHookShow(i,e,t))),this._lensState.pipe(y.h(F.nL.hasCards),g.U((e=>F.In.getActiveItem(e.currentLens))),R.G(),y.h((([e,t])=>V.isNone(e)&&V.isSome(t)))).subscribe((e=>{this.autoFocusEnabled.set(!0)})))}dispose(){this._subs.dispose()}_minimizeUpgradeHook(){return this.activeAlert.pipe(v.x(),x.M(this.upgradeHookExpanded),y.h((([e,t])=>!!(e&&t&&this._isYellowUnderlinesExperimentActive))),x.M(this._upgradeViewModel.advancedAlerts),g.U((([e,t])=>(0,n.pipe)(t,V.fold((()=>({kind:m.n.State.hidden})),(e=>({kind:m.n.State.minimized,alertsCount:e.count})))))))}_autoOpenUpgradeHook(){return this._lensState.pipe(y.h((e=>(0,n.pipe)(e.currentLens.id,(0,O.Kg)(d.R.isPriority,d.R.isAllAlerts)))),g.U(L.v.WithSuccess.State.isInSuccess(this._capabilities)),I.a(this.havePremiumAlerts,((e,t)=>e&&t)),v.x(),w.b((e=>{e&&this._upgradeHookExpandReason.next("alertsAddressed")})),x.M(this._upgradeViewModel.advancedAlerts),g.U((([e,t])=>(0,n.pipe)(t,V.fold((()=>({kind:m.n.State.hidden})),(t=>e?{kind:m.n.State.expanded,showCloseButton:!0,alertsState:{count:t.count,alerts:t.alerts()}}:{kind:m.n.State.minimized,alertsCount:t.count}))))))}}},51972:(e,t,i)=>{i.d(t,{O:()=>$});var a=i(57050),s=i(35214),n=i(40327),r=i(54483),o=i(31820),l=i(35108),c=i(77176),d=i(40151),u=i(2834),p=i(55415),m=i(22232),h=i(5114),g=i(16027),f=i(27378),v=i(41572),w=i(64757),b=i(61922),_=i(3656),S=i(28706),y=i(26027),E=i(15646),k=i(74754),A=i(66346),I=i(76974),C=i(5739),M=i(16314),T=i(35501),x=i(35630),R=i(32585);const F=g.UI.Node.make((({state:e,notify:t})=>{const i=f.useContext(v.m.Context);return f.createElement(C.F.Fragment,null,e.pipe(c.U((e=>(0,a.zG)(e.details,h.fold((()=>f.createElement("div",null)),(()=>f.createElement(w.zx.Tertiary,{key:"toggle-more",name:(0,A.hC)(e.visualState,i),title:(0,A.hC)(e.visualState,i),onClick:S.hz(t({type:E.eI.Kind.startTransitionTo,id:e.id,transition:{type:y.X.isCardOpen(e.visualState)?"focused":"expanded",clockwise:!0}}))},y.X.isCardOpen(e.visualState)?f.createElement(b.JO.Arrow,{key:"more",className:R.lessIcon}):f.createElement(b.JO.QuestionMark,{key:"expand"}),(0,A.hC)(e.visualState,i)))))))))})),L=g.UI.Node.make((({notify:e})=>f.createElement(w.zx.Tertiary,{name:"dismiss",title:"Dismiss",onClick:S.hz(e({type:M.Dy.ignoreButtonClick}))},f.createElement(b.JO.Ignore,null)))),P=g.UI.Node.make((({state:e})=>f.createElement(C.F.Fragment,null,e.pipe(c.U((e=>(0,a.zG)(e.details,h.fold(a.gn,(t=>f.createElement(A.G3,{key:"card-actions-details",visualState:e.visualState,className:R.more},f.createElement(_.XY,{className:R.minimalDescription,...k.y.renderToHtml(t)}))))))))))),V=g.UI.Node.make((({notify:e})=>f.createElement(w.zx.Flat,{className:R.feedbackFooter,name:"attention-score-card-open-feedback-form",onClick:S.hz(e({type:M.Dy.feedbackButtonClick}))},f.createElement("span",null,"Anything we can improve?"),f.createElement(b.JO.OpenFeedbackFormArrow,null)))),O=g.UI.Node.make((({state:e,notify:t})=>f.createElement(C.F.Fragment,null,e.pipe(c.U((e=>f.createElement(w.zx.Primary,{name:"readersAttentionItem-view-more",onClick:S.hz(t({type:M.Dy.viewMoreButtonClick,item:e})),className:R.viewMoreButton},"See suggestions"))))))),N=g.UI.Knot.make(g.UI.Grid.make((({slots:e})=>f.createElement(C.F.div,{className:x.card,"data-name":"attention-score-card-full"},e.header,f.createElement(C.F.div,{className:R.cardBody},e.content,e.details,f.createElement("div",{className:R.actions},e.viewMoreButton)),f.createElement(C.F.div,{className:R.actionsFooter},e.expandButton,e.dismissButton),e.feedbackFooter))),{header:(0,T.h)("full"),content:T.r,details:P,expandButton:F,dismissButton:L,viewMoreButton:O,feedbackFooter:V}),B=e=>g.Z.composeKnot({header:()=>e,content:()=>e.pipe(c.U((e=>({attentionScore:e.attentionScore,attentionScoreDescription:e.description})))),details:()=>e,expandButton:()=>e,dismissButton:()=>I.of(null),viewMoreButton:g.Z.fromSideEffect(a.Q1,e),feedbackFooter:()=>I.of(null)});var U=i(12187),D=i(65060),H=i(11510);const G=g.UI.Knot.make(g.UI.Grid.make((({slots:e,notify:t})=>f.createElement(C.F.div,{"data-name":"attention-score-card-mini",onClick:S.hz(t({type:M.Dy.miniCardClick,id:D.g.id})),...(0,U.Sh)(x.card,H.miniCard)},e.header))),{header:(0,T.h)("mini")}),j=e=>g.Z.composeKnot({root:g.Z.fromSideEffect(a.Q1,null),header:()=>e});var W;!function(e){const t=g.UI.Union.make("kind",{mini:G,full:N,hidden:g.UI.Node.empty}),i=e=>({mini:j(e.pipe(c.U((e=>({title:e.view.title,attentionScore:e.view.attentionScore,density:e.density}))))),full:B(e.pipe(c.U(p.ei("view")))),hidden:()=>d.E}),s=r.G.make(t);function n(e){switch(e){case"added":case"rendered":return"mini";case"focused":case"expanded":return"full";case"hidden":case"removed":return"hidden";case"presuccess":case"success":case"feedback_form":case"muted":throw new Error(`${e} is not supported for ReadersAttentionCard`);default:(0,m.vE)(e)}}e.Card=g.UI.Node.make((({state:e,notify:t})=>g.UI.mount(s,(0,a.zG)(o.g.flow(e.pipe(c.U(p.ei("view"))),(0,a.zG)((e=>g.Z.composeUnion(i(e),(()=>e.pipe(c.U((e=>({kind:n(e.view.visualState.transition.type)})))))))(e),g.Z.extendActions(u.b((e=>t(e.action.action)())))),(e=>g.Z.composeUnion(i(e),(()=>e.pipe(c.U((e=>({kind:(0,a.zG)(e.view.visualState.from,h.fold((()=>"mini"),n))})))))))(e),p.ei("id"),l.CE.toOption(l.a)),o.g.extend((e=>t(e)()))))))}(W||(W={}));var z=i(48521),q=i(16892);const Z=e=>t=>({...t,positionState:e}),K=e=>t=>({...t,visualState:e});var $,X=i(66896),Y=i(22373),Q=i(7910),J=i(49978),ee=i(84974),te=i(98752),ie=i(17594),ae=i(91549),se=i(20594),ne=i(86775),re=i(77610),oe=i(15215),le=i(70100),ce=i(47306),de=i(35416),ue=i(25975),pe=i(8125),me=i(83078),he=i(73975),ge=i(45701),fe=i(31881);!function(e){function t(e,t,i,a,s){return de.nL.Items.mapper((e=>e.kind),{[y.X.Kind]:e,[ae.R.Kind]:t,[le.X.kind]:i,[ce.J.kind]:a,[D.g.kind]:s})}function i(e){return e.kind===y.X.Kind}function r(e){return e.kind===ae.R.Kind}function o(e){return i(e)&&re.C.isEthicalAIItem(e)}function l(e){return r(e)&&re.C.isEthicalAIItem(e)}function c(e,i){return{viewState:(a,s)=>t((t=>({view:t,isLastCard:a,kind:"alertCard",visibleViewportHeight:e(s)})),(t=>({view:t,isLastCard:a,kind:"alertsBundle",visibleViewportHeight:e(s)})),(e=>({view:e,kind:"checklistItemEmpty"})),(t=>({view:t,kind:"checklistItemWithAlerts",isLastCard:a,visibleViewportHeight:e(s)})),(e=>({density:i()===X.R.SpecialId.AllAlerts?"normal":"compact",view:e,kind:"readersAttentionItem"})))}}e.isSelectableWithAlertItem=(0,pe.Kg)(i,r,oe.d.isChecklistItemWithAlerts),e.getActiveItemWithAlert=de.In.getActiveItemOfType(e.isSelectableWithAlertItem),e.getActiveAlignableItem=de.In.getActiveItemOfType(e.isSelectableWithAlertItem),e.getActiveFocusableItem=de.In.getActiveItemOfType(e.isSelectableWithAlertItem),e.checksFeedItemsMapper=t,e.isAlertCard=i,e.isAlertsBundle=r,e.isEthicalAIAlertCard=o,e.isEthicalAIAlertsBundle=l,e.defaultOrd=(0,s.fold)(ge.getMonoid())([(0,n.pipe)(ge.ordBoolean,ge.contramap((0,pe.ff)(o))),(0,n.pipe)(ge.ordBoolean,ge.contramap(D.m)),ge.fromCompare(((e,t)=>i(e)&&i(t)?y.X.ord.compare(e,t):0))]),e.bundlesOrd=(0,s.fold)(ge.getMonoid())([(0,n.pipe)(ge.ordBoolean,ge.contramap((0,pe.ff)(l))),(0,n.pipe)(ge.ordBoolean,ge.contramap(D.m)),ge.fromCompare(((e,t)=>r(e)&&r(t)?ae.R.ord.compare(e,t):0))]),e.item=e=>fe.UI.Union.make("kind",{alertCard:Y.p.Card(e),alertsBundle:J.Q.Card(e),checklistItemEmpty:ee.z.Card(e),checklistItemWithAlerts:te.fw.Card(e),readersAttentionItem:W.Card}),e.viewState=c,e.createCardListFlow=e=>(0,Q.sJ)((t=>(0,n.pipe)(e,me.bw((e=>e.actions.next(t.action)))))),e.listItemOrd=e=>ge.contramap((e=>e.cell.item.view))(e).compare;const d={equals:(e,t)=>e.kind===t.kind&&q.s.eqById.equals(e,t)},u=(e,t,i,a,s)=>({equals:(n,r)=>{const o={[y.X.Kind]:e,[ae.R.Kind]:t,[le.X.kind]:i,[ce.J.kind]:a,[D.g.kind]:s};return d.equals(n,r)&&function(e,t){return(i,a)=>t[e(i)].equals(i,a)}((e=>e.kind),o)(n,r)}}),p=(0,s.fold)(he.uZ())([z.o.eq,q.s.verticalPositionEq,d]);function m(e,i){const a=y.X.Capabilities.getChangePosition(e);return{changePosition:e=>t(a.changePosition(e),ae.R.changePosition(e),le.X.changePositionState(e),i.changePositionState(e),Z(e))}}function g(e,i,a){const s=y.X.Capabilities.getAnimatable(e),n=ae.R.Capabilities.getAnimatable(a);return{completeTransition:e=>{return t(s.completeTransition(e),n.completeTransition(e),le.X.completeTransition(e),i.completeTransition(e),(a=e,e=>({...e,visualState:z.o.VisualState.complete(e.visualState,a)})));var a},transitionTo:e=>t(s.transitionTo(e),n.transitionTo(e),le.X.transitionTo(e),i.transitionTo(e),(e=>t=>({...t,visualState:z.o.VisualState.to(t.visualState,e)}))(e)),changeVisualState:e=>t(s.changeVisualState(e),n.changeVisualState(e),le.X.changeVisualState(e),i.changeVisualState(e),K(e))}}function f(e,i,s,r,o){const l=ae.R.getCardHydrator(o),c=ae.R.getSelect(s,r,l),d=ae.R.getSelectByAlert(s,r,l),u=y.X.Capabilities.getSelect(e);return{select:(e,s)=>t(u.select(e,s),c(e,s),le.X.select(e),i.selectFirstAlert((0,a.MZ)(e),s),function(e,t){return i=>{const s=(0,n.pipe)(e,h.map((e=>t.compare(i,e)>0)),h.getOrElse(a.W8)),r=(0,n.pipe)(e,h.exists((e=>e.id===i.id))),o=r&&y.X.isCardOpen(i.visualState)?"expanded":"focused",l=(0,n.pipe)(e,h.fold((()=>z.o.VisualState.initial({type:o,clockwise:s})),(e=>z.o.VisualState.to(i.visualState,{type:o,clockwise:s}))));return(0,n.pipe)(i,r?a.yR:Z(q.s.PositionState.invalidateHeight(i.positionState)),K(l))}}(e,s)),selectByAlert:(e,s,n)=>t(u.selectByAlert(e,s,n),d(s,e,n),le.X.select(e),i.selectByAlert(s,(0,a.MZ)(e),n),a.yR),unselect:(e,s)=>t(u.unselect((0,a.MZ)(e),s),ae.R.unselect((0,a.MZ)(e),s),le.X.unselect(e),i.unselect((0,a.MZ)(e),s),function(e,t){return i=>{const s=(0,n.pipe)(e,h.map((e=>t.compare(i,e)>0)),h.getOrElse(a.W8)),r=(0,n.pipe)(e,h.exists((e=>e.id===i.id)));return(0,n.pipe)(i,r?a.yR:Z(q.s.PositionState.invalidateHeight(i.positionState)),z.o.isHidden(i)?a.yR:K(z.o.VisualState.to(i.visualState,{type:"rendered",clockwise:s})))}}(e,s))}}function v(e,s,n,o,l,c){return{removeAlertFromItem:(d,u)=>t((t=>y.X.Capabilities.getRemoveAlerts(e,u.itemsOrd)(d,de.In.getActiveItemOfType(i)(u))(t)),(e=>ae.R.Capabilities.getRemoveAlertsCapability(o,l,c,u.itemsOrd)(d,de.In.getActiveItemOfType(r)(u))(e)),a.yR,(e=>ne.G.getRemoveAlert(s,n,o).removeAlertFromItem(d,u)(e)),a.yR)}}function w(e,i,s,n){const r=y.X.Capabilities.getRemove(e);return{remove:(e,o)=>t(r.remove(e,o),(t=>e(t)?ae.R.Capabilities.getRemove(s,n)([t.activeAlert],o(t))(t):t),a.yR,(t=>e(t)?i.removeAlerts(t.alerts,o(t))(t):t),a.yR)}}function b(e,i,s,n){const r=y.X.Capabilities.getUpdateWithAlert(e),o=ae.R.Capabilities.getUpdatableWithAlertsCapability(i,n);return{updateWithAlerts:e=>t(r.updateWithAlerts(e),o(e),a.yR,s.updateWith(e),a.yR)}}e.equatable={structEq:u(y.X.eq,ae.R.eq,le.X.eq,ce.J.eq,D.g.eq),idEq:u(d,d,d,d,d),visualStateEq:u(p,p,p,p,p)},e.changePosition=m,e.disposable={isScheduledToDispose:t((e=>re.C.willBeDisposed(e,e.removedAlertsIds)),(e=>re.C.willBeDisposed(e,e.removedAlertsIds)),a.jv,(e=>re.C.willBeDisposed(e,e.removedAlertsIds)),a.jv)},e.hidable={isHidden:t(z.o.isHidden,z.o.isHidden,z.o.isHidden,z.o.isHidden,z.o.isHidden)},e.animatableItem=g,e.hasAlertsQueries={isSelectableByAlert:e=>t(re.C.hasAlert(e.alert.id),re.C.hasAlert(e.alert.id),a.jv,re.C.hasAlert(e.alert.id),a.jv),hasAlert:e=>t(re.C.hasAlert(e),re.C.hasAlert(e),a.jv,re.C.hasAlert(e),a.jv),hasActiveAlert:t(re.C.hasActiveAlert,re.C.hasActiveAlert,(()=>h.none),re.C.hasActiveAlert,(()=>h.none))},e.changePositionStrategyQueries={useReferenceHeightOnRemove:t(a.jv,a.jv,a.jv,a.W8,a.jv)},e.select=f,e.removeAlert=v,e.remove=w,e.updateWithAlert=b,e.releaseAlert=(t,i,a,s,n,r)=>ue.v.Capabilities.getAlertReleaser({...v(t,i,a,s,n,r),...e.disposable}),e.unselectable=(e,t,i,a,s)=>ue.v.Capabilities.getUnselectable(de.In.getActiveItem,f(e,t,i,a,s)),e.selectableByAlert=(t,i,a,s,n)=>ue.v.Capabilities.getSelectableByAlert(de.In.getActiveItem,{...e.hasAlertsQueries,...f(t,i,a,s,n),...ue.v.Capabilities.getHasChecksFeed()}),e.selectableById=(e,t,i,a,s)=>ue.v.Capabilities.getSelectableById(de.In.getActiveItem,f(e,t,i,a,s)),e.updateMeta=()=>({updateMeta:ue.v.Capabilities.getMetaUpdatable().updateMeta}),e.animatableFeed=(e,t,i,a,s,n)=>ue.v.Capabilities.getAnimatable(e,{...v(e,t,i,a,s,n),...g(e,t,n),...ue.v.Capabilities.getHasChecksFeed()}),e.hasPriorityToggle=(t,i,a)=>ue.v.WithPriority.getHasPriorityToggle({...g(t,i,a),...e.hasAlertsQueries,...e.disposable});const _=t=>["focused","expanded"].includes(t.visualState.transition.type)&&!e.disposable.isScheduledToDispose(t);function S(e,i){const a=se.Mq.getCardSelections(i);return{nextAlert:t(a.nextAlert,a.nextAlert,(()=>h.none),e.nextAlert,(()=>h.none)),prevAlert:t(a.prevAlert,a.prevAlert,(()=>h.none),e.prevAlert,(()=>h.none))}}function E(){return{updateUserInput:e=>t(y.X.updateUserInput(e),ae.R.changeUserInput(e),a.yR,a.yR,a.yR)}}e.alignable={isValidToAlign:t(_,_,a.jv,_,a.jv)},e.alertIterator=S,e.itemReleaser=(e,t,i)=>ne.G.getItemReleaser(e,t,i,ue.v.Capabilities.getItemReleaser()),e.hasAlerts=ue.v.Capabilities.getHasAlerts,e.getDefaultNextAlertItemFilter=t=>(0,pe.W9)(e.isSelectableWithAlertItem,(i=>!e.disposable.isScheduledToDispose(i)&&(0,n.pipe)(i,e.hasAlertsQueries.hasActiveAlert,h.map((e=>t.isRegistered(e.alert.id))),h.getOrElse(a.jv)))),e.hasUserInput=E,e.priorityTest=(0,pe.W9)(i,(e=>ie.$.isPriority(e.activeAlert))),e.verifiable=()=>ue.v.Capabilities.getVerifiable(e.disposable),e.cloneable=()=>{const e=q.s.Capabilities.getPojoCloneable().clone;return{clone:t(y.X.Capabilities.getCloneable().clone,e,e,e,e)}},e.getCapabilities=function(t,i,s,n,r,o,l,d=(0,a.a9)(h.none),u=se.IG.Default){return{...c(d,l),...e.disposable,...e.hidable,...e.equatable,...E(),...e.cloneable(),...m(t,s),...g(t,s,r),...f(t,s,n,u,r),...w(t,s,u,r),...v(t,s,o,n,u,r),...b(t,i,s,r),...e.hasAlertsQueries,...e.changePositionStrategyQueries,...e.alignable,...e.releaseAlert(t,s,o,n,u,r),...e.unselectable(t,s,n,u,r),...e.selectableByAlert(t,s,n,u,r),...e.selectableById(t,s,n,u,r),...e.updateMeta(t),...e.animatableFeed(t,s,o,n,u,r),...e.hasPriorityToggle(t,s,r),...e.itemReleaser(s,o,n),...e.verifiable(),...e.cloneable(),...e.hasAlerts(S(s,n),n,(()=>e.isSelectableWithAlertItem),{...e.hasAlertsQueries,...e.disposable})}}}($||($={}))},5178:(e,t,i)=>{i.d(t,{Q:()=>a,_:()=>r});var a,s=i(75003),n=i(53844);!function(e){e.readersAttention="readers_attention",e.settings="settings"}(a||(a={}));class r{constructor(e,t,i){this._assistantLayoutViewModel=e,this._domain=t,this._gnar=i,this._entryPoint=void 0}getDomain(){return this._domain}openFeedback(e){this._entryPoint=e,this._gnar.assistantFeedbackButtonClick(this._entryPoint),this._assistantLayoutViewModel.pushActiveView({type:s.a.Type.feedback})}submitFeedback(e){this._entryPoint&&this._gnar.assistantFeedbackSubmitButtonClick(this._entryPoint,e.domain,e.text,(0,n.dK)(e)?e.score:void 0)}}},19654:(e,t,i)=>{i.d(t,{B:()=>a});var a,s=i(92783),n=i(15787);!function(e){e.shouldShow=e=>{var t;return!!(null===(t=e.institutionInfo)||void 0===t?void 0:t.voxEnabled)};const t=e=>({onShow:t=>e.gbPromptFormShow(t),onAccept:t=>e.gbPromptAcceptClick(t),onDismiss:t=>e.gbPromptDismissClick(t)});e.getCardsViewModelSendToURLExperiment=(e,i)=>({handleGbPrompt:n.sU.Experiments.handleGbPrompt(e,{account:{styleGuide:(0,s.Um)().styleGuideSettings,writingStyle:(0,s.Um)().writingStyleSettings}},t(i))})}(a||(a={}))},75003:(e,t,i)=>{i.d(t,{D:()=>d,a:()=>a});var a,s=i(7309),n=i(70026),r=i(90361),o=i(14601),l=i(78674),c=i(85985);!function(e){let t,i;!function(e){e.default="default",e.emogenie="emogenie",e.readersAttention="readersAttention",e.readersAttentionHelp="readersAttentionHelp",e.feedback="feedback",e.settings="settings",e.proofitRequest="proofitRequest",e.proofitReview="proofitReview",e.startupPlaceholder="startupPlaceholder"}(t=e.Type||(e.Type={})),function(e){let t;!function(e){let t;!function(e){e.predictionWidget="predictionWidget",e.navigation="navigation",e.readersAttentionItem="readersAttentionItem"}(t=e.Type||(e.Type={}))}(t=e.Caller||(e.Caller={}))}(i=e.ReadersAttention||(e.ReadersAttention={})),e.isDefault=function(t){return t.type===e.Type.default},e.isEmogenie=function(t){return t.type===e.Type.emogenie},e.isReadersAttention=function(t){return t.type===e.Type.readersAttention},e.isReadersAttentionHelp=function(t){return t.type===e.Type.readersAttentionHelp},e.isFeedback=function(t){return t.type===e.Type.feedback},e.isSettings=function(t){return t.type===e.Type.settings},e.isProofitRequest=function(t){return t.type===e.Type.proofitRequest},e.isProofitReview=function(t){return t.type===e.Type.proofitReview}}(a||(a={}));class d extends n.A{constructor(e,t,i,n,d=s.V.defaultLayout){super({type:a.Type.startupPlaceholder},{type:a.Type.default}),this.browser=n,this.layout=d,this._sub=new o.w,this._sub.add(t.subscribe((e=>{if(e.length>0)for(;!this.activeViewHasAlerts();)this.popActiveView()})));const u=new Set([a.Type.readersAttention,a.Type.emogenie]);this._sub.add(i.pipe(l.b(100),c.h(r.fQ)).subscribe((()=>{if(u.has(this._activeView.get().type))for(;this._activeView.get().type!==this._defaultView.type;)this.popActiveView()}))),this._sub.add(this._activeView.subscribe((t=>{switch(t.type){case a.Type.settings:return void e.assistantSettingsShow();case a.Type.proofitRequest:return void e.proofitRequestFormShow();default:return}})))}activeViewHasAlerts(){switch(this._activeView.get().type){case a.Type.default:case a.Type.emogenie:case a.Type.readersAttention:return!0;default:return!1}}popActiveView(){const e=this._viewHistory.pop()||this._defaultView;e.type===a.Type.readersAttention?this._activeView.set({...e,caller:{type:a.ReadersAttention.Caller.Type.navigation}}):this._activeView.set(e)}get isHeaderNavigationEnabled(){return this._activeView.view((e=>e.type!==a.Type.feedback))}dispose(){this._sub.unsubscribe()}}},59456:(e,t,i)=>{i.d(t,{W:()=>s});var a=i(63919);const s=e=>{const t=e.initialPositionOffset.get();return{initialPositionOffset:t,onDrag:i=>{e.updateInitialPositionOffset(a.E9.plus(t,a.E9.fromCartesian(i.translate)))}}}},19043:(e,t,i)=>{i.d(t,{S:()=>u});var a=i(77843),s=i(28043),n=i(16118),r=i(41398),o=i(85985),l=i(2768),c=i(75003),d=i(10247);class u{constructor(e,t,i,a){this.feature=t,this._closeAssistant=i,this._gnar=a,this._subs=[],this._subs.push(this.feature.requestInfo.view("status").pipe((0,s.x)(),(0,n.G)(),(0,r.M)(e.activeView)).subscribe((([[t,i],a])=>{t===d.eE.REVIEWING&&a.type===c.a.Type.proofitReview&&e.popActiveView()}))),this._subs.push(this.feature.layoutCreated.pipe((0,r.M)(e.activeView)).subscribe((([t,i])=>{i.type!==c.a.Type.proofitRequest&&i.type!==c.a.Type.proofitReview||t||e.popActiveView()})))}onSubmitRequest(e){this.feature.submitRequest(),this._gnar.proofitRequestFormSubmit();const t=this.feature.requestInfo.lens("status").pipe((0,o.h)((e=>e===d.eE.ACCEPTED)));(0,a.F)(100).pipe((0,l.R)(t)).subscribe({complete:()=>this._closeAssistant(e)})}onCompleteRequest(e){this.feature.resetRequest(),this._gnar.proofitOrderDone(),this._closeAssistant(e)}onSubmitFeedback(e){this._gnar.proofitFeedbackFormSubmit(e.text,e.score)}dispose(){this._subs.forEach((e=>e.unsubscribe()))}}},41354:(e,t,i)=>{i.d(t,{d:()=>_,X:()=>G});var a=i(17771),s=i(57050),n=i(26328),r=i(40327),o=i(75003),l=i(40018),c=i(4390),d=i(93508),u=i(16118),p=i(77176),m=i(85985),h=i(66310),g=i(12126),f=i(40151),v=i(92843),w=i(5114),b=i(71249);var _,S=i(90361),y=i(66896),E=i(98403),k=i(19751),A=i(14601),I=i(28043),C=i(34383),M=i(15215),T=i(35416),x=i(83078),R=i(73975),F=i(38983),L=i(17889),P=i(32243),V=i(86718);function O(e,t){return F.h.combine(e.panelInfo.view(w.map((e=>({items:e.checklist,wordsCount:e.wordsCount})))),t,((e,t)=>{const i=c.p.reduce(new Map,((e,t)=>{return(0,s.zG)((i=t,(0,s.zG)(i.alert.extraProperties.takeawayBundleId,w.map(C.T.Id.create))),w.fold((()=>e),(i=>e.set(i,(e.get(i)||[]).concat([t])))));var i}))(t);return(0,s.zG)(e,w.fold((()=>new Map),(e=>new Map(P.AO(e.items).map((([t,a])=>[C.T.Id.create(t),B(a,e.wordsCount,i)]))))))}))}function N(e){return l.bZ.isTakeaway(e)&&e.takeawayIsLikelyToBeRead&&x.FX(l.TO.correctlyDetected)(e.takeawayFeedback)}function B(e,t,i){const a=C.T.Id.create(e.id),n=(i.get(a)||[]).map((e=>e.alert)),r=(0,s.zG)(n,b.hX((e=>!l.bZ.isTakeaway(e)||w.isNone(e.takeawayFeedback)||x.FX(l.TO.correctlyDetected)(e.takeawayFeedback))),(e=>e.every(N)?[]:e),L.nI);return{id:a,rank:e.rank,suggestionsView:(0,s.zG)(e.suggestionsCard,w.chain((e=>(0,s.zG)(r,w.map((t=>({title:e.title,miniTitle:e.miniTitle,miniLabel:w.none,alertIds:(0,s.zG)(t,(0,L.UI)((e=>e.id)))}))))))),emptyView:{checked:e.defaultCard.checked,title:e.defaultCard.title,miniTitle:e.defaultCard.miniTitle,miniLabel:"textLength"===e.defaultCard.kind?w.some(`${t} words`):w.none,card:U(e,t)}}}function U(e,t){const i="simple"===e.defaultCard.kind?V.f.Kind.simple:"textLength"===e.defaultCard.kind?V.f.Kind.textLength:(0,S.vE)(e.defaultCard.kind);return i===V.f.Kind.simple?{kind:i,explanation:e.defaultCard.description,details:e.defaultCard.details}:{kind:i,explanation:e.defaultCard.description,details:e.defaultCard.details,wordCount:t}}function D(e){return w.isNone(e.suggestionsView)&&e.emptyView.checked}function H(e){return o.a.isReadersAttention(e)||o.a.isReadersAttentionHelp(e)}!function(e){e.ok="ok",e.warning="warning",e.feedback="feedback"}(_||(_={}));class G{constructor(e,t,i,o,S){this._readersAttentionFeature=e,this._assistantLayoutVM=t,this._alertsCollection=i,this._alertsReader=o,this._assistantLensState=S,this._subs=new A.w,this._checklist=F.h.create(C.D.empty()),this.checklist=this._checklist.view(),this.panelState=(0,r.pipe)(this._readersAttentionFeature,w.fold((()=>F.h.create(w.none)),(e=>F.h.combine(e.panelInfo,this._checklist,((e,t)=>(0,r.pipe)(e,w.map((e=>({attentionScore:e.attentionScore,attentionScoreDescription:e.attentionScoreDescription,headerMessage:e.headerMessage,numChecklistItemsChecked:Array.from(t.values()).reduce(((e,t)=>D(t)?e+1:e),0),numChecklistItems:t.size}))))))))),this.predictionCardState=(0,r.pipe)(this._readersAttentionFeature,w.fold((()=>F.h.create(w.none)),(e=>function(e,t,i){return F.h.combine(e.panelInfo,t,((e,t)=>(0,r.pipe)(e,w.map((e=>({message:e.predictionMessage,icon:Array.from(t.values()).every(D)?_.ok:Array.from(t.values()).every((e=>(0,r.pipe)(e.suggestionsView,w.map(function(e){return t=>(0,r.pipe)(t.alertIds,(0,n.UI)((0,s.ls)((t=>e.getById(t)),w.filter((e=>l.bZ.isTakeaway(e)&&e.takeawayIsLikelyToBeRead&&w.isNone(e.takeawayFeedback))))),b.yW(w.isSome))}(i)),w.getOrElse((()=>e.emptyView.checked)))))?_.feedback:_.warning,alertsCount:z(t)}))))))}(e,this._checklist,this._alertsReader)))),this._subs.add(this._handleHeatmapVisibilityAndNavigationTracking()),this._subs.add(this._trackChecklistItemExpand()),(0,r.pipe)(this._readersAttentionFeature,x.bw((e=>{var t;this._subs.add((t=this._alertsCollection,t.pipe(d.O(c.p.empty),u.G(),p.U((([e,t])=>(0,r.pipe)(c.p.diff(e,t),c.p.Diff.filter((e=>l.bZ.isTakeaway(e.alert)))))),m.h((0,s.ff)(v.v.isEmpty)),p.U((e=>(0,r.pipe)(e,v.v.reduce(new Map,((e,t)=>e),((e,t,i)=>l.bZ.isTakeaway(i.alert)?e.set(i.alert.id,i.alert):e),((e,t)=>l.bZ.isTakeaway(t.alert)?e.set(t.alert.id,t.alert):e))))),h.w((e=>(0,r.pipe)(Array.from(e.values()),b.UI((e=>(0,r.pipe)(a.Y(w.option)({rawId:(0,r.pipe)(e,l.bZ.getRawId),feedback:e.takeawayFeedback}),w.map((e=>({rawId:e.rawId,feedback:e.feedback})))))),b.oA,(e=>e.length>0?g.D(e):f.E)))))).subscribe((t=>{e.takeawaysFeedbackStore.registerFeedback(t.rawId,t.feedback)}))),this._subs.add(O(e,this._alertsCollection).subscribe(E.wW(this._checklist)))})))}openPanel(e){this._assistantLayoutVM.pushActiveView({type:o.a.Type.readersAttention,caller:e})}showHelp(){this._assistantLayoutVM.pushActiveView({type:o.a.Type.readersAttentionHelp}),this._trackOnShowHelp()}dispose(){H(this._assistantLayoutVM.activeView.get())&&((0,r.pipe)(this._readersAttentionFeature,x.bw((e=>e.heatmap.visible.set(!1)))),this._trackOnReadersAttentionHide()),this._subs.unsubscribe()}_handleHeatmapVisibilityAndNavigationTracking(){return this._assistantLayoutVM.activeView.pipe(I.x(((e,t)=>e.type===t.type)),d.O(null),u.G()).subscribe((([e,t])=>{(0,r.pipe)(this._readersAttentionFeature,x.bw((i=>{H(t)&&!i.heatmap.visible.get()?i.heatmap.visible.set(!0):e&&H(e)&&!H(t)&&i.heatmap.visible.get()&&i.heatmap.visible.set(!1)}))),!o.a.isReadersAttention(t)||e&&o.a.isReadersAttentionHelp(e)?!H(t)&&e&&H(e)&&this._trackOnReadersAttentionHide():this._trackOnReadersAttentionShow(t.caller)}))}_trackChecklistItemExpand(){return this._assistantLensState.pipe(p.U((e=>(0,r.pipe)(w.fromPredicate(T.nL.hasItems)(e),w.map(T.nL.Prism.getLens().get),w.filter((e=>e.id===y.R.SpecialId.PredictionTakeaways)),w.chain(T.In.getActiveItemOfType(M.d.isChecklistItem)),w.map((e=>{return{id:(t=e.id,i=y.R.SpecialId.PredictionTakeaways,C.T.Id.create(t.substr(i.length+1)||t)),title:(0,r.pipe)(e.itemMeta.miniTitle,w.getOrElse((()=>e.itemMeta.title))),checked:j(e),numAlerts:M.d.isChecklistItemWithAlerts(e)?e.alerts.length:0};var t,i}))))),k.skipBy(w.getEq(R.Uz((e=>e.id))(R.yv))),p.U(w.getOrElse(s.gn)),m.h(S.fQ)).subscribe((e=>(0,r.pipe)(this._readersAttentionFeature,x.bw((t=>t.tracking.onChecklistItemExpand(e))))))}_trackOnReadersAttentionShow(e){(0,r.pipe)(this._readersAttentionFeature,w.chain((e=>(0,r.pipe)(a.g(w.option)(e.panelInfo.get(),W(this._checklist.get())),w.map((t=>({feature:e,predictionMessage:t[0].predictionMessage,checklistInfo:t[1]})))))),x.bw((({feature:t,predictionMessage:i,checklistInfo:a})=>{t.tracking.onOpen(a,i,this._getNumAlerts(),e)})))}_trackOnReadersAttentionHide(){(0,r.pipe)(this._readersAttentionFeature,w.chain((e=>(0,r.pipe)(W(this._checklist.get()),w.map((t=>({feature:e,checklistInfo:t})))))),x.bw((({feature:e,checklistInfo:t})=>{e.tracking.onClose(t,this._getNumAlerts())})))}_trackOnShowHelp(){(0,r.pipe)(this._readersAttentionFeature,x.bw((e=>{e.tracking.onHelpScreenShow()})))}_getNumAlerts(){return(0,r.pipe)(this._alertsCollection.get(),c.p.reduce({takeaway:0,nonTakeaway:0},((e,t)=>{const i=l.bZ.isTakeaway(t.alert),a=l.bZ.belongsToPredictionTakeaways(t.alert)&&!i;return{takeaway:e.takeaway+(i?1:0),nonTakeaway:e.nonTakeaway+(a?1:0)}})))}}function j(e){return M.d.isChecklistItemEmpty(e)&&e.itemMeta.checked}function W(e){const t=Array.from(e.values()).sort(((e,t)=>e.rank-t.rank));return(0,r.pipe)(t.map((e=>({checked:D(e),message:(0,r.pipe)(e.suggestionsView,w.map((e=>(0,r.pipe)(e.miniTitle,w.getOrElse((()=>e.title))))),w.getOrElse((()=>(0,r.pipe)(e.emptyView.miniTitle,w.getOrElse((()=>e.emptyView.title))))))}))),n.nI)}function z(e){return(0,r.pipe)(Array.from(e.values()),b.u4(0,((e,t)=>e+(0,r.pipe)(t.suggestionsView,w.map((e=>e.alertIds.length)),w.getOrElse((()=>0))))))}},31536:(e,t,i)=>{i.d(t,{X:()=>a});class a{constructor(e,t,i,a){this._contentScriptState=e,this._contentScriptActions=t,this._dapiActions=i,this.domain=a,this.state=this._contentScriptState.view((e=>({user:e.user,page:e.page,dynamicConfig:e.dynamicConfig,dapi:e.dapi}))),this.actions={toggleSite:(e,t)=>{this._contentScriptActions.toggleSite({enabled:e,domain:t})},toggleDefs:e=>{this._contentScriptActions.toggleDefs(e)},toggleAutocomplete:e=>{this._contentScriptActions.toggleAutocomplete(e)},toggleAutocorrect:e=>{this._contentScriptActions.toggleAutocorrect(e)},toggleReader:e=>{this._contentScriptActions.toggleReader(e)},toggleCitationBuilderForDomain:e=>{this._contentScriptActions.toggleCitationBuilderForDomain(e)},changeStrongDialect:e=>{this._dapiActions.changeStrongDialect(e)},setDesktopIntegration:e=>{this._contentScriptActions.setDesktopIntegration(e)},setEmogenieEmojiState:e=>{this._dapiActions.setEmogenieEmojiState(e)},toggleKnowledgeHub:e=>{this._contentScriptActions.toggleKnowledgeHub(e)}}}}},40033:(e,t,i)=>{i.d(t,{fA:()=>u,pL:()=>y});var a=i(40327),s=i(27378),n=i(41354),r=i(79921),o=i(19217);const l=({message:e,emoji:t,emojiId:i,icon:a,iconPartName:n})=>s.createElement("div",{className:o.insight},t&&i&&s.createElement("div",{className:o.insight__inline_icon},s.createElement(r.dy,{unicodeHexArray:[i],unicodeLiteral:t})),a&&s.createElement("div",{className:o.insight__inline_icon,"data-grammarly-part":n},a),s.createElement("div",{className:o.insight__inline_text},e));var c=i(25262);const d=()=>s.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16Z",fill:c.Z.red50}),s.createElement("path",{d:"M8.94827 4H7.05196L7.22242 10.1108H8.78208L8.94827 4ZM8.00225 12.8381C8.5477 12.8381 9.02071 12.3821 9.02498 11.8153C9.02071 11.2571 8.5477 10.8011 8.00225 10.8011C7.43975 10.8011 6.97526 11.2571 6.97952 11.8153C6.97526 12.3821 7.43975 12.8381 8.00225 12.8381Z",fill:c.Z.neutral0}));var u,p=i(46547),m=i(88326),h=i(90361),g=i(61922),f=i(3656),v=i(77176),w=i(18208),b=i(5739),_=i(31881),S=i(98029);!function(e){e.hidden="hidden",e.zero="zero",e.visible="visible"}(u||(u={}));const y=({predictionsVM:e})=>_.UI.mount(M,e.previewFlow),E=_.UI.Grid.make((({slots:e})=>s.createElement("div",{className:S.predictions},s.createElement("div",{className:S.predictions__header},"Predictions"),e.children))),k=({children:e,count:t,dataPartName:i})=>s.createElement(p.Z,{kind:"assistant-priority-lens",dataPartName:i,marginBottom:"12px"},s.createElement("div",{className:S.predictions__card},e,t>0&&s.createElement("div",{className:S.counterContainer},s.createElement(f.CL,null,t)))),A=_.UI.Node.make((({state:e,notify:t})=>s.createElement(m.M,{clickHandler:t("select")},s.createElement(b.F.Fragment,null,e.pipe(v.U((e=>s.createElement(k,{count:e.alertsCount,dataPartName:"emogenie-prediction-card"},s.createElement(l,{key:"tone",message:"off"===e.emotion.brandToneLabel?s.createElement(s.Fragment,null,"May sound ",s.createElement("span",{className:S.predictions__off_brand},"off-brand")):`Sounds ${e.emotion.name}`,emoji:e.emotion.emoji,emojiId:e.emotion.emojiId}))))))))),I=_.UI.Node.make((({state:e,notify:t})=>s.createElement(m.M,{clickHandler:t("select")},s.createElement(b.F.Fragment,null,e.pipe(v.U((e=>s.createElement(k,{count:e.alertsCount,dataPartName:"readers-attention-prediction-card"},s.createElement(l,{key:"readersAttention",message:w.kC(e.message),icon:e.icon===n.d.ok?s.createElement(g.JO.ValidationOk,{width:16}):e.icon===n.d.warning?s.createElement(d,null):e.icon===n.d.feedback?s.createElement(g.JO.Megaphone,{width:16}):(0,h.vE)(e.icon),iconPartName:e.icon===n.d.ok?"icon-ok":e.icon===n.d.warning?"icon-warning":e.icon===n.d.feedback?"icon-feedback":(0,h.vE)(e.icon)}))))))))),C=_.UI.Group.make({tone:T(A),readersAttention:T(I)}),M=_.UI.Union.make("kind",{[u.hidden]:_.UI.Node.empty,[u.zero]:_.UI.Node.empty,[u.visible]:_.UI.Composite.make(E,C)});function T(e){return{tag:"_tag",members:{Some:(0,a.pipe)(e,_.UI.contramapState((e=>e.value))),None:_.UI.Node.empty}}}},15090:(e,t,i)=>{i.d(t,{g:()=>a});var a,s=i(40327),n=i(85985),r=i(15646),o=i(83078);!function(e){e.createSubscription=function(e,t,i){return e.pipe(n.h(r.lY.isAlertApplyAction)).subscribe((e=>(0,s.pipe)(i(e.alertId),o.bw((e=>{"unlocked"===o.Fc(e.extraProperties.freePremium)&&t.freePremiumSuggestionAcceptButtonClick("assistant")})))))}}(a||(a={}))},45662:(e,t,i)=>{i.d(t,{c:()=>s});var a=i(41186);class s{constructor(e){this._highlights=e}addHighlight(e,t,i){return this._highlights.addHighlight(e,t,i)}updateHighlight(e,t,i){return this._highlights.updateHighlight(e,t,i)}removeHighlights(e){return this._highlights.removeHighlights(e)}recalculateHighlight(e){return this._highlights.recalculateHighlight(e)}recalculateAllHighlights(){return this._highlights.recalculateAllHighlights()}maintainConsistency(e,t=(e=>e),i=!1){return this._highlights.maintainConsistency(e,t,i)}hasHighlight(e){return this._highlights.hasHighlight(e)}getSelectedHighlightsTracker(e){return(0,a.H)({...e,highlights:this._highlights})}getGeometryByHighlightId(e){return this._highlights.geometry.get().get(e)}}},65060:(e,t,i)=>{i.d(t,{g:()=>a,m:()=>p});var a,s=i(57050),n=i(48439),r=i(36156),o=i(16892),l=i(48521),c=i(4890),d=i(73975),u=i(5114);function p(e){return e.id===a.id}!function(e){e.id="ReadersAttentionItemId",e.kind="ReadersAttentionItem",e.eq=d.f7(((e,t)=>e.hashCode()===t.hashCode()&&o.s.PositionState.eq.equals(e.positionState,t.positionState)&&l.o.VisualState.eq.equals(e.visualState,t.visualState))),e.hashCodeOwnFields=e=>(0,r.NO)({title:e.title,description:e.description,details:(0,s.zG)(e.details,u.fold((()=>"none"),(e=>`some(${e})`))),attentionScore:n.T.prism.reverseGet(e.attentionScore)}),e.hashCode=e.hashCodeOwnFields,e.create=function(t,i,a){return{id:e.id,kind:e.kind,renderOptions:{...c.j.defaultOptions,layoutDensity:c.j.Density.minimal},positionState:i,visualState:a,title:t.title,description:t.description,details:t.details,attentionScore:t.attentionScore,equals(t){return e.eq.equals(this,t)},hashCode(){return e.hashCode(this)}}}}(a||(a={}))},16314:(e,t,i)=>{var a;function s(e){return e.type===a.miniCardClick}function n(e){return e.type===a.ignoreButtonClick}function r(e){return e.type===a.viewMoreButtonClick}function o(e){return e.type===a.feedbackButtonClick}i.d(t,{Dy:()=>a,Q:()=>r,RJ:()=>o,Vl:()=>s,l9:()=>n}),function(e){e.miniCardClick="readersAttentionItemMiniCardClick",e.ignoreButtonClick="readersAttentionItemIgnoreButtonClick",e.viewMoreButtonClick="readersAttentionItemViewMoreButtonClick",e.feedbackButtonClick="readersAttentionItemFeedbackButtonClick"}(a||(a={}))},35501:(e,t,i)=>{i.d(t,{h:()=>h,r:()=>g});var a=i(27378),s=i(76457),n=i(3656),r=i(77176),o=i(48439),l=i(8125),c=i(5739),d=i(12187),u=i(16027),p=i(35630);const m=({progress:e})=>a.createElement(c.F.Fragment,null,e.pipe(r.U((e=>a.createElement(s.P,{percentage:o.g.prism.reverseGet(e),colorType:s.P.ColorType.neoBlue,iconSize:s.P.IconSize.extraSmall,theme:{radialProgressBar:p.circleProgress,radialProgressText:p.circleText}}))))),h=e=>u.UI.Node.make((({view:t})=>a.createElement(c.F.div,{...(0,d.Sh)(p.header,t("density").pipe(r.U((e=>"normal"===e)),r.U((0,l.RN)(p.normal,p.compact))))},a.createElement("div",{className:p.progressIcon},a.createElement(m,{progress:t("attentionScore").pipe(r.U(o.g.fromRatio))})),a.createElement(n.XY,{...(0,d.Sh)(p.title,"full"===e?p.full:void 0)},t("title"))))),g=u.UI.Node.make((({view:e})=>a.createElement(a.Fragment,null,a.createElement("div",{className:p.progressContainer,"data-name":"attention-score-progress-bar"},a.createElement(c.F.div,{className:p.progressBar,style:{width:e("attentionScore").pipe(r.U(o.g.fromRatio),r.U(o.g.prism.reverseGet),r.U((e=>`${e}%`)))}},a.createElement(n.XY,{className:p.progressValue,"data-name":"attention-score-progress-value"},e("attentionScore").pipe(r.U(o.g.fromRatio),r.U(o.g.prism.reverseGet),r.U((e=>`${e}%`)))))),a.createElement(n.XY,{className:p.description},e("attentionScoreDescription")))))},70026:(e,t,i)=>{i.d(t,{A:()=>s});var a=i(38983);class s{constructor(e,t){this._viewHistory=[],this._startupPlaceHolder=e,this._activeView=a.h.create(this._startupPlaceHolder),this._defaultView=t}get activeView(){return this._activeView.view()}get lastView(){return this._viewHistory[this._viewHistory.length-1]||this._defaultView}pushActiveView(e){const t=this._activeView.get();e.type!==t.type&&(t.type!==this._startupPlaceHolder.type&&this._viewHistory.push(t),this._activeView.set(e))}popActiveView(){const e=this._viewHistory.pop()||this._defaultView;this._activeView.set(e)}replaceActiveView(e){e.type!==this._activeView.get().type&&this._activeView.set(e)}}},84286:(e,t,i)=>{i.d(t,{D:()=>s,f:()=>a});var a,s,n=i(40327),r=i(64015),o=i(15646),l=i(5114),c=i(28811),d=i(26393),u=i(79880);!function(e){e.create=function(e){return{type:o.lY.Type.sduiCardAction,sourceId:"native",cardId:"",actions:e,scope:{alertRef:l.none}}}}(a||(a={})),function(e){function t(e,t){return c.a.find((e=>e.id.toString()===t))(e)}let i,a,s,o,p,m,h;e.getById=t,e.getByAlertId=function(e,t){return c.a.find((e=>{const i=d.a.getAllAlertIds(e.content);return 1===i.length&&i[0]===t}))(e)},function(e){function t(e){return"strongAlertRef"===e.type}function i(e){var i;return t(e)&&"known"===(null===(i=e.name)||void 0===i?void 0:i.kind)&&e.name.value===u.MU.StrongAlertRefBulkDismiss}function a(e){return c.a.find((e=>i(e.content)))(e)}e.isStrongAlertRefContent=t,e.isStrongAlertRefBulkDismissContent=i,e.findStrongAlertRefBulkDismissSduiItem=a,e.getStrongAlertRefBulkDismissAlertIds=function(e){return(0,n.pipe)(a(e),l.map((e=>new Set(e.alertIds.map((e=>e.toString()))))),l.getOrElse((()=>new Set)))}}(i=e.StrongAlertRef||(e.StrongAlertRef={})),function(e){function i(e){return"gButton"===e.type}function a(e,a){return(0,n.pipe)(t(e,a),l.map((e=>e.content)),l.filter(i))}e.DEFAULT_GBUTTON_ID="gButton-default",e.TONE_GBUTTON_ID="gButton-tone",e.isGButtonContent=i,e.getContent=a,e.getPushAssistantFeedAction=function(e,t){return(0,n.pipe)(a(e,t),l.map((e=>e.actions)),l.chain((e=>l.fromNullable(e.find(o.isPushAssistantFeedAction)))))}}(a=e.GButton||(e.GButton={})),function(e){e.isViewStackContent=function(e){return"viewStack"===e.type},e.getSelectedContent=function(e){return l.fromNullable(e.views[e.selected])}}(s=e.ViewStack||(e.ViewStack={})),function(e){function i(e){return"assistantFeed"===e.type}let a;e.BULK_DISMISS_CARD_FEED_ID="bulk-dismiss-card-feed",e.BULK_DISMISS_REVIEW_FEED_ID="bulk-dismiss-review-feed",e.TONE_INSIGHTS_CARD_FEED_ID="tone-insights-card-feed",e.TONE_INSIGHTS_SUGGESTIONS_FEED_ID="tone-insights-suggestions-feed",e.isAssistantFeedContent=i,e.getContent=function(e,a){return(0,n.pipe)(t(e,a),l.map((e=>e.content)),l.filter(i))},e.createFocusAssistantCardAction=function(e){return{type:"focusAssistantCard",cardId:e}},e.createPopAssistantFeedAction=function(){return{type:"popAssistantFeed"}},e.createPushAssistantFeedAction=function(e,t){return{type:"pushAssistantFeed",feedId:e,cardId:t}},e.isPushAssistantFeedAction=function(e){return"pushAssistantFeed"===e.type},function(t){function i(e){return(0,n.pipe)(l.some(d.a.reduce(e,((e,t)=>"button"===t.type&&"back"===t.id?e.concat(t.actions):e),d.a.TreeTraversal.PostOrder,[])),l.filter(r.Od))}function a(e,i){return(0,n.pipe)(t.getContent(e,i),l.chain(s.getSelectedContent))}t.getContent=function(t,i){return(0,n.pipe)(e.getContent(t,i),l.map((e=>e.header)),l.filter(s.isViewStackContent))},t.getBackButtonActions=i,t.getSelectedViewContent=a,t.getSelectedViewBackButtonActions=function(e,t){return(0,n.pipe)(a(e,t),l.chain(i))}}(a=e.Header||(e.Header={}))}(o=e.AssistantFeed||(e.AssistantFeed={})),function(e){function i(e){return"proofitButton"===e.type}e.ID="proofit-button",e.isProofitContent=i,e.getContent=function(e,a){return(0,n.pipe)(t(e,a),l.map((e=>e.content)),l.filter(i))}}(p=e.Proofit||(e.Proofit={})),function(e){e.ID="upgrade_hook",e.findUpgradeHookSduiItem=function(i){return t(i,e.ID)}}(m=e.UpgradeHook||(e.UpgradeHook={})),function(e){e.ID="success_report",e.findSuccessReportSduiItem=function(i){return t(i,e.ID)}}(h=e.SuccessReport||(e.SuccessReport={}))}(s||(s={}))},50034:(e,t,i)=>{if(i.d(t,{Ov:()=>d,XG:()=>h,ZY:()=>u,ex:()=>p,xq:()=>c}),1388==i.j)var a=i(57050);var s=i(57271),n=i(92783),r=i(90361);if(1388==i.j)var o=i(95195);if(1388==i.j)var l=i(55415);function c(e){return o.Y3((()=>{const t=new URL(e).hostname.split(".");return t.slice(t.length-2).join(".")}),(()=>new Error("Could not get domain from url "+e)))}function d(e,t,i){return!(0,n.n_)()&&function(e,t){var i,a,s,n,r,o;const l=(null!==(a=null===(i=t.dynamicConfig.citationBuilder)||void 0===i?void 0:i.sources)&&void 0!==a?a:[]).concat(u);return null!==(n=null===(s=t.user.experiments)||void 0===s?void 0:s.citationBuilder)&&void 0!==n&&n&&!(null!==(o=null===(r=t.dynamicConfig.citationBuilder)||void 0===r?void 0:r.disabled)&&void 0!==o&&o)&&l.some((t=>new RegExp(t.domain).test(e)))}(e,t)&&function(e,t){var i,a,s;return!(!0===(null===(s=null===(a=null===(i=null==t?void 0:t.citationBuilder)||void 0===i?void 0:i.domains)||void 0===a?void 0:a[e])||void 0===s?void 0:s.disabled))}(e,i)}const u={name:"samples.extension.grammarlyaws.com",domain:"^samples.extension.grammarlyaws.com$",pathname:".*"},p=(0,r.hz)((()=>{const e=document.location.href;return{url:e,domain:(0,s.KK)(e)}})),m=(0,r.hz)((()=>r.iy.create()));function h(e){const t=m(),i=p().domain;return(0,a.zG)(e,l.H6("citeCopyButtonClick","citeCopyIntextClick","citePopupButtonDisable","citePopupButtonShow","citePopupEditClick","citePopupButtonClick","citePopupEditSuccess","citePopupMissingInfoShow","feedbackSentButtonClick"),(e=>({...e,domain:i,sessionId:t})))}},86620:(e,t,i)=>{i.d(t,{C:()=>c,U:()=>a});var a,s=i(27378),n=i(29511),r=i(33678),o=i(88056),l=i(95574);!function(e){let t;!function(e){e.isAppleSystem="isAppleSystem"}(t=e.SidebarFlag||(e.SidebarFlag={})),e.Flag={...t,...r.a.Flag},e.Context=s.createContext(o.Y.invariantContent("Environment"))}(a||(a={}));class c{constructor(e=(0,n.O)()){this._flags=new Set,this.actions={openUrl:e=>l.vM((()=>{document.location.href=e.toString()})),openPopup:e=>l.vM((()=>{const t=self.open(e.toString(),void 0,"noreferrer");t&&(t.opener=null)}))},e.config.systemInfo.os.isMac&&this._flags.add(a.Flag.isAppleSystem),this._flags.add(a.Flag.supportsSVGDominantBaseline),this._flags.add(a.Flag.onlyTrustedEvents)}has(e){return this._flags.has(e)}}},90989:(e,t,i)=>{i.d(t,{I:()=>c,S:()=>a});var a,s=i(27378),n=i(41572),r=i(88056),o=i(19429),l=i(35407);!function(e){e.Context=s.createContext(r.Y.invariantContent("SidebarTextResources")),e.holder=o.VF((()=>({logoText:"GRAMMARLY",plagiarismTooltip:"Scan for plagiarism",setGoalsTooltip:"Adjust goals",statisticsTooltip:"See performance"})))}(a||(a={}));const c=l.GG({denali:n.m.holder,sidebar:a.holder})},25575:(e,t,i)=>{i.d(t,{o:()=>d});var a=i(27378);if(3075==i.j)var s=i(25262);if(3075==i.j)var n=i(24606);if(3075==i.j)var r=i(3656);var o=i(96807);const l=({gnar:e,onSignIn:t,showSignInReminder:i})=>a.createElement(a.Fragment,null,a.createElement(r.CL,{className:o.cardText,color:s.Z.neutral90},i?"Sign back in to use Grammarly with ease and get access to key Grammarly features.":"To continue to apply Grammarly suggestions by simply clicking on them, you’ll need to create an account. Don’t worry, it’s free."),a.createElement(n.z,{kind:"success",size:"small",onClick:()=>{e.anonymousGDocsSidebarSignInCardButtonClick("gdocsSidebar"),t()}},"Sign in")),c=({gnar:e,onCreateAccount:t})=>a.createElement(a.Fragment,null,a.createElement(r.CL,{className:o.cardText,color:s.Z.neutral90},"To continue to apply Grammarly suggestions by simply clicking on them, you'll need to sign into your account."),a.createElement(n.z,{kind:"success",size:"small",onClick:()=>{e.anonymousGDocsSidebarSignUpCardButtonClick("gdocsSidebar"),t()}},"Create account")),d=({gnar:e,isUserLoggedOut:t,showSignInReminder:i,onSignIn:s,onCreateAccount:n})=>a.createElement("div",{className:o.cardContainer},a.createElement(r.H4,null,"Better Writing in Google Docs"),t?a.createElement(l,{gnar:e,onSignIn:s,showSignInReminder:i}):a.createElement(c,{gnar:e,onCreateAccount:n}))},10720:(e,t,i)=>{i.d(t,{US:()=>G,hz:()=>j,ux:()=>W});var a=i(57050),s=i(27378),n=i(51972),r=i(2027),o=i(66896),l=i(89894),c=i(68579),d=i(36156),u=i(71841),p=i(74238),m=i(99116),h=i(35416),g=i(18955),f=i(77176),v=i(98403),w=i(32952),b=i(93508),_=i(76974),S=i(2844),y=i(60797),E=i(24209),k=i(18625),A=i(66310),I=i(40151),C=i(85089),M=i(2834),T=i(95093),x=i(24713),R=i(85985),F=i(49708),L=i(17343),P=i(19751),V=i(5114),O=i(19962),N=i(5739),B=i(81531),U=i(31881),D=i(47476);const H=U.UI.Grid.make((({slots:e,view:t})=>s.createElement(N.F.div,{style:{marginBottom:t("spacing").pipe(f.U(l.ux.rem))}},e.children)));function G(e){switch(e){case o.R.SpecialId.PredictionTakeaways:case o.R.SpecialId.Priority:return.75;default:return 1}}const j=s.forwardRef((({state:e,cardsViewModel:t,cardsListScrollManager:i,connectorElements:o,header:l,footer:p,capabilities:m,comparator:f,readersAttentionItemViewModel:S},y)=>{const E=v.jw((e=>{let t=7;return t=31*t+(0,d.AC)(e.currentLens.id),t=31*t+(h.nL.hasItems(e)?1231:1237),t}),e).view((e=>h.nL.hasItems(e.get())?e.view(h.nL.Prism.getLens()):null)).view((e=>e?{state:e,spacing:G(e.get().id)}:null)),k=s.useContext(r.Dg).state;return s.createElement(g.d,{className:_.of(""),name:"cardlist",stateSyncListener:z(i,o,k),height:W(e,i,m),isMaster:!0},s.createElement(s.Fragment,null,l?s.createElement(N.F.div,{className:D.headerOrFooterWrapper,mount:e=>o.lens("title").set(V.fromNullable(e))},l):null,s.createElement(N.F.div,{mount:y},E.view((e=>{return e?U.UI.mount((s=e.spacing,(0,a.zG)(c.A.cardList(n.O.item(t.actionEvents)),U.UI.patch("content","cell","item")((e=>(0,a.zG)(U.UI.Knot.make(H,{children:e.child}),U.UI.squash,U.UI.contramapState((e=>({children:e,root:{spacing:s}}))),U.UI.mapAction((e=>e.action))))))),(e=>(0,a.zG)(n.O.createCardListFlow(S)(t,e,new w.xQ,u.i$(i).pipe(b.O(!1)),m,f)))(e.state)):null;var s}))),p?s.createElement(N.F.div,{className:D.headerOrFooterWrapper},p):null))})),W=(e,t,i)=>{const a=(0,m.Sd)(i)(e.view(h.nL.mapper((({currentLens:e,alertSource:t})=>V.some({currentLens:e,alertSource:t})))));return S.aj([a.pipe(y.oA,f.U((({currentLens:e})=>e.cardsHeight)),b.O(0)),t.paddingTop]).pipe(f.U((([e,t])=>e+t)))},z=(e,t,i)=>{const a=B.C8.Logging.getLogger("view_models");return E.T(k.P((()=>{e.paddingTop.set(0)})),t.view("viewport").pipe(A.w(V.fold((()=>I.E),(e=>C.YC(e).pipe(M.b((()=>a.debug("update card list viewport due to viewport resize event"))),T.T(i.pipe(x.j("dragging"),R.h((e=>!e)),A.w(v.b2.rafScheduler),M.b((()=>a.debug("update card list viewport due to drag end event"))))),f.U((()=>e.getBoundingClientRect())),f.U((e=>({top:p.r.FromWindowTop.ISO.wrap(e.top),height:e.height}))))))),M.b(v.wW(e.viewport))),t.view("scrollProvider").pipe(A.w(V.fold((()=>I.E),(t=>F.R(t,"scroll").pipe(f.U((()=>t.scrollTop)),b.O(t.scrollTop),M.b(v.wW(e.scrollTop)),L.h(v.PU)))))),t.view("title").pipe(A.w(V.fold((()=>_.of(O.UL.empty)),(e=>C.YC(e)))),f.U((e=>e.height)),P.shareReplay({bufferSize:1,refCount:!0}),M.b(v.wW(e.paddingTop))),t.view("scrollConsumer").pipe(A.w(V.fold((()=>I.E),(t=>e.scrollOffset.pipe(M.b((e=>{t.scrollTop+=e})))))))).pipe(L.h(void 0))}},68340:(e,t,i)=>{i.d(t,{C:()=>L,S:()=>F});var a=i(40327),s=i(18756),n=i(27378),r=i(51972),o=i(10720),l=i(101),c=i(66896),d=i(61903),u=i(25975),p=i(18955),m=i(98403),h=i(60797),g=i(77176),f=i(19962),v=i(5114),w=i(5739),b=i(31881),_=i(74880),S=i(57050),y=i(73582),E=i(38819),k=i(19106),A=i(30509);const I=({upgradeViewModel:e})=>{const t=e.advancedAlerts.pipe(g.U((0,S.ls)(v.map((e=>({count:e.count,alerts:e.alerts()}))))));return n.createElement(w.F.div,{className:A.premiumLens},b.UI.mount(E.r,b.Z.fromSideEffect((t=>{"upgrade"===t.action.action.action.kind&&(k.J.getPremiumButtonClick("gDocsSidebarAssistantSuccessView","GoPremium"),e.openUpgradeUrl(y.L.Place.gdocsSidebarSuccessView))}),t)))};var C=i(41572),M=i(89379),T=i(28378),x=i(879);const R=({successLensViewModel:e})=>{const t=(0,M.hM)((0,M.wK)(e.successState.view("type"),n.useContext(C.m.Context)));return n.createElement(w.F.div,{className:x.successLens},b.UI.mount(T.q,t))},F=n.forwardRef((({state:e,cardsViewModel:t,upgradeViewModel:i,cardsListScrollManager:a,capabilities:l,upgradeHookFlow:p,...h},g)=>{const f=m.jw((e=>{let t=7;return t=31*t+(0,s.AC)(e.currentLens.id),t=31*t+(u.v.WithSuccess.State.isInSuccess(l)(e)?1231:1237),t}),e);return n.createElement(L,{ref:g},(e=>n.createElement(w.F.Fragment,null,f.view((s=>{const m=s.get();return m.currentLens.id===c.R.SpecialId.Premium?n.createElement(I,{upgradeViewModel:i}):u.v.WithSuccess.State.isInSuccess(l)(m)?n.createElement(R,{successLensViewModel:h.successLensViewModel}):n.createElement("div",null,n.createElement(o.hz,{state:s,cardsViewModel:t,cardsListScrollManager:a,connectorElements:e,header:b.UI.mount(d.n.TogglablePanel,p),comparator:r.O.listItemOrd,capabilities:l,readersAttentionItemViewModel:v.none}))})))))})),L=n.forwardRef((({children:e,onClick:t,className:i=_.cardList,footer:s},r)=>{const o=p.d.Elements.create(),c=(0,a.pipe)(o.view("viewport"),h.oA,g.U(f.UL.fromEl));return n.createElement("div",{onClick:t,className:i,ref:e=>{"function"==typeof r?r(e):r&&(r.current=e);const t=v.fromNullable(e);o.lens("scrollConsumer").set(t),o.lens("scrollProvider").set(t),o.lens("viewport").set(t)}},n.createElement(l.l.RootVirtualContainer,{name:"cardListConnector",viewport:c},e(o)),s)}))},1309:(e,t,i)=>{i.d(t,{Z:()=>c});var a=i(27378);if(3075==i.j)var s=i(62295);if(3075==i.j)var n=i(61922);if(3075==i.j)var r=i(66896);if(3075==i.j)var o=i(5739);var l=i(57731);const c=({lensPreviewViewModel:e})=>{const t=e.getLens(r.R.SpecialId.AllAlerts).view((e=>e.count));return a.createElement(o.F.div,{className:l.footer},a.createElement(d,{activeAlerts:t}))},d=({activeAlerts:e})=>a.createElement(o.F.Fragment,null,e.view((e=>e>0?a.createElement(s.x.OutcomeCounter,{count:e,theme:{counterWrapper:l.counterWrapper,counterContent:l.counter}}):a.createElement(n.JO.CheckmarkOutcomes,{className:l.counterCheckmarkIcon}))))},74928:(e,t,i)=>{i.d(t,{$l:()=>C});var a=i(27378);if(3075==i.j)var s=i(77394);if(3075==i.j)var n=i(90989);if(3075==i.j)var r=i(22667);if(3075==i.j)var o=i(64757);if(3075==i.j)var l=i(61922);if(3075==i.j)var c=i(81301);if(3075==i.j)var d=i(3656);if(3075==i.j)var u=i(66896);if(3075==i.j)var p=i(40018);if(3075==i.j)var m=i(40743);if(3075==i.j)var h=i(87667);if(3075==i.j)var g=i(92644);if(3075==i.j)var f=i(15774);if(3075==i.j)var v=i(89186);if(3075==i.j)var w=i(84317);if(3075==i.j)var b=i(77176);if(3075==i.j)var _=i(85985);if(3075==i.j)var S=i(22232);if(3075==i.j)var y=i(8125);if(3075==i.j)var E=i(5114);if(3075==i.j)var k=i(12187);var A=i(31881),I=i(21831);const C=({state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:n,features:r})=>{switch(r.priorityLens.kind){case s.h.Kind.dropdown:return a.createElement(M,{state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:n});case s.h.Kind.priorityToggle:return a.createElement(T,{state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:n,defaultMode:r.priorityLens.defaultMode});case s.h.Kind.none:return a.createElement(x,{navigationViewModel:t,modalManager:i});default:(0,S.vE)(r.priorityLens)}},M=({state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:s})=>a.createElement("div",{className:I.priorityLensHeader},a.createElement(R,{navigationViewModel:t,modalManager:i}),a.createElement("div",{className:I.prioritySwitchWrapper},A.UI.mount(h.n.Switch,(0,g.i)(s,t,e.pipe(b.U((e=>e.currentLens.id))))))),T=({state:e,navigationViewModel:t,modalManager:i,lensPreviewViewModel:s,defaultMode:n})=>a.createElement("div",{className:I.priorityLensHeader},a.createElement(R,{navigationViewModel:t,modalManager:i}),a.createElement("div",{className:I.prioritySwitchFlatWrapper},A.UI.mount(v.B.DefaultHeader,(0,w.HP)(t,e.pipe(b.U((e=>e.currentLens.id)),_.h((0,y.Kg)(u.R.isPriority,u.R.isAllAlerts))),"priority"===n?f.H.LensMode.priority:f.H.LensMode.all,"compact",s,10)))),x=({navigationViewModel:e,modalManager:t})=>a.createElement("div",{className:I.defaultHeader},a.createElement(R,{navigationViewModel:e,modalManager:t}),a.createElement("div",{...(0,k.Sh)(I.lensNavigation,I.disabledLensNavigation)},A.UI.mount(m.C,A.Z.fromSideEffect((t=>{e.events.next({type:"switchToLens",id:t.lens.id,focusFirst:!1,actionSource:p.l$.sidebar})}),{activeLensId:E.none,previews:Object.values(e.lensPreviews.get()).filter((e=>e.id!==u.R.SpecialId.Vox)),disabled:!1})))),R=({navigationViewModel:e,modalManager:t})=>{const i=a.useContext(n.S.Context),s=t.state.view(E.exists((e=>e.instance.type===c.dC.SetGoals)));return a.createElement("div",{className:I.head},a.createElement("div",{className:I.headerGroup},a.createElement(r.K,{className:I.logoIcon,size:18}),a.createElement(d.H5,{className:I.logoText},i.logoText)),a.createElement(o.zx.Flat,{name:"setGoals",className:I.setGoalsButton,title:i.setGoalsTooltip,titleAlign:"bottomCenter",active:s,disabled:s,onClick:()=>e.events.next({type:"setGoals"})},a.createElement(l.JO.GoalsEmpty,{width:24})),a.createElement("div",{className:I.headerGroup},a.createElement("div",{className:I.divider}),a.createElement(o.zx.Flat,{name:"closeSidebar",onClick:()=>e.events.next({type:"toggleSidebar",actionSource:p.l$.sidebar})},a.createElement(l.JO.Close,{width:16}))))}},1473:(e,t,i)=>{i.d(t,{R:()=>c});var a=i(27378);if(3075==i.j)var s=i(22667);if(3075==i.j)var n=i(3656);if(3075==i.j)var r=i(40018);var o=i(44617);const l=()=>a.createElement("svg",{width:"11",height:"11",viewBox:"0 0 12 13",fill:"none"},a.createElement("path",{d:"M0.5 1L6 6.5M11.5 12L6 6.5M6 6.5L11.5 1M6 6.5L0.5 12",strokeLinecap:"round",strokeWidth:"1.5"})),c=({navigationViewModel:e})=>a.createElement("div",{className:o.header},a.createElement("div",{className:o.headerGroup},a.createElement("div",{className:o.logoIcon},a.createElement(s.K,null)),a.createElement(n.H5,null,"Grammarly")),a.createElement("div",{className:o.headerGroup},a.createElement("div",{className:o.closeButton,onClick:()=>{e.events.next({type:"toggleSidebar",actionSource:r.l$.sidebar})},role:"button"},a.createElement(l,null))))},80550:(e,t,i)=>{i.d(t,{L:()=>o});var a=i(57050),s=i(27378),n=i(5114),r=i(5739);const o=({modalManager:e})=>s.createElement(r.F.Fragment,null,e.state.view((0,a.ls)(n.map((({component:e})=>e)),n.toNullable)))},11177:(e,t,i)=>{i.d(t,{P:()=>o});var a=i(27378),s=i(50790),n=i(30543),r=i(32380);const o={unauthorizedError:(e,t)=>a.createElement(n.s.UnauthorizedError,{action:t("gotoLogin")}),offline:()=>a.createElement(l,null),alertUndo:(e,t)=>a.createElement(r.A.Standard,{action:t("undo"),params:e.args.params})},l=()=>a.createElement(s.DI.TitledContent,{title:"Lost Connection"},"Your Internet session was interrupted.")},92132:(e,t,i)=>{i.d(t,{Q:()=>l});var a=i(27378),s=i(15073),n=i(60797),r=i(95300),o=i(5114);const l=({children:e,remSize:t,setter:i})=>(c+=1,a.useEffect((()=>{const e=t.subscribe((e=>{d.next(o.some(e)),i(o.some(e))}));return()=>{e.unsubscribe(),c-=1,0===c&&(d.next(o.none),i(o.none))}}),[t]),a.createElement(s.u.Context.Provider,{value:d.pipe(n.oA)},e));let c=0;const d=new r.X(o.none)},9025:(e,t,i)=>{i.d(t,{_:()=>n});var a=i(27378);if(3075==i.j)var s=i(94071);const n=({children:e,className:t})=>a.createElement("div",{className:t,style:{position:"fixed",right:"0px",top:"0px",bottom:"0px",width:s.xK,zIndex:1e3,background:"white",display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100vh"}},e)},94071:(e,t,i)=>{i.d(t,{H2:()=>n,iB:()=>a,kl:()=>r,xK:()=>s});const a=".docs-companion-sidebar",s="300px";var n;!function(e){e.selector=".companion-guest-app-switcher .app-switcher-button",e.selectedClass="app-switcher-button-selected",e.selectedSelector=`.${e.selectedClass}`,e.activeClass="app-switcher-button-active",e.hoverClass="app-switcher-button-hover",e.disabledClass="app-switcher-button-disabled"}(n||(n={}));const r=".companion-about-panel-button"},94663:(e,t,i)=>{i.d(t,{I:()=>r});var a=i(5802),s=i(41966);const n={priority:a.P.Priority.highest,timeout:a.P.TimeoutDisabled,position:a.P.Position.top,viewType:a.P.ViewType.standard};var r;!function(e){e.createFactory=function(){return{alertUndo:s.r.createBuilder().build({priority:a.P.Priority.low,timeout:a.P.DefaultTimeout,position:a.P.Position.bottomRight,viewType:a.P.ViewType.standard}),unauthorizedError:s.r.createBuilder().build(n),offline:s.r.createBuilder().build(n)}}}(r||(r={}))},70091:(e,t,i)=>{if(i.d(t,{U9:()=>L,jv:()=>V}),3075==i.j)var a=i(32138);var s=i(27378);if(3075==i.j)var n=i(3295);if(3075==i.j)var r=i(86620);if(3075==i.j)var o=i(90989);if(3075==i.j)var l=i(25575);if(3075==i.j)var c=i(68340);if(3075==i.j)var d=i(1309);if(3075==i.j)var u=i(74928);if(3075==i.j)var p=i(1473);if(3075==i.j)var m=i(80550);if(3075==i.j)var h=i(11177);if(3075==i.j)var g=i(92132);if(3075==i.j)var f=i(9025);if(3075==i.j)var v=i(50981);var w=i(48189),b=i(49468);if(3075==i.j)var _=i(64078);if(3075==i.j)var S=i(42103);if(3075==i.j)var y=i(33678);if(3075==i.j)var E=i(15073);if(3075==i.j)var k=i(41572);if(3075==i.j)var A=i(47861);if(3075==i.j)var I=i(90845);if(3075==i.j)var C=i(76974);if(3075==i.j)var M=i(8313);var T=i(79850),x=i(75259),R=i(67129);const F=({state:e,gnar:t,user:i,anonymousFrictionGDocsService:r,cardsViewModel:o,navigationViewModel:m,successLensViewModel:g,upgradeViewModel:v,cardsListScrollManager:w,notificationManager:b,lensPreviewViewModel:_,modalManager:S,features:y,capabilities:E,upgradeHookFlow:k})=>{const[I,C]=s.useState(i.view("anonymous").get());return s.useEffect((()=>{const e=i.view("anonymous").subscribe((e=>{C(e)}));return()=>e.unsubscribe()}),[]),I&&r.peekTreatment()?s.createElement(f._,{className:R.sidebarContainer},s.createElement(p.R,{navigationViewModel:m}),s.createElement("section",{className:R.sidebarContent},s.createElement(l.o,{gnar:t,showSignInReminder:r.isInTreatmentWithOneLockedSuggestion,isUserLoggedOut:r.anonymousUserType===n.q.LoggedOut,onCreateAccount:()=>{self.open((0,a.Xc)("signupHook","gdocsSidebarAnonymousCard"))},onSignIn:()=>{self.open((0,a.s7)())}}))):s.createElement(f._,{className:R.sidebarContainer},s.createElement(u.$l,{state:e,navigationViewModel:m,modalManager:S,lensPreviewViewModel:_,features:y}),s.createElement(c.S,{cardsViewModel:o,state:e,successLensViewModel:g,upgradeViewModel:v,cardsListScrollManager:w,capabilities:E,upgradeHookFlow:k}),"none"!==y.priorityLens.kind?null:s.createElement(d.Z,{lensPreviewViewModel:_}),s.createElement(A.i,{key:"notificationCenter",manager:b,views:h.P,theme:{grid:{container:x.container,bottomLeft:x.bottomLeft,bottomRight:x.bottomRight,top:x.top},view:{wrapper:x.notificationWrapper}}}))};function L(e){return({integration:t,sidebarReady:i,shortenItFeature:a,ethicalAIFeature:n,cardEvents:o,user:l,anonymousFrictionGDocsService:c})=>()=>{const d=t.engine,u=new r.C,{lensState:p,cardsViewModel:h,navigationViewModel:g,successLensViewModel:f,upgradeViewModel:w,dispose:b,cardsListScrollManager:S,notificationManager:y,lensPreviewViewModel:E,modalManager:k,capabilities:A,upgradeHookFlow:C}=(0,v.G)(d,t.denaliViewAdapter,e,t.connectionState,t.gnar,t.user,l,t.document.settings.lens("selectedLens"),t.features,i,a,n,o,t.experimentClient);return I.P.useEffectOnWillUnmount((()=>{d.shutdown(),b()})),s.createElement(P,{environment:u},s.createElement(F,{anonymousFrictionGDocsService:c,user:l,gnar:t.gnar,state:p,cardsViewModel:h,navigationViewModel:g,successLensViewModel:f,upgradeViewModel:w,cardsListScrollManager:S,notificationManager:y,lensPreviewViewModel:E,modalManager:k,features:t.features,capabilities:A,upgradeHookFlow:C}),s.createElement(m.L,{modalManager:k}),s.createElement(_.X,null))}}const P=({environment:e,children:t})=>{const i=s.useRef((0,o.I)(k.m.getConfig(e.has(r.U.Flag.isAppleSystem)?"mac":"windows")));return s.createElement(g.Q,{remSize:C.of(16),setter:e=>E.u.setRootCssVar(document.documentElement,e)},s.createElement(r.U.Context.Provider,{value:e},s.createElement(y.a.Context.Provider,{value:e},s.createElement(o.S.Context.Provider,{value:i.current.sidebar},s.createElement(k.m.Context.Provider,{value:i.current.denali},s.createElement(M.TG.ContextMock,null,s.createElement(S.G.DefaultProvider,null,s.createElement(V,null,t))))))))},V=({children:e})=>s.createElement(s.Fragment,null,s.createElement(b.o,{"data-grammarly-part":"gdocs-sidebar",className:T.wrapper},e),s.createElement(w.p,{thin:!0,thinItalic:!0,regular:!0,italic:!0,bold:!0,boldItalic:!0,semiBold:!0}))},16868:(e,t,i)=>{i.d(t,{CV:()=>B,hp:()=>N,k9:()=>U});var a=i(57050),s=i(40327),n=i(74850),r=i(59443),o=i(40018),l=i(66896),c=i(18625),d=i(60797),u=i(77176),p=i(66310),m=i(17343),h=i(98403),g=i(91224),f=i(40151),v=i(38194),w=i(76974),b=i(24209),_=i(93508),S=i(16118),y=i(85985),E=i(28043),k=i(41398),A=i(83401),I=i(598),C=i(25980),M=i(58562),T=i(74238),x=i(99116),R=i(4890),F=i(35416),L=i(5114),P=i(83078),V=i(38983);class O{constructor(e,t){this._cardPositions=e,this._markPositions=t,this._log=n.Y.create(O.name)}alignCardToMark({id:e,renderOptions:{features:t},activeAlert:i,activeHighlightIndex:a},n){return c.P((()=>this._markPositions.getMarkAlertPosition({alert:i,highlightIndex:a}))).pipe(d.oA,u.U((i=>(0,s.pipe)(this._cardPositions.getCardSuggestedPositionInViewport(e,t.has(R.j.Features.showLabel),L.some(i),"cardContentTop"),L.fromEither))),d.oA,p.w((i=>this._cardPositions.setCardPosition(e,t.has(R.j.Features.showLabel),!0,i.top))),m.h(h.PU),g.K((e=>(this._log.error("Cannot align card to mark",e),f.E))),v.B())}alignMarkTo(e,t,i,a){return c.P((()=>w.of((0,s.pipe)(this._cardPositions.getCardSuggestedPositionInViewport(e.id,e.renderOptions.features.has(R.j.Features.showLabel),L.some(i),"cardContentTop"),L.fromEither)).pipe(d.oA))).pipe(p.w((i=>b.T(this._markPositions.moveAlertHighlightInViewport(t,T.r.FromWindowTop.ISO.modify(T.L.concatC(i.contentOffset))(i.top),r.uq.initial),this._cardPositions.setCardPosition(e.id,e.renderOptions.features.has(R.j.Features.showLabel),!0,i.top)))),m.h(h.PU),g.K((e=>(this._log.error("Cannot align mark to suggested position",e),f.E))),v.B())}alignMarkToCard({id:e,renderOptions:{features:t},activeHighlightIndex:i,activeAlert:a},n,o=L.none){return c.P((()=>w.of((0,s.pipe)(this._cardPositions.getCardSuggestedPositionInViewport(e,t.has(R.j.Features.showLabel),o,"cardContentTop"),L.fromEither)).pipe(d.oA))).pipe(p.w((s=>b.T(this._markPositions.moveAlertHighlightInViewport({alert:a,highlightIndex:i},T.r.FromWindowTop.ISO.modify(T.L.concatC(s.contentOffset))(s.top),r.uq.initial),this._cardPositions.setCardPosition(e,t.has(R.j.Features.showLabel),!0,s.top)))),m.h(h.PU),g.K((e=>(this._log.error("Cannot align mark to card",e),f.E))),v.B())}alignCardTo(e,t,i){const a=i!==C.v.Animation.NO_ANIMATION;return c.P((()=>w.of((0,s.pipe)(this._cardPositions.getCardSuggestedPosition(e.id,e.renderOptions.features.has(R.j.Features.showLabel),L.some(t),"cardTop"),L.fromEither)).pipe(d.oA))).pipe(p.w((t=>this._cardPositions.setCardPosition(e.id,e.renderOptions.features.has(R.j.Features.showLabel),a,t.top))),m.h(h.PU),g.K((e=>(this._log.error("Cannot align card to required top",e),f.E))),v.B())}}const N=(e,t,i,a,s,n)=>new O(M.eZ.getSuperScrollMapper(e,a,V.h.create(16)),M.UC.getMapper(t,s,n));var B;!function(e){e.skip="skip"}(B||(B={}));const U=(e,t,i,n,r,c=h.b2.rafScheduler)=>{const d=(e,i,a,s)=>{if(a===o.l$.text)return t.alignCardToMark(e,i?C.v.Animation.ANIMATE_ALL:C.v.Animation.NO_ANIMATION,!0);if(a===F.h8.forceText)return t.alignCardToMark(e,C.v.Animation.NO_ANIMATION,!1);{const n=a===o.l$.sidebar;return t.alignMarkToCard(e,n?i?C.v.Animation.ANIMATE_ALL:C.v.Animation.ANIMATE_MARK:C.v.Animation.NO_ANIMATION,s)}},g=b.T(e.view(F.nL.mapper((({currentLens:e,alertSource:t})=>L.some({currentLens:e,alertSource:t})))).pipe(_.O(L.none),u.U(L.map((e=>e.currentLens.id))),S.G(),y.h((([e,t])=>(0,s.pipe)(P.vB(((e,t)=>e!==t))(e,t),L.exists(a.yR)))),m.h(L.none)),e.view(F.nL.mapper((({currentLens:e,alertSource:t})=>L.some({currentLens:e,alertSource:t})))).pipe(y.h(L.exists((({currentLens:e})=>(0,x.Bk)(r)(e)))),u.U(L.chain((({currentLens:e,alertSource:t})=>(0,s.pipe)(n(e),L.filter(r.isValidToAlign),L.map((i=>({item:i,source:t,lensId:e.id}))))))))).pipe(E.x((0,a.ls)(P.vB(((e,t)=>e.lensId===t.lensId&&e.item.activeAlert.id===t.item.activeAlert.id&&e.item.visualState.transition.type===t.item.visualState.transition.type&&e.item.activeHighlightIndex===t.item.activeHighlightIndex)),L.exists(a.yR))),_.O(L.none),S.G(),u.U((([e,t])=>(0,s.pipe)(t,L.map((i=>({item:i.item,source:i.source,animate:(0,s.pipe)(e,P.wo((({lensId:e})=>e===i.lensId))),suggestedPosition:(0,s.pipe)(e,L.filter((e=>!r.isScheduledToDispose(e.item))),L.chain((e=>(0,s.pipe)(t,L.map((t=>[e.item,t.item]))))),L.filter((([e,t])=>t.lensId===e.lensId&&t.positionState.absTop>e.positionState.absTop)),L.map((([e,t])=>T.r.FromWindowTop.ISO.wrap(t.positionState.absTop))))})))))),p.w(L.fold((()=>f.E),c)),k.M(i),p.w((([{item:e,source:t,animate:a,suggestedPosition:n},r])=>(0,s.pipe)(r,L.fold((()=>d(e,a,t,n)),(t=>(i.set(L.none),t===B.skip?A.C:d(e,a,t,n))))))));return{id:"alignmentSideEffect",when:l.R.isWithAlertsId,what:F.nL.Effect.Applicator.create(g.pipe(I.c(A.C)))}}},93829:(e,t,i)=>{if(i.d(t,{C:()=>r}),3075==i.j)var a=i(9671);if(3075==i.j)var s=i(15090);if(3075==i.j)var n=i(9922);class r{constructor(e,t,i){this._cardsViewModel=e,this._gnar=t,this._getAlertById=i,this._subs=new n.w.Keeper,this.subscribeToSidebarCardActions()}subscribeToSidebarCardActions(){this._subs.push(s.g.createSubscription(this._cardsViewModel.actionEvents,this._gnar,this._getAlertById),(0,a.t)(this._cardsViewModel.actionEvents,this._gnar,"gdocs"))}dispose(){this._subs.dispose()}}},51540:(e,t,i)=>{i.d(t,{A7:()=>k,CH:()=>C,Ng:()=>I,uo:()=>A});var a=i(57050),s=i(66896),n=i(40018),r=i(55935),o=i(66310),l=i(40151),c=i(76974),d=i(85985),u=i(41398),p=i(77176);if(3075==i.j)var m=i(28043);if(3075==i.j)var h=i(598);if(3075==i.j)var g=i(83401);if(3075==i.j)var f=i(13444);if(3075==i.j)var v=i(57091);if(3075==i.j)var w=i(16118);var b=i(35416);if(3075==i.j)var _=i(25975);var S=i(5114);if(3075==i.j)var y=i(83078);if(3075==i.j)var E=i(38983);function k(e,t,i){return{id:"alertSwitchingByClickSideEffect",when:a.W8,what:b.nL.Effect.SwitchAlert.create(e.alertClicked.pipe(r.T(1),o.w(S.fold((()=>l.E),c.of)),d.h((e=>!i||e.alert.lensId!==s.R.SpecialId.Premium)),u.M(t.pipe(d.h(b.nL.hasCards),p.U((e=>e.currentLens.id))),((e,t)=>({...e,lensId:t}))),p.U((({alert:e,highlightIndex:t,lensId:i})=>({alertHighlight:{alert:e,highlightIndex:t},alertSource:n.l$.text,options:{lensId:i,order:"textOrder"}})))))}}function A(e,t){return{id:"connectionManager",when:()=>!0,what:b.nL.Effect.SwitchAlert.create(e.pipe(p.U((e=>e.online)),m.x(),o.w((e=>e?l.E:t.enqueue("offline",{reconnectTime:E.h.create(10)}))),h.c(g.C)))}}function I(e,t,i){const a=e.getLens(s.R.SpecialId.Premium).pipe(p.U((e=>e.count>0)),m.x());return{id:"autoSwitchToPremiumLensSideEffect",when:e=>e===s.R.SpecialId.AllAlerts||e===s.R.SpecialId.Priority,what:b.nL.Effect.SwitchLens.create(t.pipe(p.U(_.v.WithSuccess.State.isInSuccess(i)),m.x(),f.g(1),v.a(a),d.h((([e,t])=>e&&t)),p.U((()=>({lensId:s.R.SpecialId.Premium,alertSource:n.l$.sidebar,options:{toFocus:b.nL.Effect.FocusBehavior.noFocus}})))))}}function C(e,t){const i=e.getLens(s.R.SpecialId.AllAlerts).pipe(p.U((e=>e.count>0)),m.x()),r=e.getLens(s.R.SpecialId.Priority).pipe(p.U((e=>e.count>0)),m.x());return{id:"autoSwitchFromPremiumLensSideEffect",when:a.W8,what:b.nL.Effect.SwitchLens.create(t.pipe(p.U((e=>e.currentLens.id)),m.x(),w.G(),d.h((([e,t])=>t===s.R.SpecialId.Premium)),p.U((([e,t])=>e)),v.a(i,r),p.U((([e,t,i])=>e===s.R.SpecialId.Priority&&i?S.some(s.R.SpecialId.Priority):e===s.R.SpecialId.AllAlerts&&t?S.some(s.R.SpecialId.AllAlerts):S.none)),d.h(S.isSome),p.U(y.MH),p.U((e=>({lensId:e,alertSource:n.l$.sidebar,options:{toFocus:b.nL.Effect.FocusBehavior.noFocus}})))))}}},7680:(e,t,i)=>{i.d(t,{D:()=>a});var a,s=i(40327),n=i(73353),r=i(5114),o=i(55415);!function(e){e.updateCitationStyle=(e,t)=>i=>{const a=(0,s.pipe)(e.defaultContext.get(),r.getOrElse((()=>n.R$.defaultContextFallback))),l=(0,s.pipe)(e.context.get(),n.R$.OutcomeContext.withCitationStyle(i));(0,s.pipe)(l,e.updateContext)&&t.goalsFormSuccess((0,s.pipe)(l.domain,r.getOrElse((()=>a.domain))),(0,s.pipe)(l.goals,r.getOrElse((()=>a.goals)),(e=>Array.from(e))),"essayDetectionCard",(0,s.pipe)(l.outcomeContext,r.map(o.ei("type")),r.toUndefined),void 0,(0,s.pipe)(l.outcomeContext,r.map(o.ei("citation")),r.toUndefined),void 0)}}(a||(a={}))},50981:(e,t,i)=>{if(i.d(t,{G:()=>fe}),3075==i.j)var a=i(57050);if(3075==i.j)var s=i(40327);if(3075==i.j)var n=i(50622);if(3075==i.j)var r=i(58809);if(3075==i.j)var o=i(37532);if(3075==i.j)var l=i(51972);if(3075==i.j)var c=i(77394);if(3075==i.j)var d=i(86620);if(3075==i.j)var u=i(94663);if(3075==i.j)var p=i(93829);if(3075==i.j)var m=i(7680);if(3075==i.j)var h=i(62346);if(3075==i.j)var g=i(37290);if(3075==i.j)var f=i(73582);if(3075==i.j)var v=i(33953);if(3075==i.j)var w=i(73763);if(3075==i.j)var b=i(88661);if(3075==i.j)var _=i(92783);if(3075==i.j)var S=i(4120);if(3075==i.j)var y=i(44618);if(3075==i.j)var E=i(81301);if(3075==i.j)var k=i(61813);if(3075==i.j)var A=i(66896);if(3075==i.j)var I=i(13313);if(3075==i.j)var C=i(70023);if(3075==i.j)var M=i(61903);if(3075==i.j)var T=i(98403);if(3075==i.j)var x=i(76974);if(3075==i.j)var R=i(77176);if(3075==i.j)var F=i(85985);if(3075==i.j)var L=i(2834);if(3075==i.j)var P=i(17343);if(3075==i.j)var V=i(28043);if(3075==i.j)var O=i(66310);if(3075==i.j)var N=i(40151);if(3075==i.j)var B=i(21619);if(3075==i.j)var U=i(54216);if(3075==i.j)var D=i(15787);if(3075==i.j)var H=i(48052);if(3075==i.j)var G=i(91549);if(3075==i.j)var j=i(83167);if(3075==i.j)var W=i(20594);if(3075==i.j)var z=i(35607);if(3075==i.j)var q=i(20291);if(3075==i.j)var Z=i(34383);if(3075==i.j)var K=i(11245);if(3075==i.j)var $=i(4890);if(3075==i.j)var X=i(35416);if(3075==i.j)var Y=i(25975);if(3075==i.j)var Q=i(73841);if(3075==i.j)var J=i(89770);if(3075==i.j)var ee=i(39920);if(3075==i.j)var te=i(17372);if(3075==i.j)var ie=i(74364);if(3075==i.j)var ae=i(27125);if(3075==i.j)var se=i(5114);if(3075==i.j)var ne=i(83078);if(3075==i.j)var re=i(95195);if(3075==i.j)var oe=i(8125);if(3075==i.j)var le=i(95574);if(3075==i.j)var ce=i(38983);if(3075==i.j)var de=i(81531);var ue=i(16027);if(3075==i.j)var pe=i(16868);if(3075==i.j)var me=i(51540);if(3075==i.j)var he=i(40081);if(3075==i.j)var ge=i(780);const fe=(e,t,i,fe,ve,we,be,_e,Se,ye,Ee,ke,Ae,Ie)=>{const Ce=de.C8.Logging.getLogger("view_models"),Me=ce.h.create(I.A.defaultState),Te=ce.h.create(!1),xe=U.t.create(U.t.defaultLensFilters,U.t.defaultTextFilters),Re=e.alertsList.state.pipe((t=>I.A.get(t,e.alertsList.lensesScores,xe))).subscribe(T.wW(Me)),Fe=new he.t(Me.view("lenses"),xe,e.sessionModel.scoreStatus),Le=(0,H.$y)((0,y.a)(t).getContents),Pe={features:(()=>{const e=new Set;return e.add(W.IG.Features.showCardLabelInOutcomes),e})(),cardLayoutDensityMode:$.j.Density.compact,shouldAnimateAlertApply:a.jv,cardVisualMode:ce.h.create($.j.CardVisualMode.RegularLightMode)},Ve=(0,W.Ls)(Le,e.alertsReader,Pe,(()=>x.of(se.none)),e.mutingAlertsReader),Oe=G.R.ItemFactory.create(Le,e.mutingAlertsReader,Pe,(()=>x.of(se.none))),Ne=(0,K.U)(Le,e.alertsReader,Pe,Z.T.ordAlert),Be=l.O.getCapabilities(Ve,Oe,Ne,e.alertsReader,Le,ce.h.create(Z.D.empty()),(()=>He.get().currentLens.id)),Ue=new J.oq(e.alertsList.state,e.alertsReader,Me.view("lenses"),e.positionManager,Fe,new ee.gi(l.O.equatable.structEq,l.O.defaultOrd),(0,ee.is)(Ve,Be),Be,xe),De=A.R.SpecialId.AllAlerts;i.next({kind:c.R.ChangeLens,selectedLens:"all"});const He=ce.h.create(Ue.emptyState(De)),Ge=He.pipe(R.U((e=>e.currentLens.id)),F.h(r.U.SelectedLens.filter)).subscribe((e=>_e.set(e))),je=(0,j.u0)((()=>t.getCursor().index),Ue),We=new f.x(e.alertsList,He,5),ze=new v.r(e.alertsList,He),qe=new E.EQ(new ge.o(e.sessionModel,We,we.isPremium,ve,Ie.isGateEnabled(b.K.StudentsOFEGdocs)||Ie.isGateEnabled(b.K.StudentsOFEInternal))),Ze=new g.$(He,Fe,i,qe,t,Se,ve,te.z.all),Ke=new D.Xx({flush:()=>t.flushChanges()},Ze.events,Ve,e.alertsService,(()=>Promise.resolve()),(()=>Promise.resolve()),(0,s.pipe)(e.mutedAlertsCategoriesModel,se.map((e=>({model:e,openSuggestionsManagement:()=>self.open((0,_.Um)().suggestionsSettings)})))),se.none,(()=>!1),l.O.getActiveItemWithAlert,Be,He,new d.C,{bufferTransitions:!0,showGbPrompt:!1},m.D.updateCitationStyle(e.sessionModel,ve)),$e=new p.C(Ke,ve,(t=>e.alertsReader.getById(t))),Xe=S.n5.isFree(be.get())&&"test_no_underlines"!==Ie.getTreatment(w.p.YellowUnderlinesExtRelaunch),Ye=(0,s.pipe)((0,C.d)(We.advancedAlerts),ue.Z.extendActions(L.b((e=>{e.key===M.n.State.minimized&&"onClick"===e.action.action&&Xe&&Te.set(!0),e.key===M.n.State.expanded&&"collapse"===e.action.kind&&Te.set(!1),e.key===M.n.State.expanded&&"upgrade"===e.action.kind&&(ve.getPremiumButtonClick("gDocsSideBarAssistantList","SeeWhatsInPremium"),We.openUpgradeUrl(f.L.Place.gdocsSidebarCardList)),e.key===M.n.State.expanded&&"onUpgradeButtonMount"===e.action.kind&&ve.getPremiumButtonShow("gDocsSideBarAssistantList","SeeWhatsInPremium")})))),Qe=Te.pipe(P.h(T.PU)),Je=ze.freeAlerts.pipe(R.U((e=>{var t;return!(null===(t=(0,s.pipe)(e,ne.Fc))||void 0===t?void 0:t.count)&&Xe})),V.x()).subscribe(T.wW(Te)),et=(0,h.xl)(He,xe,Qe,Te),tt=new h.o$(e.alertsList,e.alertsReader,e.positionManager,e.alertsService,t,He,et,l.O.getActiveItemWithAlert,ye,!1,Te),it=new z.o((()=>re.F2(void 0))),at=(0,pe.hp)(He,tt,ce.h.create(16),it,t,Ce),st=new B.mN(t,He,tt,e.alertsReader,l.O.getActiveItemWithAlert),nt=new k.y(ce.h.create([]),u.I.createFactory(),3,5e3),rt=[D.dv.changeAlertEffect(He,Ke,Ve,l.O.getActiveItemWithAlert,e.alertsReader,se.some(at),je,Ce.getLogger("CardsViewModelEffects.changeAlertEffect")),...Ke.getApplicatorEffects(),q.R7(He,it,Be,(0,a.MZ)(Ke.actionEvents),{cardsAroundActive:25,cardsBeyondViewport:25}),me.A7(st,He),(0,pe.k9)(He,at,ce.h.create(se.none),l.O.getActiveAlignableItem,Be),q.XU(He,it,Be),ie.EQ.focusMarkByActiveAlert(He,tt,e.alertsReader,l.O.getActiveFocusableItem,Ce.getLogger("MarksEffects.focusMarkByActiveAlert")),me.uo(fe,nt),D.dv.createSendActiveAlertFeedbacksEffect(He,l.O.getActiveItemWithAlert,e.alertsService,e.alertsReader,Ce.getLogger("CardsViewModelEffects.createSendActiveAlertFeedbacksEffect")),me.Ng(Fe,He,Be),me.CH(Fe,He),Ze.lensChangeEffect],ot="none"!==Se.priorityLens.kind?Ze.lensMode.view(te.K.isPriorityMode).view((0,oe.RN)(A.R.SpecialId.Priority,A.R.SpecialId.AllAlerts)):ce.h.create(A.R.SpecialId.AllAlerts),lt=(0,j.VC)(Ue,je,ot,Be),ct=ce.h.create(!0),dt=j.Py.getStateTransformer(j.Py.getDefaultBehavior(l.O.getActiveItemWithAlert,Be),lt,e.alertsReader,Be,(e=>ct.get()&&"text"!==e.alertSource),a.Q1,ot),ut=Y.v.Items.getItemsPositionsUpdateTransformer(Be),pt=(0,a.ls)(dt,le.L9(ut)),mt=new Q.l(He,Ue,e.alertsReader,e.alertsService,rt,l.O.getActiveItemWithAlert,pt),ht=new ae.L(He,e.sessionModel,a.Q1,Be,se.none,se.none,(e=>X.nL.isWithPriorityList(e)&&Y.v.WithPriority.onlyNonPriorityAlertsLeft(e.currentLens,l.O.priorityTest,Be)),Y.v.WithPriority.isInSuccess(l.O.priorityTest,Be),ce.h.create(!1)),gt=Ee.pipe(O.w(se.fold((()=>N.E),(t=>t.initAssistantSession(Ke.actionEvents,e.alertsReader,He,e.alertsService,e.alertsList.state))))).subscribe(),ft=ke.pipe(O.w(se.fold((()=>N.E),(t=>t.initCardActionsProcessing(Ke.actionEvents,e.alertsReader,(0,o.aU)(He),(0,o.X5)(st,He),He))))).subscribe(),vt=Ke.actionEvents.subscribe((0,a.ls)((0,n.JH)(e.alertsReader,n.SV.Source.sidebar),ne.bw((e=>Ae.next(e)))));return{lensState:He,lensStateManager:mt,cardsViewModel:Ke,marksViewModel:tt,navigationViewModel:Ze,successLensViewModel:ht,alignmentViewModel:at,lensPreviewViewModel:Fe,cardsListScrollManager:it,notificationManager:nt,upgradeViewModel:We,modalManager:qe,capabilities:Be,upgradeHookFlow:Ye,dispose:()=>{vt.unsubscribe(),tt.dispose(),Ge.unsubscribe(),Re.unsubscribe(),$e.dispose(),gt.unsubscribe(),ft.unsubscribe(),Je.unsubscribe(),ze.dispose()}}}},40081:(e,t,i)=>{i.d(t,{t:()=>v});var a=i(71249),s=i(57050),n=i(40327),r=i(45614),o=i(32426),l=i(80800),c=i(66896),d=i(48439),u=i(64992),p=i(8125),m=i(22232),h=i(5114),g=i(50147),f=i(38983);class v{constructor(e,t,i){this._lensesList=e,this._alertsFilterService=t,this._scoreStatus=i,this.getLens=(0,p.HP)((function(e){switch(e){case c.R.SpecialId.AllAlerts:return this._lensesList.view(w(c.R.Info.allAlerts,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.AllAlerts)));case c.R.SpecialId.Priority:return this._lensesList.view(w(c.R.Info.priority,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.Priority)));case c.R.SpecialId.PredictionTakeaways:return this._lensesList.view(w(c.R.Info.predictionTakeaways,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.PredictionTakeaways)));case c.R.SpecialId.PredictionEmogenie:return this._lensesList.view(w(c.R.Info.predictionEmogenie,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.PredictionEmogenie)));case c.R.SpecialId.RealTimeProofit:return this._lensesList.view(w(c.R.Info.realTimeProofit,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.RealTimeProofit)));case c.R.SpecialId.Plagiarism:return this._lensesList.view(this._getPlagiarismLens);case c.R.SpecialId.Premium:return this._lensesList.view(w(c.R.Info.premium,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.Premium)));case c.R.SpecialId.FreePremiumAlerts:return this._lensesList.view(w(c.R.Info.freePremium,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(c.R.SpecialId.FreePremiumAlerts)));case c.R.SpecialId.Correctness:case c.R.SpecialId.Clarity:case c.R.SpecialId.Engagement:case c.R.SpecialId.Delivery:case c.R.SpecialId.Vox:case c.R.SpecialId.CorrectnessPriority:case c.R.SpecialId.ClarityPriority:case c.R.SpecialId.EngagementPriority:case c.R.SpecialId.DeliveryPriority:case c.R.SpecialId.VoxPriority:return this._lensesList.view(w(c.R.Info.createOutcome(e),c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(e)));case c.R.SpecialId.RealTimeProofit:return this._lensesList.view(w(c.R.Info.realTimeProofit,c.R.Meta.group.empty,this._alertsFilterService.getLensesFilter(e)));default:return(0,m.vE)(e)}})),this._outcomes=[c.R.SpecialId.Correctness,c.R.SpecialId.Clarity,c.R.SpecialId.Engagement,c.R.SpecialId.Delivery],this._previews=(0,p.HP)((()=>r.uX((0,o.getFirstSemigroup)(),a.IX)(this._outcomes,(e=>[e,this._getPreview(e)])))),this._isDocumentEmpty=f.h.create(!1),this._isFree=f.h.create(!1),this._outcomeStatusMask=f.h.combine(this._isDocumentEmpty,this._isFree,((e,t)=>{let i=0;return e&&(i|=u.x.IsDocumentEmpty),t&&(i|=u.x.IsFreeUser),i})),this._getPlagiarismLens=(0,s.ls)(w(c.R.Info.plagiarism,{...c.R.Meta.group.empty,percentile:d.T.MAX},this._alertsFilterService.getLensesFilter(c.R.SpecialId.Plagiarism)),c.R.WithAlerts.modifyMeta((e=>({...e,percentile:d.T.groupSum.concat(d.T.MAX,d.T.groupSum.inverse(e.percentile))}))))}findLens(e){return(0,n.pipe)(h.fromNullable([this.getLens(c.R.SpecialId.AllAlerts),this.getLens(c.R.SpecialId.Premium)].find((t=>e(t.get())))),h.map((e=>e.get().id)))}_getPreview(e){return{...c.R.Info.base,logo:h.none,...this._getOutcomeButtonData(e)}}get lensPreviews(){return this._previews()}_getOutcomeButtonData(e){const t=this.getLens(e),i=t.get().title,a=this._isFree.view((t=>t&&(e===c.R.SpecialId.Engagement||e===c.R.SpecialId.Delivery))),r=f.h.combine(t.view("count").view((e=>0===e)),a,((e,t)=>e&&!t)),{description:o,stateMessage:p}=(0,u.O)(e),m=f.h.combine(this._isDocumentEmpty,r,t.view("percentile"),((e,t,i)=>e?d.T.MIN:t?d.T.MAX:i)).view(d.g.fromRatio),g=f.h.create(!1),v=f.h.combine(this._scoreStatus.view((e=>(0,n.pipe)(e,h.map((e=>e===l.v0.ScoresStatus.SENSITIVE)),h.getOrElse(s.jv)))),t,m,this._outcomeStatusMask,g,p);return{id:e,title:i,description:o,status:v,progress:m,isUnavailable:a}}get nonEmptyLensId(){return(0,n.pipe)(h.fromNullable([this.getLens(c.R.SpecialId.AllAlerts),this.getLens(c.R.SpecialId.Premium)].find((e=>e.get().count>0))),h.map((e=>e.get().id)))}}function w(e,t,i){return a=>{return new c.R.LensImpl(e,(s=e.id,r=t,e=>(0,n.pipe)(g.P5(c.R.Id.ord)(s,e),h.getOrElse((()=>r))))(a),i);var s,r}}},62346:(e,t,i)=>{i.d(t,{gM:()=>Z,o$:()=>$,xl:()=>K});var a,s=i(57050),n=i(40327),r=i(33381),o=i(51972),l=i(95572),c=i(84286),d=i(95384),u=i(5817),p=i(66896),m=i(40018),h=i(51374),g=i(4390),f=i(9922),v=i(98403),w=i(59368),b=i(16746),_=i(17594),S=i(35416),y=i(25975),E=i(74364),k=i(77176),A=i(67434),I=i(2844),C=i(24209),M=i(85985),T=i(28043),x=i(41398),R=i(76974),F=i(32952),L=i(16118),P=i(40151),V=i(60797),O=i(24713),N=i(92843),B=i(71249),U=i(8125),D=i(5114),H=i(95195),G=i(83078),j=i(55415),W=i(22232),z=i(38983),q=i(81531);!function(e){e.create=(e,t,i,a,s,n)=>(r,o)=>{const l=o.to.visualState===w.Bd.highlighted;return d.sO.Change.getCreateAction({range:r,capiAlertId:e,visualState:l?{type:d.sO.Change.VisualState.Type.highlighted,source:t()}:{type:d.sO.Change.VisualState.Type.visible},highlightColor:i,highlightDisplayFormat:a(r(),l),highlightDisappearOnHoverDelay:s,order:n})},e.update=(e,t,i,a,s,n)=>(r,o)=>{const l=o.to.visualState===w.Bd.highlighted;return d.sO.Change.getUpdateAction({range:r,capiAlertId:e,visualState:l?{type:d.sO.Change.VisualState.Type.highlighted,source:t()}:{type:d.sO.Change.VisualState.Type.visible},highlightColor:i,highlightDisplayFormat:a(r(),l),highlightDisappearOnHoverDelay:s,order:n})},e.remove=e=>t=>d.sO.Change.getRemoveAction({range:t,capiAlertId:e})}(a||(a={}));const Z=(e,t)=>{const i=e.pipe(k.U(c.D.StrongAlertRef.getStrongAlertRefBulkDismissAlertIds)),a=t.pipe(k.U((e=>e.cards)),A.R(((e,t)=>(0,n.pipe)(t,N.v.reduce(e,((e,t)=>(e.delete(t.id),e)),((e,t,i)=>e.set(i.id,i.alertIds.map((e=>e.toString())))),((e,t)=>e.set(t.id,t.alertIds.map((e=>e.toString()))))))),new Map),k.U((e=>(0,n.pipe)(Array.from(e.values()),B.xH))),k.U((e=>new Set(e)))),s=t.pipe(k.U((e=>e.feedId===c.D.AssistantFeed.TONE_INSIGHTS_CARD_FEED_ID))),r=t.pipe(k.U((e=>e.feedId===c.D.AssistantFeed.BULK_DISMISS_CARD_FEED_ID))),o=t.pipe(k.U((e=>e.feedId===c.D.AssistantFeed.BULK_DISMISS_REVIEW_FEED_ID)));return I.aj([i,a,s,r,o]).pipe(k.U((([e,t,i,a,s])=>i?t=>!e.has(t.id):a||s?e=>t.has(e.id):i=>t.has(i.id)&&!e.has(i.id))))},K=(e,t,i,a=z.h.create(!1))=>C.T(e.pipe(M.h((e=>e.currentLens.id!==p.R.SpecialId.Premium)),T.x(((e,t)=>!(e.currentLens.id!==t.currentLens.id||S.nL.isWithPriorityList(e)&&S.nL.isWithPriorityList(t)&&y.v.WithPriority.isNonPriorityListOpened(e.currentLens)!==y.v.WithPriority.isNonPriorityListOpened(t.currentLens)))),T.x()),i.pipe(x.M(e),k.U((([e,t])=>t)))).pipe(x.M(a),k.U((([e,i])=>i?(0,U.W9)(m.bZ.isPremium,m.bZ.isHidden):t.alertVisibleInText(e.currentLens.id,y.v.WithPriority.nonPriorityAlertsVisible(e)))));class ${constructor(e,t,i,c,u,v,y,A,I=R.of(void 0),C=!1,T=z.h.create(!1)){this._alertList=e,this._alertsReader=t,this._positionManager=i,this._alertsService=c,this._ded=u,this._lensState=v,this._filterChanges=y,this._getActiveItemWithAlert=A,this._readyObs=I,this._emulateAppliedAlertAnimation=C,this._showYellowUnderlines=T,this._highlightedAlert=D.none,this._focusedAlert=D.none,this._marksMap=new Map,this._subs=new f.w.Keeper,this.events=new F.xQ,this._alertStateDiff=this._alertList.state.pipe(L.G(),k.U((([e,t])=>g.p.diff(e,t))),M.h((0,U.ff)(N.v.isEmpty))),this._alertsFilter=z.h.create(s.jv),this._filteredAlerts=z.h.create(D.none),this._ready=!1,this._log=q.C8.Logging.getLogger("marks_view_model"),this.getMarkByAlert=e=>(0,n.pipe)(this._marksMap.get(e.alert.id),D.fromNullable,D.chain((t=>t.markByIndex(e.highlightIndex)))),this.getAlertByMark=e=>(0,n.pipe)(this._alertsReader.getRegistered(h.P.fromRangeIdToAlertId(e.id)),D.chain((t=>(0,n.pipe)(E.$A.getHighlightIndex(t,e.range()),H.UI((e=>({alert:_.$.fromModel(t),highlightIndex:e}))),D.fromEither)))),this.ensureAlertHighlightInViewport=(e,t,i)=>(0,n.pipe)(this.getMarkByAlert(e),D.fold((()=>P.E),(e=>this._ded.scrollToMark(e.id,{animate:i,paddingTop:t})))),this._createMA=(e,t)=>{const i=t&&m.bZ.isPremium(e)&&m.bZ.isHidden(e),c=G.MH(e.rawId),{impact:u,cardLayout:{outcome:g},extra_properties:f}=e.toRawAlert(),v=r.M.getHighlightColor(l.DD.createOutcomeType(g),u,f,i),y=this._lensState.view(S.nL.getActiveItem(o.O.getActiveItemWithAlert)).view((0,s.ls)(D.filter((t=>t.activeAlert.id===e.id)),D.map((e=>e.activeHighlightIndex)),D.getOrElse((()=>0)))),k=e=>(t,i)=>{const a=h.x.isEnclosingView(t),s=e.getHighlightRanges().some(h.x.isEnclosingView),o=h.x.isMainView(t),l=h.x.isMainStartView(t),c=e.getHighlightRanges(),d=(0,n.pipe)(c,B.cx((e=>e.start===t.start&&e.end===t.end)),D.getOrElse((()=>0)))===y.get(),u=m.bZ.isSuperAlert(e);return r.M.getHighlightDisplayFormat({isEnclosing:a,isEnclosed:s,isMain:o,isMainStart:l,isActive:d,belongsToActiveAlert:i,belongsToSuperAlert:u})},A=p.R.getSortOrder(e.lensType),I=new b.v((t=>(0,n.pipe)(this._alertsReader.getById(e.id),D.alt((()=>(t&&this._log.warn("Could not find alert for provided MarkAlert",{alert:e,source:t}),D.some(e)))),D.map(_.$.fromModel),G.MH)),this._alertsService,this._alertsService,(e=>this._ded.changeMarks(e)),a.create(c,(()=>d.sO.Change.VisualState.Source.api),v,k(e),null,A),a.update(c,(()=>X.getAlertSource(e,this._lensState.get(),this._getActiveItemWithAlert)),v,k(e),null,A),a.remove(c),(t=>{t.to.visualState===w.Bd.applied&&(this.events.next({type:E.ay.Type.AppliedAlertAnimationFinished,alert:e}),this._handleRemovedAlerts([e]).forEach((e=>e.apply())))}));return this._marksMap.set(e.id,I),I},this._handleRemovedAlerts=e=>e.map((({id:e})=>{const t=this._marksMap.get(e);return this._marksMap.delete(e),t.scheduleApply(w.Bd.disposed),t})),this._handleAlertUpdate=(e,t)=>e.map((e=>m.bZ.isRegistered(e)&&!m.bZ.isMuted(e)?(0,n.pipe)(D.fromNullable(this._marksMap.get(e.id)),D.fold((()=>this._alertsFilter.get()(e)?this._createMA(e,t):null),(e=>(e.scheduleUpdate(),w.Oe.isOrWillBe(w.Bd.success)(e)&&e.scheduleApply(w.Bd.highlighted),e)))):(0,n.pipe)(D.fromNullable(this._marksMap.get(e.id)),D.fold((()=>{}),(t=>(e.allowUpdate&&m.bZ.isCapiDone(e)&&m.bZ.isRated(e)&&w.Oe.isOrWillBe(w.Bd.highlighted)(t)?(t.scheduleUpdate(),t.scheduleApply(w.Bd.success)):(t.scheduleApply(w.Bd.disposed),this._marksMap.delete(t.alert.id)),t)))))).filter((e=>Boolean(e))),this._subs.push(this._readyObs.subscribe((()=>{this._subs.push(this._listenAlertsUpdates(),this._listenRangesUpdates(),this._listenFilterChange(),this._listenFilteredAlerts()),this._ready=!0})))}focusAlertHighlight(e){return this._ready?(0,n.pipe)(this._marksMap.get(e.alert.id),D.fromNullable,D.map((t=>{this._focusedAlert=D.some(e.alert.id),t.scheduleApply(w.Bd.highlighted),t.scheduleForceUpdate(),t.apply()})),H.Yo((()=>new Error("Unknown alert"))),H.UI((()=>({dispose:()=>{D.exists((t=>t===e.alert.id))(this._focusedAlert)&&(this._highlightedAlert=D.none),(0,n.pipe)(this._marksMap.get(e.alert.id),D.fromNullable,D.filter((()=>!(0,n.pipe)(this._highlightedAlert,D.exists((t=>t===e.alert.id))))),D.map((e=>{e.scheduleApply(w.Bd.visible),e.apply()})))}})))):H.t$(new Error("marks view model is not ready yet"))}highlightAlertHighlight(e){return this._ready?(0,n.pipe)(this._marksMap.get(e.id),D.fromNullable,D.map((t=>{this._highlightedAlert=D.some(e.id),t.scheduleApply(w.Bd.highlighted),t.apply()})),H.Yo((()=>new Error("Unknown alert"))),H.UI((()=>({dispose:()=>{D.exists((t=>t===e.id))(this._highlightedAlert)&&(this._highlightedAlert=D.none),(0,n.pipe)(this._marksMap.get(e.id),D.fromNullable,D.filter((()=>!(0,n.pipe)(this._focusedAlert,D.exists((t=>t===e.id))))),D.map((e=>{e.scheduleApply(w.Bd.visible),e.apply()})))}})))):H.t$(new Error("marks view model is not ready yet"))}moveCursorToHighlight(e,t){return this._ready?(0,n.pipe)(this._marksMap.get(e.alert.id),D.fromNullable,D.chain((t=>t.markByIndex(e.highlightIndex))),D.chain((e=>D.fromEither(e.range()))),D.fold((()=>H.t$(new Error("Cannot find mark for given range"))),(e=>{const{index:i,length:a}=this._ded.getCursor();if(0===a&&(i<e.start||i>e.end)){const i=Math.min(e[t],this._ded.getLastPossibleCursorPosition());return(0,n.pipe)(this._ded.setCursor(i,0),H.vx(H.t$))}return H.F2(void 0)}))):H.t$(new Error("marks view model is not ready yet"))}dispose(){this._subs.dispose()}_listenAlertsUpdates(){const e=e=>({activeAlerts:[],updatedAlerts:[],removedAlerts:[],acceptedAlerts:[],hiddenMarkAlerts:[],...e});return C.T(this._filteredAlerts.pipe(V.cp((({visible:t,hidden:i})=>R.of(e({activeAlerts:j.qo(t),removedAlerts:j.qo(i)}))))),this._alertStateDiff.pipe(x.M(this._alertsFilter),k.U((([t,i])=>(0,n.pipe)(t,N.v.reduce(e({}),((e,t)=>(this._marksMap.has(t.alert.id)&&e.removedAlerts.push(t.alert),e)),((e,t,i)=>(m.bZ.isAccepted(i.alert)?e.acceptedAlerts.push(i.alert):e.updatedAlerts.push(i.alert),e)),((e,t)=>(i(t.alert)&&e.activeAlerts.push(t.alert),e)))))))).pipe(x.M(this._showYellowUnderlines),k.U((([{activeAlerts:e,removedAlerts:t,updatedAlerts:i,acceptedAlerts:a},s])=>{let n=[];return n=n.concat(e.filter((0,U.W9)((0,U.Kg)((e=>s&&m.bZ.isPremium(e)&&m.bZ.isHidden(e)),(0,U.ff)(m.bZ.isPremium)),(e=>D.isSome(e.rawId)))).map((e=>{const t=this._marksMap.get(e.id);return void 0!==t?(t.scheduleForceUpdate(),t):this._createMA(e,s)}))),this._emulateAppliedAlertAnimation&&setTimeout((()=>{a.forEach((e=>{this.events.next({type:E.ay.Type.AppliedAlertAnimationFinished,alert:e})}))}),3*(0,u.Xd)(20)),n=n.concat(this._handleRemovedAlerts(t.concat(a).filter((e=>this._marksMap.has(e.id))))),n=n.concat(this._handleAlertUpdate(i,s)),n}))).subscribe((e=>{if(e.length>0){const[t,...i]=e;t.applyWith(i)}}))}_listenRangesUpdates(){return this._positionManager.rangeChanged.pipe(O.j("changed"),k.U((e=>e.filter((e=>h.P.is(e)&&h.x.isVisible(e)&&this._marksMap.has(e.meta.alertId))))),M.h((e=>e.length>0))).subscribe((e=>{const t=Array.from(e.values()).reduce(((e,t)=>(0,n.pipe)(this._alertsReader.getById(t.meta.alertId),D.chain((e=>this._alertsReader.getRegistered(e.id))),D.chain((e=>D.fromNullable(this._marksMap.get(e.id)))),G.bw((t=>e.set(t.alert.id,t))),(0,s.a9)(e))),new Map),i=Array.from(t.values());if(i.forEach((e=>{e.scheduleForceUpdate()})),i.length>0){const[e,...t]=i;e.applyWith(t)}}))}_listenFilterChange(){return this._filterChanges.subscribe((e=>{v.wW(this._alertsFilter)(e)}))}_listenFilteredAlerts(){return this._alertsFilter.pipe(x.M(this._alertList.state),k.U((([e,t])=>(0,n.pipe)(t,g.p.reduce({visible:{},hidden:{}},((t,i)=>(e(i.alert)&&m.bZ.isRegistered(i.alert)?t.visible[i.alert.id]=i.alert:t.hidden[i.alert.id]=i.alert,t))),(e=>D.some(e)))))).subscribe(v.wW(this._filteredAlerts))}}var X;!function(e){e.toSidebarFluidMarkSource=e=>{switch(e){case m.l$.text:case S.h8.forceText:return d.sO.Change.VisualState.Source.text;case m.l$.sidebar:case S.h8.forceSidebar:return d.sO.Change.VisualState.Source.sidebar;case m.l$.api:return d.sO.Change.VisualState.Source.api;default:return(0,W.vE)(e)}},e.getAlertSource=(t,i,a)=>S.nL.hasCards(i)?(0,n.pipe)(a(i.currentLens),D.fold((()=>d.sO.Change.VisualState.Source.api),(a=>a.activeAlert.id===t.id?e.toSidebarFluidMarkSource(i.alertSource):d.sO.Change.VisualState.Source.api))):d.sO.Change.VisualState.Source.api}(X||(X={}))},780:(e,t,i)=>{i.d(t,{o:()=>F});var a=i(40327),s=i(73582),n=i(73353),r=i(98782),o=i(83078),l=i(55415),c=i(8125),d=i(5114);function u({documentModel:e,features:t,gnar:i,modalOperations:u,upgradeVM:p,source:m}){return(0,r.k)(e,function(e,t,i){return{goalsPopupShow:t=>e.goalsPopupShow(t),getPremiumButtonClick:()=>e.getPremiumButtonClick("goPremium","setGoalsPopup"),goalsFormSuccess:(s,n)=>{const r=()=>o.FX("academic")(s.domain)&&t;return e.goalsFormSuccess((0,a.pipe)(s.domain,d.getOrElse((()=>n.domain))),(0,a.pipe)(s.goals,d.map((e=>r()?[]:e)),d.getOrElse((()=>n.goals)),(e=>Array.from(e))),i,(0,a.pipe)(s.outcomeContext,d.filter(r),d.map(l.ei("type")),d.toUndefined),(0,a.pipe)(s.audience,d.filter((0,c.ff)(r)),d.toUndefined),(0,a.pipe)(s.outcomeContext,d.filter(r),d.map(l.ei("citation")),d.toUndefined),(0,a.pipe)(s.style,d.filter((0,c.ff)(r)),d.toUndefined))}}}(i,t.isStudentsOFE,m),u,m,n.R$.defaultContextFallback,t,(()=>p.openUpgradeUrl(s.L.Place.gdocsGoals)),!1)}var p=i(98403),m=i(18625),h=i(57091),g=i(66310),f=i(76974),v=i(13444),w=i(93508),b=i(48403),_=i(95343),S=i(25970),y=i(95195),E=i(38983),k=i(81531);class A{constructor(e,t){this._documentModel=e,this._modalOperations=t,this.reportViewModel=d.none,this.state=m.P((()=>p.GQ((()=>this._documentModel.calculateStats())))).pipe(h.a(this._documentModel.checkingState,((e,t)=>(0,a.pipe)(e,d.filter((()=>"idle"===t))))),g.w(d.fold((()=>f.of({type:S.g.State.Type.LOADING}).pipe(v.g(150))),y.g_((e=>(k.C8.Logging.getLogger("editor.toolbar").error("Error on requesting document stats",e),this.onModalClose(),f.of({type:S.g.State.Type.ERROR}))),(e=>E.h.combine(this._documentModel.score,this._documentModel.counters,this._documentModel.documentLength.view("trimmed"),((t,i,s)=>(0,a.pipe)(t,d.fold((()=>({type:S.g.State.Type.SHORT_CONTENT})),(t=>({type:S.g.State.Type.READY,documentIsEmpty:0===s,score:t,counters:i,stats:e})))))))))),w.O({type:S.g.State.Type.EMPTY}),b._(1),_.x()),this.onModalClose=()=>{this._modalOperations.onClose()}}}var I=i(81301),C=i(22621),M=i(9690),T=i(77176),x=i(22232),R=i(31881);class F{constructor(e,t,i,a,s=!1){this._documentModel=e,this._upgradeViewModel=t,this._isPremiumUser=i,this._gnar=a,this._isStudentsOFE=s}load(e){switch(e.type){case I.dC.SetGoals:return this._loadSetGoals(e.source);case I.dC.Performance:return this._loadPerformance();default:return(0,x.vE)(e)}}_loadSetGoals(e){return Promise.resolve((t=>{const i=u({features:{demoMode:!1,isRedesign:!1,isFree:!this._isPremiumUser,isStudentsOFE:this._isStudentsOFE},documentModel:this._documentModel,upgradeVM:this._upgradeViewModel,source:e,modalOperations:t,gnar:this._gnar});return{instance:{type:I.dC.SetGoals,source:e},component:R.UI.mount(C.R.Modal,i)}}))}_loadPerformance(){return Promise.resolve((e=>{const t=new A(this._documentModel,e),i=R.UI.Knot.make(M.q.ModalView,{downloadButton:R.UI.Node.empty}),a=R.Z.fromSideEffect((t=>{if(t.action.kind===M.q.ActionsKind.close)e.onClose();else(0,x.vE)(t.action.kind)}),t.state.pipe(T.U((e=>({root:e})))));return{instance:{type:I.dC.Performance},component:R.UI.mount(i,a)}}))}}},37290:(e,t,i)=>{if(i.d(t,{$:()=>S}),3075==i.j)var a=i(57050);if(3075==i.j)var s=i(77394);if(3075==i.j)var n=i(81301);if(3075==i.j)var r=i(40018);if(3075==i.j)var o=i(66896);if(3075==i.j)var l=i(32952);if(3075==i.j)var c=i(9922);if(3075==i.j)var d=i(41398);if(3075==i.j)var u=i(77176);if(3075==i.j)var p=i(85985);if(3075==i.j)var m=i(66310);if(3075==i.j)var h=i(40151);if(3075==i.j)var g=i(4890);if(3075==i.j)var f=i(35416);if(3075==i.j)var v=i(91605);if(3075==i.j)var w=i(5114);if(3075==i.j)var b=i(22232);if(3075==i.j)var _=i(38983);class S{constructor(e,t,i,s,n,m,h,b){this._state=e,this._lensPreviewVM=t,this._sidebarEvents=i,this._modalManager=s,this._ded=n,this._features=m,this._gnar=h,this._defaultLensMode=b,this.isUphooksRedesign=!1,this.popover=_.h.create(w.none),this.events=new l.xQ,this.activeLensId=this._state.view("currentLens","id"),this.documentActions=_.h.create({proofit:v.Bo.proofitDisabled(v.TV.NotAvailable),plagiarism:v.Bo.plagiarismDisabled(v.eh.NotAvailable)}),this.showMuteControl=_.h.create(!1),this._subs=new c.w.Keeper,this._lensSwitch=new l.xQ,this.lensMode=_.h.create(this._defaultLensMode),this.lensTitleType="none"!==this._features.priorityLens.kind?v.Bo.LensTitleType.priority:v.Bo.LensTitleType.default,this.lensChangeEffect={id:"lensChangeEffect",when:a.W8,what:f.nL.Effect.SwitchLens.create(this._lensSwitch.pipe(d.M(this._state.pipe(u.U((e=>e.currentLens.id)))),p.h((([{lensId:e},t])=>e!==t)),u.U((([{lensId:e,focusFirst:t}])=>({lensId:e,alertSource:r.l$.sidebar,options:{order:"lensOrder",toFocus:t?f.nL.Effect.FocusBehavior.focusFirst:f.nL.Effect.FocusBehavior.noFocus}})))))},this.cardVisualMode=_.h.create(g.j.CardVisualMode.RegularLightMode),this._listenNavigationEvent();const S=[o.R.SpecialId.Correctness,o.R.SpecialId.Clarity,o.R.SpecialId.Engagement,o.R.SpecialId.Delivery].reduce(((e,t)=>(e[t]=this._lensPreviewVM.lensPreviews[t],e)),{});this.lensPreviews=_.h.create(S),this.a11yContrast=!1}dispose(){this._subs.dispose()}_listenNavigationEvent(){this._subs.push(this.events.pipe(m.w((e=>{switch(e.type){case"toggleSidebar":return this._sidebarEvents.next({kind:s.R.Close}),h.E;case"switchToLens":if("none"!==this._features.priorityLens.kind){const t=e.id===o.R.SpecialId.Priority?"priority":"all";this._sidebarEvents.next({kind:s.R.ChangeLens,selectedLens:t}),this._lensSwitch.next({lensId:e.id,focusFirst:e.focusFirst}),this._gnar.gdocsSidebarChangeLensButtonClick(t,this._lensPreviewVM.getLens(o.R.SpecialId.AllAlerts).get().count,this._ded.getTextLength(),this._lensPreviewVM.getLens(o.R.SpecialId.Priority).get().count,"dropdown"===this._features.priorityLens.kind?"dropdown":"priorityToggle")}else this._gnar.gdocsSidebarOpenLensButtonClick(e.id);return h.E;case"setGoals":return this._modalManager.show(n.Iy.setGoals("user"));case"performance":return this._modalManager.show(n.Iy.performance);case"switchToCritical":case"switchToAdvanced":case"preferences":case"switchToAll":return h.E;default:return(0,b.vE)(e)}}))).subscribe())}}},73582:(e,t,i)=>{i.d(t,{L:()=>a,x:()=>S});var a,s=i(40327),n=i(65421),r=i(39354),o=i(65451),l=i(66896),c=i(40018),d=i(6782),u=i(4390),p=i(2844),m=i(77176),h=i(98403),g=i(5114),f=i(8125),v=i(95574),w=i(95195),b=i(38983),_=i(81531);!function(e){let t;!function(e){e.gdocsSidebarCardList="gdocsSidebarCardList",e.gdocsSidebarSuccessView="gdocsSidebarSuccessView",e.gdocsGoals="gdocsGoals",e.gdocsSidebarAnonymousCard="gdocsSidebarAnonymousCard",e.assistantCardList="assistantCardList",e.extensionSettingsAssistant="extensionSettingsAssistant",e.toneSuggestion="toneSuggestion"}(t=e.Place||(e.Place={}))}(a||(a={}));class S{constructor(e,t,i){this._alertsList=e,this._lensState=t,this._maxAlertCategories=i,this._log=_.C8.Logging.getLogger("UpgradeViewModel"),this._advancedAlerts=b.h.create([]),this.advancedAlerts=this._advancedAlerts.view((e=>e.length>0?g.some({count:e.length,alerts:()=>this._formatLiteAlerts(S._getGroupedLiteAlerts(e))}):g.none)),this._formatLiteAlerts=e=>{const t=e.slice(0,this._maxAlertCategories),i=e.slice(this._maxAlertCategories).map((e=>e.count)).reduce(f.Sm,0);return i>0?[...t,{group:"",category:"",categoryHuman:"more...",count:i,lensName:"",bundleInfo:g.none}]:t},this._connectionId=o._.create("sidebar"),p.aj([this._lensState.view("currentLens").view("id").view(l.R.isPriority).view((e=>e?e=>c.bZ.isRegistered(e)&&c.bZ.isPremium(e)&&c.bZ.isPriority(e):e=>c.bZ.isRegistered(e)&&c.bZ.isPremium(e))),this._alertsList.state]).pipe(m.U((([e,t])=>u.p.reduce([],((t,{alert:i})=>(e(i)&&t.push(i),t)))(t)))).subscribe(h.wW(this._advancedAlerts))}openUpgradeUrl(e){(0,s.pipe)(v.vM((()=>{(0,r.P4)().openSubscriptionDialog({currentAlerts:this._getCapiAlerts(),isAnonymousUser:!1,isFromEmail:!1,forceUtmCampaign:e})})),w.fS((e=>this._log.fatal("unexpected error on open upgrade page",e))))}_getCapiAlerts(){return this._advancedAlerts.get().map((e=>(0,n.IM)(S._toRawAlertWithPossibleWrongId(e),o.Q.create(this._connectionId,0))))}static _getGroupedLiteAlerts(e){return d.Q.group(e.map((e=>e.toLiteAlert())))}static _toRawAlertWithPossibleWrongId(e){return{...e.toRawAlert(),id:(0,s.pipe)(e.rawId,g.getOrElse((()=>e.id)))}}}},33953:(e,t,i)=>{if(i.d(t,{r:()=>p}),3075==i.j)var a=i(6782);if(3075==i.j)var s=i(40018);if(3075==i.j)var n=i(4390);if(3075==i.j)var r=i(14601);if(3075==i.j)var o=i(2844);if(3075==i.j)var l=i(77176);if(3075==i.j)var c=i(28043);if(3075==i.j)var d=i(5114);if(3075==i.j)var u=i(38983);class p{constructor(e,t){this._alertsList=e,this._lensState=t,this._sub=new r.w,this._freeAlerts=u.h.create([]),this.freeAlerts=this._freeAlerts.view((e=>e.length>0?d.some({count:e.length,alerts:()=>function(e){return a.Q.group(e.map((e=>e.toLiteAlert())))}(e)}):d.none)),this._sub.add(o.aj([this._lensState.view("currentLens").view("id").view((()=>e=>s.bZ.isRegistered(e)&&!s.bZ.isHidden(e)&&!s.bZ.isPremium(e))),this._alertsList.state]).pipe(l.U((([e,t])=>n.p.reduce([],((t,{alert:i})=>(e(i)&&t.push(i),t)))(t))),c.x()).subscribe((e=>{this._freeAlerts.set(e)})))}dispose(){this._sub.unsubscribe()}}},57635:(e,t,i)=>{i.d(t,{V:()=>u});var a=i(27378),s=i(22679),n=i(20855),r=i(3860),o=i(29758),l=i(12187),c=i(5739),d=i(12267);const u=({draggableRef:e,headerContent:t,className:i,children:u,includeContentPadding:p,footer:m,dataGrammarlyPart:h="single-card-assistant",onHeightChange:g})=>{const[f,v]=a.useState(0),[w,b]=a.useState(0),[_,S]=a.useState(0),[y,E]=a.useState("visible"),[k,A]=a.useState(null),I=a.useRef(null),C=a.useRef(null),M=a.useRef(null);a.useEffect((()=>{null==g||g(f+w+_)}),[f,w,_]);const T=a.useRef(null);a.useEffect((()=>{var e;return I.current?(null===(e=T.current)||void 0===e||e.disconnect(),T.current=o.N.getResizeObserver((()=>{I.current&&v(I.current.getBoundingClientRect().height)})),T.current.observe(I.current)):v(0),()=>{var e;return null===(e=T.current)||void 0===e?void 0:e.disconnect()}}),[I.current]);const x=a.useRef(null);a.useEffect((()=>{var e;return C.current?(null===(e=x.current)||void 0===e||e.disconnect(),x.current=o.N.getResizeObserver((()=>{C.current&&b(C.current.getBoundingClientRect().height)})),x.current.observe(C.current)):b(0),()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.disconnect()}}),[C.current]);const R=a.useRef(null);return a.useEffect((()=>{var e;return M.current?(null===(e=R.current)||void 0===e||e.disconnect(),R.current=o.N.getResizeObserver((()=>{M.current&&S(M.current.getBoundingClientRect().height)})),R.current.observe(M.current)):S(0),()=>{var e;return null===(e=R.current)||void 0===e?void 0:e.disconnect()}}),[m,M.current]),a.useEffect((()=>{C.current&&(C.current.scrollTop=0)}),[C.current,w]),a.useEffect((()=>{E("hidden"),A(u);const e=self.setTimeout((()=>E("visible")),300);return()=>self.clearTimeout(e)}),[u]),a.createElement("div",{...(0,l.Sh)(d.singleCardAssistant,i),"data-grammarly-part":h},a.createElement("div",{"data-grammarly-part":h+"-header",...(0,l.Sh)(d.singleCardAssistantHeader,e?d.singleCardAssistantHeaderDraggable:null),ref:t=>{I.current=t,null==e||e(t)}},a.createElement(c.F.Fragment,null,t)),a.createElement("div",{"data-grammarly-part":h+"-content",...(0,l.Sh)(d.singleCardAssistantContent,p?d.singleCardAssistantContentWithPadding:null),style:{height:w,overflow:y,transitionProperty:"height",transitionDuration:"300ms"},onTransitionEnd:e=>{"height"===e.propertyName&&E("visible")}},a.createElement("div",{ref:C},k)),m?a.createElement("div",{"data-grammarly-part":h+"-footer",className:d.singleCardAssistantFooter,ref:M,onClick:()=>m.onClick()},a.createElement("div",{className:d.singleCardAssistantFooterText},m.content),a.createElement(n.u,{message:m.tooltip,showDelay:s.gk},a.createElement(r.h,{onClick:()=>m.onClick()},a.createElement("div",{className:d.singleCardAssistantFooterButtonIcon})))):null)}},80895:(e,t,i)=>{i.d(t,{C:()=>r});var a=i(27378),s=i(12187),n=i(12935);const r=({kind:e="primary",dataGrammarlyPart:t="ui-kit-badge",title:i,boldTitle:r=!1,className:o,...l})=>a.createElement("div",{"data-grammarly-part":t,...(0,s.Sh)(n.badge,o,"primary"===e?n.badgePrimary:null,"success"===e?n.badgeSuccess:null,"gold"===e?n.badgeGold:null,"error"===e?n.badgeError:null,l.rounded?n.badgeRounded:null,!l.rounded||l.size&&"small"!==l.size?null:n.badgeRoundedSmall,l.rounded&&"medium"===l.size?n.badgeRoundedMedium:null,l.rounded&&"large"===l.size?n.badgeRoundedLarge:null)},a.createElement("div",{...(0,s.Sh)(n.badgeTitle,r?n.badgeTitleBold:null)},i))},86705:(e,t,i)=>{i.d(t,{v:()=>n});var a=i(27378),s=i(80895);const n=({browser:e,className:t,title:i="BETA"})=>"safari"!==e?a.createElement(s.C,{title:i,className:t}):null},29417:(e,t,i)=>{i.d(t,{l:()=>d});var a=i(27378),s=i(22679),n=i(3860),r=i(20855),o=i(12187),l=i(75100),c=i.n(l);const d=({enableTooltip:e=!1,size:t="medium",...i})=>a.createElement(r.u,{message:"Settings",showDelay:s.gk,disabled:!e},a.createElement(n.h,{...i},a.createElement("div",{...(0,o.Sh)("small"===t?c().settingsButtonSmallIcon:null,"medium"===t?c().settingsButtonMediumIcon:null)})))},31944:(e,t,i)=>{i.d(t,{J:()=>o});var a=i(57050),s=i(27378),n=i(12187),r=i(22536);const o=({onChange:e,labelId:t,className:i,checkboxClassName:o,labelClassName:l,checked:c,children:d,disabled:u,useDS:p,dataGrammarlyPart:m="ui-kit-checkbox",tabIndex:h=0})=>{const[g,f]=s.useState(null!=c&&c);s.useEffect((()=>{f(Boolean(c))}),[c]);const v=t=>{t.preventDefault(),t.stopPropagation(),f(!g),null==e||e(!g)};return s.createElement("div",{"data-grammarly-part":m,...(0,n.Sh)(r.checkboxContainer,i)},s.createElement("div",{...(0,n.Sh)(r.checkbox,o,g?r.checkboxChecked:null,p?r.checkboxDS:null),role:"checkbox","aria-checked":g,tabIndex:h,"aria-labelledby":t,onKeyDown:e=>{" "===e.key&&v(e)},onClick:u?a.Q1:v},g?s.createElement("div",{className:r.checkboxCheckmark}):null),s.createElement("label",{id:t,onClick:v,className:l},d))}},26315:(e,t,i)=>{i.d(t,{z:()=>c});var a=i(27378),s=i(31542);const n=({children:e,style:t,dataGrammarlyPart:i="ui-kit-iframe",...n})=>{const[r,o]=a.useState(null),l=a.useCallback((e=>{var t,i;let a=null;"contentDocument"in e.target&&(a=null!==(i=null===(t=e.target.contentDocument)||void 0===t?void 0:t.body)&&void 0!==i?i:null),o(a),a&&(a.style.margin="0",a.style.height="100vh")}),[]);return a.createElement("iframe",{...n,style:{border:"none",...t},onLoad:l,srcDoc:"<html><body></body></html>","data-grammarly-part":i},r&&(0,s.createPortal)(e,r))};var r=i(68370),o=i(51897),l=i.n(o);const c=({placeholder:e,onChange:t,ariaLabel:i,className:s})=>{const[o,c]=a.useState("");return a.useEffect((()=>{t(o)}),[o]),a.createElement(n,{dataGrammarlyPart:"ui-kit-textbox",className:s,style:{width:"100%",height:"100%"}},a.createElement(r.b,null,l().__css),a.createElement("div",{role:"textbox",className:l().textBox,contentEditable:!0,onInput:e=>c(e.target.innerText),"data-placeholder":e,"aria-placeholder":e,"aria-label":i}))}},81108:(e,t,i)=>{i.d(t,{Q:()=>o});var a=i(27378),s=i(90361),n=i(10247);const r=e=>{if(e.reason===n.rS.NO_FREE_TRIALS_LEFT){const t="No email reviews left this month";let i;if(e.meta.quotaResetDate){const t=Intl.DateTimeFormat([],{month:"short",day:"numeric"}).format(new Date(Date.parse(e.meta.quotaResetDate)));i=`You will get ${n.SR} free reviews again next month (${t}). You can also use paid expert writing help in Grammarly's web editor anytime.`}else i=`You will get ${n.SR} free reviews again next month. You can also use paid expert writing help in Grammarly's web editor anytime.`;return{title:t,message:i}}return e.reason===n.rS.NOT_ENOUGH_WORDS?{message:`Your email must be at least ${n.fy} words (currently ${e.meta.wordsCount}).`}:e.reason===n.rS.TOO_MANY_WORDS?{message:`Your email must be under ${n.Vw} words (currently ${e.meta.wordsCount}).`}:(e=>{switch(e){case n.rS.NOT_AVAILABLE:return{message:"Our experts are currently working on other text. Please try again later."};case n.rS.NOT_AVAILABLE_QUOTA_ERROR:return{title:"Something went wrong",message:"We couldn't determine how many requests you have left. Please try again later."};case n.rS.CONFLICTING_REQUEST:return{title:"Separate request in progress",message:"You can submit this request once the experts are finished with the one you already submitted."};case n.rS.CHECKING_INITIAL_AVAILABILITY:return{message:"Checking for available experts..."};case n.rS.UNSUPPORTED_LANGUAGE:return{message:"Our writing experts can only help with emails written in English."};default:(0,s.vE)(e)}})(e.reason)},o=({info:e,includeTitle:t})=>{const i=r(e);return a.createElement(a.Fragment,null,t?a.createElement(a.Fragment,null,i.title?a.createElement("b",null,i.title):a.createElement("b",null,"Get expert writing help"),a.createElement("br",null)):null,i.message)};o.defaultProps={includeTitle:!1}},53844:(e,t,i)=>{i.d(t,{q5:()=>h,dK:()=>m});var a=i(27378),s=i(12187),n=i(21420);const r=({options:e,onChange:t=(()=>null),ariaLabel:i,className:r})=>{const o=[],[l,c]=a.useState(null);a.useEffect((()=>{var i;null!==l&&(null===(i=o[l])||void 0===i||i.focus()),t(null!==l?e[l].value:null)}),[l]);const d=null!==l?e[l]:null;return a.createElement("div",{"data-grammarly-part":"ui-kit-radio-group",className:r},a.createElement("div",{className:n.radioGroup,role:"radiogroup","aria-label":i,onKeyDown:t=>{if(" "!==t.key||d){if("ArrowRight"===t.key||"ArrowDown"===t.key){t.preventDefault(),t.stopPropagation();c(((l||0)+1)%e.length)}else if("ArrowLeft"===t.key||"ArrowUp"===t.key){t.preventDefault(),t.stopPropagation();const i=(l||0)-1;c(i<0?e.length-1:i)}}else t.preventDefault(),t.stopPropagation(),c(0)}},e.map(((e,t)=>{const i=(null==d?void 0:d.value)===e.value,r=0===t;return a.createElement("div",{key:e.value,...(0,s.Sh)(n.radioGroupOption,i?n.radioGroupOptionSelected:null),role:"radio",tabIndex:i||r&&!d?0:-1,"aria-checked":i,onClick:e=>{e.preventDefault(),e.stopPropagation(),c(t)},ref:e=>o.push(e)},e.render())}))))};var o,l=i(24606),c=i(26315),d=i(31944),u=i(51217),p=i(44544);function m(e){return"score"in e}!function(e){e.bad="bad",e.ok="ok",e.good="good"}(o||(o={}));const h=({hideLogo:e=!1,align:t="center",fixSubmitButtonOverflowBottomPadding:i=!1,...n})=>{var m;const h=[o.bad,o.ok,o.good],[g,f]=a.useState(null),[v,w]=a.useState(""),[b,_]=a.useState(!1),[S,y]=a.useState(!1);let E;return E=S&&!1!==n.showPostSubmitScreen?a.createElement("div",{"data-grammarly-part":"surveys-feedback-form-thank-you",...(0,s.Sh)(u.feedbackFormContainer,u.feedbackFormContainerAlignCenter)},a.createElement("div",{className:u.feedbackFormSuccessMessageTextContainer},a.createElement("div",{className:u.feedbackFormSuccessMessageIcon}),a.createElement("div",{className:u.feedbackFormSuccessMessageTitle},"Thank you!"),a.createElement("div",{className:u.feedbackFormSuccessMessageSubtitle},"Your feedback helps us improve.")),a.createElement(l.z,{className:u.feedbackFormSubmitButton,kind:"success",type:"submit",onClick:n.onClose},"Done"),i?a.createElement("div",{className:u.feedbackFormSubmitButtonFixOverflowBottomPadding},a.createElement("div",{className:u.feedbackFormSubmitButtonFixOverflowBottomPaddingChild})):null):a.createElement("div",{"data-grammarly-part":"surveys-feedback-form-fields",...(0,s.Sh)(u.feedbackFormContainer,"center"===t?u.feedbackFormContainerAlignCenter:null)},a.createElement("div",{className:u.feedbackFormFields},e?null:a.createElement("div",{className:u.feedbackFormLogo}),n.hideTitle?null:a.createElement("div",{...(0,s.Sh)(u.feedbackFormTitle,n.compactDisplay?u.compact:null)},n.title||a.createElement("span",null,"How do you like ",a.createElement("br",null)," Grammarly?")),n.withScore?a.createElement(a.Fragment,null,a.createElement(r,{ariaLabel:"Feedback Score",options:h.map((e=>({value:e,render(){let t,i;return e===o.bad?(t=p.feedbackFormOptionIconDisheartening,i="I dislike it"):e===o.ok?(t=p.feedbackFormOptionIconNeutral,i="It’s OK"):(t=t=p.feedbackFormOptionIconSmiling,i="I like it"),a.createElement("div",{className:p.feedbackFormOption},a.createElement("div",{...(0,s.Sh)(p.feedbackFormOptionIcon,t)}),a.createElement("div",null,i))}}))),onChange:f,...(0,s.Sh)(u.feedbackFormScore,n.compactDisplay?u.compact:null)}),n.hideTextBoxTitle?null:a.createElement("div",{className:u.feedbackFormTextBoxTitle},"Anything we can improve?")):null,a.createElement(c.z,{onChange:w,placeholder:n.placeholderText||"Your thoughts here",ariaLabel:"Feedback Text",...(0,s.Sh)(u.feedbackFormTextBox,n.compactDisplay?u.compact:null)}),n.domain?a.createElement(a.Fragment,null,n.hideDomainHelpText?null:a.createElement("div",{className:u.feedbackFormShareDomainTitle},"Help improve Grammarly by sharing the domain you’re on:"),a.createElement(d.J,{labelId:"feedback-form-share-domain-checkbox",onChange:_,className:u.feedbackFormShareDomainCheckbox},"Include the domain ",a.createElement("b",null,n.domain)," with my feedback")):null),a.createElement(l.z,{className:u.feedbackFormSubmitButton,kind:null!==(m=n.submitButtonKind)&&void 0!==m?m:"success",type:"submit",disabled:n.withScore?!g:!v,onClick:()=>{var e,t;n.withScore&&g?(null===(e=n.onSubmit)||void 0===e||e.call(n,{score:g,text:v,domain:b?n.domain:void 0}),y(!0)):!n.withScore&&v&&(null===(t=n.onSubmit)||void 0===t||t.call(n,{text:v,domain:b?n.domain:void 0}),y(!0))}},"Submit"),i?a.createElement("div",{className:u.feedbackFormSubmitButtonFixOverflowBottomPadding},a.createElement("div",{className:u.feedbackFormSubmitButtonFixOverflowBottomPaddingChild})):null),a.createElement("div",{style:n.style,"data-grammarly-part":"surveys-feedback-form"},E)}},24372:(e,t,i)=>{i.d(t,{J:()=>s});var a=i(64408);const s=new Proxy({},{get:(e,t)=>(...e)=>a.emitBackground("gnar-track",{method:t,props:e})})},25682:(e,t,i)=>{var a=i(93476)((function(e){return e[1]}));a.push([e.id,"._380Y1-textBox{font-family:grInter,sans-serif;font-style:normal;font-weight:normal;color:#0e101a;font-size:14px;line-height:21px;font-feature-settings:'ss03' on;background:#f9faff;border:1px solid #e7e9f5;box-sizing:border-box;border-radius:4px;padding:10px 8px;overflow-y:auto;cursor:text;width:100%;height:100%;}._380Y1-textBox:empty:before{font-feature-settings:'ss03' on;font-family:grInter,sans-serif;font-style:normal;font-weight:normal;color:#6d758d;font-size:14px;line-height:21px;content:attr(data-placeholder)}",""]),a.locals={textBox:"_380Y1-textBox"},e.exports=a},58346:e=>{e.exports={singleCardAssistant:"_3vNtD",singleCardAssistantNativeContentWithPadding:"_3-Sw7",singleCardAssistantSettingsDoneButton:"OMpnq"}},33751:e=>{e.exports={cardList:"_1Eape",cardListFooterDynamic:"Inkbe",cardListFooterStatic:"_7OpWh",cardListFooterAnimate:"_29PbU",upgradeHookWrapper:"_9GpAY",assistant:"AnaVG",dragging:"_1XWvb",mainView:"_38aRY"}},57556:e=>{e.exports={emogenieViewOverlayHeader:"_2Xrrv",emogenieViewOverlayHeaderBetaBadge:"qG0e8"}},90282:e=>{e.exports={footerButton:"_2rtYm",feedbackButton:"ywPnS"}},78846:e=>{e.exports={actions_hovered:"Xf2Pk",header:"_3p6xo",draggableWrapper:"_2_Oau",draggable:"_1m9e2",headerActions:"_2asjJ",headerActionBtnProofitIcon:"_1GEsJ",headerActionBtnGoalsIcon:"_1ZjAn",logoscore_fadein:"xzxut",fadein:"_30rWn",logoscore_fadeout:"_1DBSi",fadeout:"_24pVK",logo_score:"_6nCpo",spin:"_2gcAi"}},19217:e=>{e.exports={insight:"_3o8h_",insight__inline_icon:"svSbC",insight__inline_text:"_3Uft0"}},98029:e=>{e.exports={predictions:"_3feHG",predictions__header:"_35Gcg",predictions__card:"_2xc9F",counterContainer:"_2co0s",predictions__zero_text:"_25oPK",predictions__off_brand:"_1sCHK"}},40145:e=>{e.exports={relatedSuggestionsTitle:"_3lmjh"}},55364:e=>{e.exports={viewOverlay:"_3iGYO",content:"_2sw8A",footer:"_3kpn-",viewOverlayGoBack:"_2Z1Xu",defaultViewOverlayPanel:"jqEio",gradientViewOverlayPanel:"_3Qgxa",proofitViewOverlayPanel:"_9lDqb",defaultViewOverlayHeader:"_1GTGF",defaultViewOverlayContent:"nXzeg",gradientViewOverlayContent:"_2hao0",proofitViewOverlayContent:"_2XeMU",logo:"xQSpk",proofitViewOverlayHeader:"_3dGrl",proofitViewOverlayHeaderBetaBadge:"_2wTGA"}},44715:e=>{e.exports={viewOverlay:"_2Unkh",content:"_2jpRZ",footer:"_24flt",viewOverlayGoBack:"a19pK",defaultViewOverlayPanel:"KLJW2",gradientViewOverlayPanel:"_2_U8f",helpPanel:"_1PEah",defaultViewOverlayHeader:"_2_b0R",defaultViewOverlayContent:"_1PG6A",gradientViewOverlayContent:"_21gzK",logo:"_3JvmB",helpPanelContent:"_7zg7r",helpBanner:"_3zyoV",helpBannerImage:"_3bc5C",helpHeader:"_1vP1w",helpBannerMessage:"uCPe4",helpContent:"FQviE",heatmap:"BPLCG"}},82318:e=>{e.exports={viewOverlay:"_24v8y",content:"_1GUCQ",footer:"_VXnz",viewOverlayGoBack:"_2vYal",defaultViewOverlayPanel:"_181-n",gradientViewOverlayPanel:"_30LCU",defaultViewOverlayHeader:"_2YCIK",defaultViewOverlayContent:"_1T1GW",gradientViewOverlayContent:"_2hMw0",logo:"_1wpBP",cardList:"_2M4t-",headerGroup:"Qwt6V",questionMarkButton:"_2U3v1",questionMarkIcon:"_3hiB8",summaryWrapper:"_3f-rw",message:"_2UO09",relatedSuggestionsTitle:"_3oKNQ"}},91574:e=>{e.exports={viewOverlay:"_1xfDY",content:"BafXy",footer:"_3RySl",viewOverlayGoBack:"_1pPp-",defaultViewOverlayPanel:"_3M2J1",gradientViewOverlayPanel:"noaan",settingsViewOverlayPanel:"_3tn7z",defaultViewOverlayHeader:"_2Z-Ec",defaultViewOverlayContent:"_3lDk7",gradientViewOverlayContent:"_1ac5g",settingsViewOverlayContent:"_3krsk",logo:"_1VqGG",settingsViewDoneButton:"_2gIUv"}},35327:e=>{e.exports={summary_heading:"_28Zxw",summary_wrapper:"_3qF24",summary_fadein:"_1OTrB",fadein:"_1ETLE",summary_fadeout:"GJSzn",fadeout:"YHKQy"}},73008:e=>{e.exports={viewOverlay:"_8FYR8",content:"D8x8A",footer:"_1oEdF",viewOverlayGoBack:"_2IRn0",defaultViewOverlayPanel:"_3wpsL",gradientViewOverlayPanel:"_2zadI",defaultViewOverlayHeader:"_3Y5Ie",defaultViewOverlayContent:"_1FPwk",gradientViewOverlayContent:"_2WqSK",logo:"oiRsy"}},62513:e=>{e.exports={compactSuccessLens:"_1G56p",compactSuccessLensContainer:"_1cOu3"}},42805:e=>{e.exports={diamondIcon:"_2HoSv"}},35630:e=>{e.exports={circleProgress:"_1npo5",circleText:"_3muDd",card:"AAT_T",header:"_3k6P5",compact:"_1Efs0",normal:"_2_T8O",progressIcon:"_3lupT",title:"_1U6tn",full:"_24i7N",progressContainer:"TH-Um",progressBar:"_1Tzvc",progressValue:"_1Ck8G",description:"_4m_YN"}},32585:e=>{e.exports={cardBody:"_1qMrW",description:"_3g_X-",actions:"G0xen",lessIcon:"_3HhMd",minimalDescription:"srN6O",actionsFooter:"_11uNl",feedbackFooter:"_2PAOt",viewMoreButton:"_1CGEL"}},11510:e=>{e.exports={miniCard:"_2FMyP"}},96807:e=>{e.exports={cardContainer:"_3o7T2",cardText:"_1phHb"}},47476:e=>{e.exports={headerOrFooterWrapper:"_1snlI"}},74880:e=>{e.exports={cardList:"_2bCPN"}},30509:e=>{e.exports={premiumLens:"_2XK23"}},879:e=>{e.exports={successLens:"_1mbLA"}},57731:e=>{e.exports={footer:"_3W9PJ",plagiarismButton:"_1nouH",counterWrapper:"GHbf1",counter:"_2h93m",counterCheckmarkIcon:"_2-1xd"}},21831:e=>{e.exports={defaultHeader:"ghh6_",priorityLensHeader:"_2xf6x",head:"_1uTIv",headerGroup:"_1oce-",logoIcon:"_3Ey-O",logoText:"_1hTkC",headerButton:"_2HD8-",setGoalsButton:"_1EomQ",divider:"_2ku5Y",lensNavigation:"_1d7rU",disabledLensNavigation:"NFW3f",prioritySwitchWrapper:"EIY83",prioritySwitchFlatWrapper:"_3ujn6"}},44617:e=>{e.exports={header:"_2Yfwp",headerGroup:"_3Sxnx",logoIcon:"_3ijAI",closeButton:"LbVuE"}},79850:e=>{e.exports={wrapper:"_2PLre"}},75259:e=>{e.exports={container:"_2D4XC",baseGrid:"_2pCwn",bottomLeft:"_3_LGs",bottomRight:"_2tHhO",top:"_2Qg0A",notificationWrapper:"_3waR1"}},67129:e=>{e.exports={sidebarContainer:"_1_f6i",sidebarContent:"_3QlJG"}},7538:e=>{e.exports={learnMore:"_20Tq4",learnMoreTitle:"_1BPMx",learnMoreExample:"_1k4BW",learnMoreExampleIconAndTitle:"_3wg3T",learnMoreExampleIcon:"_1DRAV",learnMoreExampleCorrectIcon:"_3LNkD",learnMoreExampleIncorrectIcon:"_1A-P-",learnMoreExampleTitle:"_2vWyx",learnMoreExampleTextItalic:"_2Apwj",learnMoreExampleTextMarginLeft:"_30FxK",spin:"_2QPBm"}},12267:e=>{e.exports={singleCardAssistant:"_29x5a",singleCardAssistantHeader:"eFwvd",singleCardAssistantHeaderDraggable:"_3wYqZ",singleCardAssistantContent:"_1r3xI",singleCardAssistantContentWithPadding:"Jgq6x",singleCardAssistantFooter:"_23i2M",singleCardAssistantFooterText:"mTIL9",singleCardAssistantFooterButtonIcon:"FJI7I",spin:"_2z-hC"}},12266:e=>{e.exports={emogenieReport:"SoJtK",emogenieReportHeader:"wVkE-",emogenieReportHeaderTitle:"_1ARH3",emogenieReportItems:"_18u69",emogenieReportToneSuggestionInfo:"_3uoiv",emogenieReportToneSuggestionInfoEmojiAndTitle:"_1lwtc",emogenieReportToneSuggestionInfoEmoji:"_1aDI9"}},8471:e=>{e.exports={emogenieBrandToneInfoIcon:"_20-hB",emogenieReportItem:"_2VgP1",emogenieBrandToneInfoIconOn:"_3_eAc",emogenieBrandToneInfoIconOff:"_2F7Tg",emogenieReportItemEmotion:"_2pWWy",emogenieReportItemEmotionEmojiAndName:"_3Z3wv",emogenieReportItemEmotionEmoji:"_2cinA",emogenieReportItemEmotionName:"GSyum",emogenieReportItemEmotionBadgeOrIntensity:"_7YeXQ",emogenieReportItemEmotionIntensity:"_3oWFN",emogenieReportItemEmotionIntensityDot:"_2wQcZ",emogenieReportItemEmotionIntensityDotActive:"_9zOn8",emogenieReportItemEmotionActionsMenuButton:"zTh7Q",emogenieReportItemEmotionActionsMenuIcon:"_2TX6X",emogenieReportItemEmootionActionsMenuThumsUpIcon:"_1zLml",emogenieReportItemEmootionActionsMenuThumsDownIcon:"g1Y0k",spin:"_1g4LL"}},12935:e=>{e.exports={badge:"Mora3",badgePrimary:"_1446Q",badgeSuccess:"_2FQ9t",badgeGold:"_3t7g2",badgeError:"_154CZ",badgeRounded:"_2atD_",badgeRoundedSmall:"OxUT1",badgeRoundedMedium:"_1Rehq",badgeRoundedLarge:"_1Mmea",badgeTitle:"_1imRR",badgeTitleBold:"KO4Gs"}},75100:e=>{e.exports={settingsButtonMediumIcon:"_1PPTj",settingsButtonSmallIcon:"_20Pta",spin:"_2dlxE"}},22536:e=>{e.exports={checkboxContainer:"_3bj_g",checkbox:"xrB8R",checkboxDS:"_2UTyE",checkboxChecked:"Uhddy",checkboxCheckmark:"_1qI2g",spin:"_3S_a3"}},48287:e=>{e.exports={popoverNotificationMessage:"N9BS_"}},21420:e=>{e.exports={radioGroup:"_3jZFB",radioGroupOption:"_1Boe7",radioGroupOptionSelected:"_37tnK"}},59e3:e=>{e.exports={proofitRequestFormBtnLoadingSpinner:"_1dhPr",spin:"_34iE-"}},41063:e=>{e.exports={proofitHowItWorksSteps:"_29Vif",proofitHowItWorksStep:"M3Zas",proofitHowItWorksStepNumberContainer:"oAgaO",proofitHowItWorksStepNumber:"_1ZCJT",proofitHowItWorksStepOne:"_1jzAP",proofitHowItWorksStepOneNumberContainer:"_3zIlJ",proofitHowItWorksStepTwo:"TNSEJ",proofitHowItWorksStepTwoNumberContainer:"_2B7-Z",proofitHowItWorksStepThree:"_3G_IW",proofitHowItWorksStepThreeNumberContainer:"_1xWbH"}},17487:e=>{e.exports={proofitRequestForm:"_16jRB",proofitRequestFormImg:"L3ge0",proofitRequestFormTitle:"_2AohE",proofitRequestFormDescription:"_1-l2N",proofitRequestFormCostAndTime:"_1fthW",proofitRequestFormTime:"XwGo8",proofitRequestFormCostAndTimeTitle:"kTnKg",proofitRequestFormCostAndTimeSubtitle:"_12FlO",proofitRequestFormRequestBtn:"_3Iaok",proofitRequestFormUnavailableMsg:"_1hKiE",proofitRequestFormFootnote:"_3_jiZ",proofitRequestFormFootnoteFreeTrial:"IrTLS",proofitRequestFormFootnoteHowItWorksDontShowAgainCheckbox:"canRi",proofitRequestFormPrivacyInfoTitle:"_2YkLm",proofitRequestFormPrivacyInfoDescription:"_23aSV",proofitRequestFormPrivacyInfoDescriptionItem:"_31giz",proofitRequestFormPrivacyInfoDescriptionItemBulletPoint:"_3vURB"}},8400:e=>{e.exports={proofitReviewForm:"_1_T1p",proofitReviewFormTitle:"_1VtIM",proofitReviewFormDescription:"gQQZe",proofitFeedbackForm:"_tV9e",proofitDoneButton:"W2xwF"}},57398:e=>{e.exports={scoreRing:"_1V95O",loading:"_3_fuY",rotation:"_3cevg",scoreText:"_3MN4B"}},51217:e=>{e.exports={feedbackFormContainer:"_1M-GI",feedbackFormContainerAlignCenter:"_3QNrK",feedbackFormFields:"Jg_OY",feedbackFormTitle:"nPjzw",feedbackFormTextBoxTitle:"_2yUbL",feedbackFormLogo:"_2C-d7",compact:"_1wDKK",feedbackFormScore:"_3AmBq",feedbackFormTextBox:"FO2oU",feedbackFormShareDomainTitle:"_2UXTO",feedbackFormShareDomainCheckbox:"_3mSXM",feedbackFormSubmitButton:"_32xYR",feedbackFormSubmitButtonFixOverflowBottomPadding:"IJDSA",feedbackFormSubmitButtonFixOverflowBottomPaddingChild:"_3d5Tf",feedbackFormSuccessMessageTextContainer:"_2JO6Z",feedbackFormSuccessMessageIcon:"oVxds",feedbackFormSuccessMessageTitle:"_1MdvM",feedbackFormSuccessMessageSubtitle:"_1EKkw",spin:"_2ycFE"}},44544:e=>{e.exports={feedbackFormOption:"_9K_Q8",feedbackFormOptionIcon:"_259oL",feedbackFormOptionIconDisheartening:"_3NJTM",feedbackFormOptionIconNeutral:"i-5N8",feedbackFormOptionIconSmiling:"_1Dxi9",spin:"_2elyX"}},71527:e=>{e.exports={selected:"_3Ibej",label:"EKNV1",option:"ygVjN"}},66402:e=>{e.exports={american:"pyFmV",australian:"_2WGo3",british:"_1nkJZ",canadian:"_35Lt7"}},68089:e=>{e.exports={hover_blocker:"_1b9OS"}},56542:e=>{e.exports={settingsContent:"_2LPPC",fullWidth:"_1c69A",heading:"uyO-m",allSettings:"_3yj-F",separator:"_2LaDH",settingsLink:"_1DiWR"}},1005:e=>{e.exports={heading:"LLSOT"}},26485:e=>{e.exports={select_checkbox:"_3jXk9",centered:"_2GfZn",select_children:"nYWGL",beta:"_2D7H7",new:"_3Lqg-",alpha:"_3GrtL",checkbox:"_2nj-e",checkbox_check:"_28S0f",on:"UigB5",off:"_30ryz",checkbox_check_round:"_1PwEM",checkbox_control_wrapper:"_1KIp6",grayOut:"ZleQc",on_off:"_3mcZ6",disabled:"_1Sp_7",setting_item:"_3JLH2"}},6304:e=>{e.exports={line:"_2vgUt",disabled:"_3kA-F",dialectPicker:"_2v6OJ"}},47740:e=>{e.exports={container:"_1eoMt",containerWithBackground:"_12wVe",content:"Z9SrV",title:"_3hI6a",button:"_1LGnG"}},17324:e=>{e.exports={windows:"_2wKpF",setting_item:"_6eFop",fixing:"_3sQF9",thin_text:"_2m369",footer:"AIrzw",gr_popup_settings:"_18flg",iOS:"_2Y-35",footer_btn:"_16bxQ",short_border:"FqAkb",top:"_2N9kH",upgraded:"_1D3x1",content:"_36NTm",since:"dfV8r",business:"Nb2Rp",edu:"_3Q9EY",my_grammarly:"_1NXBN",new_document:"bpEGW",unsupported_site:"iBAYN",unsupported_item:"_13zLn",unsupported_title:"_3rfYX",domain:"_1tlAE",domain_in_details:"_2z4_y",unsupported_temporary:"Xw4Jp",unsupported_permanently:"_27hK2",unsupported_grammarly:"_2xTYa",diamond:"p3X6p",userPanel:"_3cZ8t",email:"bBX3_",link:"_3ko8g",blue:"b4yKe",edc_stripe:"_1wkrp",line:"_2_8JS",not_supported:"kU9B_",site_switcher:"_2KZQq",upgrade:"_1zI1G",def_switcher:"_29_cp",on:"_2JO5i",off:"_3f4Zs",favicon:"sjSDn",centered:"taU_8",summary:"_1cNov",upgrade_title:"_3aOe6",settingsContent:"_2BkNA",withBackground:"pNvqp",llamaTitle:"h5j0H",llamaDescription:"mHaqr"}},23345:e=>{e.exports={line:"NMkwQ",content:"lWYTI",upgrade:"_2GRJe"}}}]);
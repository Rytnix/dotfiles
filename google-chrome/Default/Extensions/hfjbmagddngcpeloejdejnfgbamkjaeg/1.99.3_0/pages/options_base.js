"use strict";__filename="pages/options_base.js",define(["require","exports","./async_bg"],function(t,n,i){var e,s,r,u,o,h;Object.defineProperty(n,"__esModule",{value:true}),n.t=n.e=n.s=n.r=n.u=n.o=n.h=n.delayBinding=n.didBindEvent=n.a=n.showI18n=void 0,e={},s=function(){var t,e,s,r,u,o;if("en"!==i.f){if(t=i.f.split(",")[0],e=navigator.language||t,(r=(s=i.$("#keyMappings"))&&n.t("keyMappingsP"))&&(s.placeholder=r),e&&(!t.startsWith("zh")||"zh-CN"!==e))for(s of i.$$("input[type=text], textarea"))s.lang=e;for(s of i.$$("[data-i]"))o=(u=s.dataset.i).endsWith("-t"),null!=(r=i.p(o?u.slice(0,-2):u))&&(o?s.title=r:s.textContent=r);document.documentElement.lang="zh"===t?"zh-CN":t}},n.showI18n=s,window.__extends=function(t,n){var i=function(){this.constructor=t};i.prototype=n.prototype,t.prototype=new i},n.a=function(t,n,i,e){var s,r=0,u=function(){var o=Date.now()-s;if(!(o<n-4&&o>=0))return r=0,s!==e?t.call(i):void 0;r=setTimeout(u,n-o)};return e=e?1:0,function(){if(s=Date.now(),!r)return r=setTimeout(u,n),e?(e=s,t.call(i)):void 0}},n.didBindEvent=function(t){var s,r,u="string"!=typeof t?t.type:t;for(s of e[u]||[])for(r of"string"==typeof s.v?i.$$(s.v):[s.v])"on"!==s.m?r.addEventListener(u,s.y,s.m):r["on"+u]=s.y;e[u]=null,removeEventListener(u,n.didBindEvent,true)},n.delayBinding=function(t,i,s,r){var u=e[i];u||(addEventListener(i,n.didBindEvent,true),u=e[i]=[]),u.push({v:t,y:s,m:r||false})},r=null,n.h=function(t){r=t},n.o=function(){return r},n.u={g:"",k:9,x:null,b:function(){r=null},S:function(){return r?r instanceof Promise?r:Promise.resolve():(n.u.x||i.w(0).then(function(t){n.u.x=t[0],n.u.k=t[1],n.u.g=t[2],i.N(1)}),r=i.w(1).then(function(t){r=t}))},O:function(t){var n,i=this;return null==r&&this.S(),r instanceof Promise?r.then(function(){return i.O(t)}):void 0!==(n=r[t])?n:this.x[t]},P:function(t,e){var s,u;return u=e,void 0!==(s=n.u.x[t])&&("object"==typeof s?JSON.stringify(e)===JSON.stringify(s):e===s)&&(u=null),i.w(2,{key:t,val:u}).then(function(n){r[t]=null!==n?n:e})},z:{__proto__:null,filterLinkHints:"f",keyLayout:"l",mouseReachable:"e",keyboard:"k",keyupTime:"u",linkHintCharacters:"c",linkHintNumbers:"n",passEsc:"p",regexFindMode:"r",smoothScroll:"s",scrollStepSize:"t",waitForEnter:"w"},J:{__proto__:null,c:1,n:1,l:1,d:1}},u=(function(){function t(t,i){var e=t.id;this.R=e,this.T=t,this.L=this.M=null,this.C=false,e in n.u.z?i=this.E.bind(this,i):"autoDarkMode"!==e&&"autoReduceMotion"!==e||(i=this.j.bind(this,i)),this.M=n.a(i,330,this,1),this.D(t)}return t.prototype.H=function(){},t.prototype.K=function(){var n,e=this;if(this.C=true,(n=this.A())instanceof Promise)return n.then(t.prototype.K.bind(this));this.L=n,t.F||i.Z(function(){e.q(e.L)})},t.prototype.A=function(){return n.u.O(this.R)},t.prototype.B=function(t){var n=this.V;return n?n.G(t):t},t.prototype.I=function(){return true},t.prototype.Q=function(){return __awaiter(this,void 0,void 0,function*(){var t,n=this,e=this.U(),s="object"==typeof e,r=s?JSON.stringify(this.L):this.L,u=s?JSON.stringify(e):e;if(u!==r)return r=u,e=(t=this.B(e))instanceof Promise?yield t:t,e=yield this.W(e),this.L=e,this.C=true,(r!==(s?JSON.stringify(e):e)||this.X(e))&&i.Z(function(){n.q(n.L,true)}),this.H()})},t.prototype.Y=function(){var t=this.A(),n=!this.tt(this.L,t);return n&&this.tt(this.U(),t)?(this.L=t,this.C=true,false):n},t.prototype.W=function(i){return __awaiter(this,void 0,void 0,function*(){return yield n.u.P(this.R,i),this.R in n.u.z&&t.nt.push(this.R),this.A()})},t.prototype.X=function(){return false},t.it=function(t,n){return JSON.stringify(t)===JSON.stringify(n)},t.et=null,t.F=false,t})(),n.r=u,o=(function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.tt=u.it,n}return __extends(e,t),e.prototype.D=function(t){var i=this;this.st=t.querySelector("#exclusionTemplate").content.querySelector(".exclusionRule"),this.rt=t.querySelector("tbody"),this.ut=[],n.delayBinding(this.rt,"input",e.ot),n.delayBinding(this.rt,"input",this.M),n.delayBinding(this.rt,"click",function(t){return i.ht(t)}),this.at=false,n.delayBinding("#exclusionAddButton","click",function(){return i.ct("")},"on")},e.prototype.ft=function(){},e.ot=function(t){var n=t.target,i=n.vnode;i&&(i.lt|=n.classList.contains("pattern")?1:2)},e.prototype.ct=function(t,n){var e,s=false!==n,r=s&&this.rt.childElementCount;this.pt(this.rt,{pattern:t,passKeys:""}),e=this.ut[this.ut.length-1],s&&(r>=4&&this.T.scrollBy(0,40),i.Z(function(){return e.vt.focus()})),t&&this.M(),this.ft(1)},e.prototype.q=function(t){var n,e,s;if(!this.at)for(n of(this.at=true,u.nt&&(this.st.draggable=true),"en"!==i.f?i.$$("[title]",this.st):[]))(e=i.p(n.title))&&(n.title=e);return this.rt.textContent="",this.ut=[],t.length<=0||(1===t.length?this.pt(this.rt,t[0]):(s=document.createDocumentFragment(),t.forEach(this.pt.bind(this,s)),this.rt.appendChild(s))),this.ft(t.length)},e.prototype.dt=function(){return true},e.prototype.pt=function(t,n){var i,e,s,r,u,o=n.pattern,h=n.passKeys,a={_t:{pattern:o,passKeys:h},mt:null,lt:0,yt:false,vt:null,gt:null};a.yt=this.dt(a),a.yt?(e=(i=document.importNode(this.st,true)).querySelector(".pattern"),s=i.querySelector(".passKeys"),r=h.trimRight(),e.value=o,o&&(e.placeholder=""),s.value=r,r&&(s.placeholder=""),(u=a).vt=e,u.gt=s,e.vnode=u,s.vnode=u,this.ut.push(u),t.appendChild(i)):this.ut.push(a)},e.kt=function(t){t._t.pattern&&t.gt.placeholder&&(t.gt.placeholder="")},e.prototype.ht=function(t){var n,i=t.target;if("path"===i.localName&&(i=i.parentElement),"svg"===i.localName&&(i=i.parentElement),i.classList.contains("remove"))return(i=i.parentNode.parentNode).classList.contains("exclusionRule")?(n=i.querySelector(".pattern").vnode,i.remove(),this.ut.splice(this.ut.indexOf(n),1),this.M(),this.ft(0)):void 0},e.xt=function(t,n,i){var e=i.toLowerCase();return n||1!==i.length?i!==e?"<".concat(n,"s-").concat(e,">"):t:i},e.bt=function(t){return t&&t.replace(/<(?!<)((?:[acm]-){0,3})(\S|[A-Za-z]\w+)>/g,e.xt)},e.prototype.U=function(t){var i,s,r,u,o,a,c,f,l,p,v,d=[];for(i of(t=true===t,this.ut))t&&!i.yt||((s=i.lt)?(r=1&s?i.vt.value.trim():i._t.pattern,u=false,o=2&s?i.gt.value:i._t.passKeys,r?(1&s&&((a=r.startsWith(":")?0:r.indexOf("://"))&&(/^[\^*]|[^\\][$()*+?\[\]{|}]/.test(r)?r.startsWith("`")||(r.startsWith("^")?(f=".*$".includes(r.slice(-2))?r.endsWith(".*$")?3:r.endsWith(".*")?2:0:0,r=0!==f&&"\\"!==r[r.length-f]?r.slice(0,-f):r):(u=!r.includes("/",a+3),r.endsWith("*")&&(r=r.slice(0,/^[^\\]\.\*$/.test(r.slice(-3))?-2:-1),u=false),c=(a<0?"^https?://":"^")+((c=r=r.startsWith(".*")&&!/[(\\[]/.test(r)?"*."+r.slice(2):r).startsWith("*")&&"."!==c[1]?"[^/]"+c:(c=c.replace(/\./g,"\\.")).startsWith("*")?c.replace("*\\.","(?:[^./]+\\.)*?"):c.replace("://*\\.","://(?:[^./]+\\.)*?")),r=h(c,"")?c:r.includes("*")||r.includes("/")?":"+r:":https://"+(r.startsWith(".")?r.slice(1):r))):(u=!r.includes("/",a+3)&&!r.startsWith("vimium:"),r=(a<0?":http://":":")+(r=r.replace(/\\(.)/g,"$1")))),u&&(r+="/")),2&s&&o&&((l=(o=e.bt(o)).match(/<(?!<)(?:a-)?(?:c-)?(?:m-)?(?:s-)?(?:[a-z]\w+|[^\sA-Z])>|\S/g))&&((p="^"===l[0]&&l.length>1)&&l.shift(),l.sort(),p?l.unshift("^"):"^"===l[0]&&(l.shift(),l.push("^"))),o=(o=l?l.join(" ")+" ":"").replace(/<escape>/gi,"<esc>")),v=o?o.length>1&&"^"===o[0]?n.t("onlyHook")||"only hook such keys":n.t("passThrough")||"pass through such keys":n.t("completelyDisabled")||"completely disabled",i.vt.title!==r&&(i.vt.title=r),i.gt.title!==v&&(i.gt.title=v),this.St(i,r,o),d.push(i._t)):(i.vt.title&&(i.vt.title=""),i.gt.title&&(i.gt.title=""),this.St(i,"",o))):i._t.pattern&&d.push(i._t));return d},e.prototype.St=function(t,n,i){var s=!t._t.passKeys&&!!i;t._t={pattern:n,passKeys:i},t.mt=null,t.lt=0,s&&e.kt(t)},e.prototype.H=function(){var t,n;for(t of this.ut)t.yt&&(t.vt.value!==t._t.pattern&&(t.vt.value=t._t.pattern),n=t._t.passKeys.trim(),t.gt.value!==n&&(t.gt.value=n))},e})(u),n.s=o,h=function(t,n){try{return new RegExp(t,n)}catch(t){return null}},n.e=i.wt<48||devicePixelRatio<2&&i.wt>=61?function(){var t=document.createElement("style"),n=devicePixelRatio,e=i.wt>=61&&n>=1,s=e||i.wt>=48?1/n:1;s=(""+(s+=999e-8)).slice(0,7).replace(/\.?0+$/,""),t.textContent=e?"html { --tiny: ".concat(s,"px; }"):"* { border-width: ".concat(s,"px !important; }"),document.head.appendChild(t)}:null,n.t=function(t,n){return i.p(t,n)||""}});
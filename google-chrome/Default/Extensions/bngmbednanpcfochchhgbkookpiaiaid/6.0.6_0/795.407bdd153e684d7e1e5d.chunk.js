"use strict";(self.webpackChunkmue=self.webpackChunkmue||[]).push([[795],{359:function(t,e,a){a.d(e,{N9:function(){return r},Tz:function(){return i},j3:function(){return s}});var o=a(8515);function n(){document.querySelector(".reminder-info").style.display="block",localStorage.setItem("showReminder",!0)}function s(t){return t.replace(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()!@:%_+.~#?&//=]*)/,'<a href="$&" target="_blank">$&</a>')}function r(t,e,a){switch(t){case"settings":localStorage.removeItem("backup_settings");var s=[];Object.keys(localStorage).forEach((function(t){s.push({name:t,value:localStorage.getItem(t)})})),localStorage.setItem("backup_settings",JSON.stringify(s)),Object.keys(e.settings).forEach((function(t){localStorage.setItem(t,e.settings[t])})),n();break;case"photos":localStorage.setItem("photo_packs",JSON.stringify(e.photos)),localStorage.setItem("oldBackgroundType",localStorage.getItem("backgroundType")),localStorage.setItem("backgroundType","photo_pack"),o.Z.dispatch("refresh","background");break;case"quotes":e.quote_api&&localStorage.setItem("quoteAPI",JSON.stringify(e.quote_api)),localStorage.setItem("quote_packs",JSON.stringify(e.quotes)),localStorage.setItem("oldQuoteType",localStorage.getItem("quoteType")),localStorage.setItem("quoteType","quote_pack"),o.Z.dispatch("refresh","quote")}var r=JSON.parse(localStorage.getItem("installed"));a?r.push({content:{updated:"Unpublished",data:e}}):r.push(e),localStorage.setItem("installed",JSON.stringify(r))}function i(t,e){switch(t){case"settings":var a=JSON.parse(localStorage.getItem("backup_settings"));localStorage.clear(),a.forEach((function(t){localStorage.setItem(t.name,t.value)})),n();break;case"quotes":localStorage.removeItem("quote_packs"),localStorage.removeItem("quoteAPI"),localStorage.setItem("quoteType",localStorage.getItem("oldQuoteType")),localStorage.removeItem("oldQuoteType"),o.Z.dispatch("refresh","marketplacequoteuninstall");break;case"photos":localStorage.removeItem("photo_packs"),localStorage.setItem("backgroundType",localStorage.getItem("oldBackgroundType")),localStorage.removeItem("oldBackgroundType"),o.Z.dispatch("refresh","marketplacebackgrounduninstall")}for(var s=JSON.parse(localStorage.getItem("installed")),r=0;r<s.length;r++)if(s[r].name===e){s.splice(r,1);break}localStorage.setItem("installed",JSON.stringify(s))}},4761:function(t,e,a){a.d(e,{Z:function(){return M}});var o,n,s,r,i,l,c,u,d,p=a(857),m=a(7061),g=a(9900),h=a(4269),f=a(4593),v=a(886),Z=a(9660),k=a(9526),b=a(5678),y=a(4052),S=a(4823),I=a.n(S),_=a(359),N=a(155);var M=function(t){(0,h.Z)(M,t);var e,a,S=(e=M,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=(0,v.Z)(e);if(a){var n=(0,v.Z)(this).constructor;t=Reflect.construct(o,arguments,n)}else t=o.apply(this,arguments);return(0,f.Z)(this,t)});function M(t){var e;return(0,m.Z)(this,M),(e=S.call(this,t)).state={showLightbox:!1,showUpdateButton:!0===e.props.addonInstalled&&e.props.addonInstalledVersion!==e.props.data.version},e}return(0,g.Z)(M,[{key:"updateAddon",value:function(){(0,_.Tz)(this.props.data.type,this.props.data.display_name),(0,_.N9)(this.props.data.type,this.props.data),(0,b.Am)(Z.Z.language.getMessage(Z.Z.languagecode,"toasts.updated")),this.setState({showUpdateButton:!1})}},{key:"render",value:function(){var t,e=this,a=function(t){return Z.Z.language.getMessage(Z.Z.languagecode,t)};if(!this.props.data.display_name)return null;this.props.data.quote_api&&(t=(0,p.Z)("div",{className:"productInformation"},void 0,(0,p.Z)("ul",{},void 0,(0,p.Z)("li",{className:"header"},void 0,a("modals.main.marketplace.product.quote_warning.title")),(0,p.Z)("li",{id:"updated"},void 0,a("modals.main.marketplace.product.quote_warning.description")))));var m,g=Z.Z.constants.DDG_IMAGE_PROXY+this.props.data.icon;return this.props.data.icon||(g=null),this.state.showUpdateButton&&(m=(0,p.Z)(k.Fragment,{},"update",o||(o=(0,p.Z)("br",{})),n||(n=(0,p.Z)("br",{})),(0,p.Z)("button",{className:"removeFromMue",onClick:function(){return e.updateAddon()}},void 0,a("modals.main.addons.product.buttons.update_addon")))),(0,p.Z)("div",{id:"item"},void 0,s||(s=(0,p.Z)("br",{})),(0,p.Z)(y.KYK,{className:"backArrow",onClick:this.props.toggleFunction}),r||(r=(0,p.Z)("br",{})),(0,p.Z)("h1",{},void 0,this.props.data.display_name),this.props.button,m,i||(i=(0,p.Z)("br",{})),l||(l=(0,p.Z)("br",{})),g?(0,p.Z)("img",{alt:"product",draggable:"false",src:g,onClick:function(){return e.setState({showLightbox:!0})}}):null,(0,p.Z)("div",{className:"side"},void 0,(0,p.Z)("div",{className:"productInformation"},void 0,(0,p.Z)("ul",{},void 0,(0,p.Z)("li",{className:"header"},void 0,a("modals.main.marketplace.product.version")),m?(0,p.Z)("li",{},void 0,this.props.data.version," (Installed: ",this.props.data.addonInstalledVersion,")"):(0,p.Z)("li",{},void 0,this.props.data.version),c||(c=(0,p.Z)("br",{})),(0,p.Z)("li",{className:"header"},void 0,a("modals.main.marketplace.product.author")),(0,p.Z)("li",{},void 0,this.props.data.author))),u||(u=(0,p.Z)("br",{})),t),d||(d=(0,p.Z)("div",{className:"sidebr"},void 0,(0,p.Z)("br",{}),(0,p.Z)("br",{}))),(0,p.Z)("div",{className:"informationContainer"},void 0,(0,p.Z)("h1",{className:"overview"},void 0,a("modals.main.marketplace.product.overview")),(0,p.Z)("p",{className:"description",dangerouslySetInnerHTML:{__html:this.props.data.description}})),(0,p.Z)(I(),{closeTimeoutMS:100,onRequestClose:function(){return e.setState({showLightbox:!1})},isOpen:this.state.showLightbox,className:"Modal lightboxmodal",overlayClassName:"Overlay resetoverlay",ariaHideApp:!1},void 0,(0,p.Z)(N.Z,{modalClose:function(){return e.setState({showLightbox:!1})},img:g})))}}]),M}(k.PureComponent)},2098:function(t,e,a){a.d(e,{Z:function(){return s}});var o=a(857),n=a(9660);function s(t){var e=t.items,a=t.toggleFunction;return(0,o.Z)("div",{className:"items"},void 0,e.map((function(t){return(0,o.Z)("div",{className:"item",onClick:function(){return a(t.name)}},t.name,(0,o.Z)("img",{alt:"icon",draggable:"false",src:n.Z.constants.DDG_IMAGE_PROXY+t.icon_url}),(0,o.Z)("div",{className:"details"},void 0,(0,o.Z)("h4",{},void 0,t.display_name||t.name),(0,o.Z)("p",{},void 0,t.author)))})))}},155:function(t,e,a){a.d(e,{Z:function(){return r}});var o=a(857),n=a(9660),s=a(7557);function r(t){var e=t.modalClose,a=t.img;return n.Z.stats.postEvent("modal","Opened lightbox"),(0,s.jsxs)(s.Fragment,{children:[(0,o.Z)("span",{className:"closeModal",onClick:e},void 0,"Ã—"),(0,o.Z)("img",{src:a,className:"lightboximg",draggable:!1,alt:"Item screenshot"})]})}},6414:function(t,e,a){a.d(e,{Z:function(){return k}});var o=a(857),n=a(7061),s=a(9900),r=a(4771),i=a(4269),l=a(4593),c=a(886),u=a(240),d=a(9660),p=a(9526),m=a(5267),g=a(8358),h=a(9936),f=a(7784),v=a(8515),Z=a(7557);var k=function(t){(0,i.Z)(b,t);var e,a,k=(e=b,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=(0,c.Z)(e);if(a){var n=(0,c.Z)(this).constructor;t=Reflect.construct(o,arguments,n)}else t=o.apply(this,arguments);return(0,l.Z)(this,t)});function b(t){var e;return(0,n.Z)(this,b),e=k.call(this,t),(0,u.Z)((0,r.Z)(e),"onChange",(function(t){var a=t.target.value;if(a!==d.Z.language.getMessage(d.Z.languagecode,"modals.main.loading")){if(d.Z.stats.postEvent("setting","".concat(e.props.name," from ").concat(e.state.value," to ").concat(a)),e.setState({value:a}),e.props.noSetting||localStorage.setItem(e.props.name,a),e.props.onChange&&e.props.onChange(a),e.props.element&&!document.querySelector(e.props.element))return document.querySelector(".reminder-info").style.display="block",localStorage.setItem("showReminder",!0);v.Z.dispatch("refresh",e.props.category)}})),e.state={value:localStorage.getItem(e.props.name)||e.props.children[0].props.value,title:""},e.dropdown=(0,p.createRef)(),e}return(0,s.Z)(b,[{key:"render",value:function(){var t="dropdown"+this.props.name,e=this.props.label||"";return(0,o.Z)(m.Z,{fullWidth:!0,className:t},void 0,(0,o.Z)(g.Z,{id:t},void 0,e),(0,Z.jsx)(h.Z,{labelId:t,id:this.props.name,value:this.state.value,label:e,onChange:this.onChange,ref:this.dropdown,children:this.props.manual?this.props.children:this.props.children.map((function(t,e){return t?(0,o.Z)(f.Z,{value:t.props?t.props.value:""},e,t.props?t.props.children:""):null}))},t))}}]),b}(p.PureComponent)},1795:function(t,e,a){a.r(e),a.d(e,{default:function(){return q}});var o,n,s,r=a(857),i=a(9660),l=a(9027),c=a(3755),u=a(7061),d=a(9900),p=a(4771),m=a(4269),g=a(4593),h=a(886),f=a(240),v=a(8047),Z=a.n(v),k=a(9526),b=a(5678),y=a(4052),S=a(4761),I=a(2098),_=a(6414),N=a(359),M=a(7557);var x,w,C,R=function(t){(0,m.Z)(x,t);var e,a,l,v,k=(l=x,v=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,h.Z)(l);if(v){var a=(0,h.Z)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,g.Z)(this,t)});function x(){var t;return(0,u.Z)(this,x),t=k.call(this),(0,f.Z)((0,p.Z)(t),"getMessage",(function(t){return i.Z.language.getMessage(i.Z.languagecode,t)})),t.state={items:[],button:"",featured:{},done:!1,item:{}},t.buttons={uninstall:(0,r.Z)("button",{className:"removeFromMue",onClick:function(){return t.manage("uninstall")}},void 0,t.getMessage("modals.main.marketplace.product.buttons.remove")),install:(0,r.Z)("button",{className:"addToMue",onClick:function(){return t.manage("install")}},void 0,t.getMessage("modals.main.marketplace.product.buttons.addtomue"))},t.controller=new AbortController,t}return(0,d.Z)(x,[{key:"toggle",value:(a=(0,c.Z)(Z().mark((function t(e,a){var o,n,s,r,l,c;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("item"!==e){t.next=33;break}return t.prev=1,t.next=4,fetch("".concat(i.Z.constants.MARKETPLACE_URL,"/item/").concat(this.props.type,"/").concat(a),{signal:this.controller.signal});case 4:return t.next=6,t.sent.json();case 6:o=t.sent,t.next=13;break;case 9:if(t.prev=9,t.t0=t.catch(1),!1!==this.controller.signal.aborted){t.next=13;break}return t.abrupt("return",(0,b.Am)(this.getMessage("toasts.error")));case 13:if(!0!==this.controller.signal.aborted){t.next=15;break}return t.abrupt("return");case 15:if(n=this.buttons.install,s=!1,!(l=JSON.parse(localStorage.getItem("installed"))).some((function(t){return t.name===o.data.name}))){t.next=29;break}n=this.buttons.uninstall,s=!0,c=0;case 22:if(!(c<l.length)){t.next=29;break}if(l[c].name!==o.data.name){t.next=26;break}return r=l[c].version,t.abrupt("break",29);case 26:c++,t.next=22;break;case 29:this.setState({item:{type:o.data.type,display_name:o.data.name,author:o.data.author,description:(0,N.j3)(o.data.description.replace(/\n/g,"<br>")),version:o.data.version,icon:o.data.screenshot_url,data:o.data,addonInstalled:s,addonInstalledVersion:r},button:n}),i.Z.stats.postEvent("marketplace-item","".concat(this.state.item.display_name," viewed")),t.next=34;break;case 33:this.setState({item:{}});case 34:case"end":return t.stop()}}),t,this,[[1,9]])}))),function(t,e){return a.apply(this,arguments)})},{key:"getItems",value:(e=(0,c.Z)(Z().mark((function t(){var e,a,o;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(i.Z.constants.MARKETPLACE_URL+"/items/"+this.props.type,{signal:this.controller.signal});case 2:return t.next=4,t.sent.json();case 4:return e=t.sent,a=e.data,t.next=8,fetch(i.Z.constants.MARKETPLACE_URL+"/featured",{signal:this.controller.signal});case 8:return t.next=10,t.sent.json();case 10:if(o=t.sent,!0!==this.controller.signal.aborted){t.next=13;break}return t.abrupt("return");case 13:this.setState({items:a,oldItems:a,featured:o.data,done:!0}),this.sortMarketplace(localStorage.getItem("sortMarketplace"),!1);case 15:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"manage",value:function(t){"install"===t?(0,N.N9)(this.state.item.type,this.state.item.data):(0,N.Tz)(this.state.item.type,this.state.item.display_name),(0,b.Am)(this.getMessage("toasts."+t+"ed")),this.setState({button:"install"===t?this.buttons.uninstall:this.buttons.install}),i.Z.stats.postEvent("marketplace-item","".concat(this.state.item.display_name," ").concat("install"===t?"installed":"uninstalled")),i.Z.stats.postEvent("marketplace","install"===t?"Install":"Uninstall")}},{key:"sortMarketplace",value:function(t,e){var a=this.state.oldItems;switch(t){case"a-z":a.sort(),"z-a"===this.state.sortType&&a.reverse();break;case"z-a":a.sort(),a.reverse()}this.setState({items:a,sortType:t}),e&&i.Z.stats.postEvent("marketplace","Sort")}},{key:"componentDidMount",value:function(){!1!==navigator.onLine&&"true"!==localStorage.getItem("offlineMode")&&this.getItems()}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){var t=this,e=function(t){return(0,r.Z)("div",{className:"emptyitems"},void 0,(0,r.Z)("div",{className:"emptyMessage"},void 0,t))};if(!1===navigator.onLine||"true"===localStorage.getItem("offlineMode"))return e((0,M.jsxs)(M.Fragment,{children:[o||(o=(0,r.Z)(y.Em6,{})),(0,r.Z)("h1",{},void 0,this.getMessage("modals.main.marketplace.offline.title")),(0,r.Z)("p",{className:"description"},void 0,this.getMessage("modals.main.marketplace.offline.description"))]}));if(!1===this.state.done)return e((0,r.Z)("h1",{},void 0,this.getMessage("modals.main.loading")));var a=function(){return(0,r.Z)("div",{className:"featured",style:{backgroundColor:t.state.featured.colour}},void 0,(0,r.Z)("p",{},void 0,t.state.featured.title),(0,r.Z)("h1",{},void 0,t.state.featured.name),(0,r.Z)("button",{className:"addToMue",onClick:function(){return i.Z.stats.postEvent("marketplace","Featured clicked"),void window.open(t.state.featured.buttonLink)}},void 0,t.state.featured.buttonText))};return 0===this.state.items.length?(0,M.jsxs)(M.Fragment,{children:[a(),e((0,M.jsxs)(M.Fragment,{children:[n||(n=(0,r.Z)(y.YD2,{})),(0,r.Z)("h1",{},void 0,this.getMessage("modals.main.addons.empty.title")),(0,r.Z)("p",{className:"description"},void 0,this.getMessage("modals.main.marketplace.no_items"))]}))]}):this.state.item.display_name?(0,r.Z)(S.Z,{data:this.state.item,button:this.state.button,toggleFunction:function(){return t.toggle()},addonInstalled:this.state.item.addonInstalled,addonInstalledVersion:this.state.item.addonInstalledVersion}):(0,M.jsxs)(M.Fragment,{children:[a(),s||(s=(0,r.Z)("br",{})),(0,r.Z)(_.Z,{label:this.getMessage("modals.main.addons.sort.title"),name:"sortMarketplace",onChange:function(e){return t.sortMarketplace(e)}},void 0,(0,r.Z)("option",{value:"a-z"},void 0,this.getMessage("modals.main.addons.sort.a_z")),(0,r.Z)("option",{value:"z-a"},void 0,this.getMessage("modals.main.addons.sort.z_a"))),(0,r.Z)(I.Z,{items:this.state.items,toggleFunction:function(e){return t.toggle("item",e)}})]})}}]),x}(k.PureComponent);function q(){var t=function(t){return i.Z.language.getMessage(i.Z.languagecode,t)};return(0,r.Z)(l.Z,{},void 0,(0,r.Z)("div",{label:t("modals.main.marketplace.photo_packs"),name:"photo_packs"},void 0,x||(x=(0,r.Z)(R,{type:"photo_packs"}))),(0,r.Z)("div",{label:t("modals.main.marketplace.quote_packs"),name:"quote_packs"},void 0,w||(w=(0,r.Z)(R,{type:"quote_packs"}))),(0,r.Z)("div",{label:t("modals.main.marketplace.preset_settings"),name:"preset_settings"},void 0,C||(C=(0,r.Z)(R,{type:"preset_settings"}))))}}}]);